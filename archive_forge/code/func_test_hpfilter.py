from statsmodels.compat.pandas import (
from datetime import datetime
import numpy as np
from numpy import array, column_stack
from numpy.testing import (
from pandas import DataFrame, concat, date_range
from statsmodels.datasets import macrodata
from statsmodels.tsa.filters._utils import pandas_wrapper
from statsmodels.tsa.filters.bk_filter import bkfilter
from statsmodels.tsa.filters.cf_filter import cffilter
from statsmodels.tsa.filters.filtertools import (
from statsmodels.tsa.filters.hp_filter import hpfilter
def test_hpfilter():
    hpfilt_res = array([[39.51191484487845, 2670.8370851551217], [80.08853245681075, 2698.712467543189], [48.87545512195402, 2726.612544878046], [30.59193256079834, 2754.612067439202], [64.8826673342196, 2782.8163326657805], [23.04024204546704, 2811.349757954533], [-1.3553123694873648, 2840.3773123694873], [-67.46236512580754, 2870.0783651258075], [-81.3674383685343, 2900.6314383685344], [-60.16789026443257, 2932.1728902644327], [-46.369224331382156, 2964.788224331382], [-20.695339155704005, 2998.525339155704], [-2.162152558595608, 3033.4031525585956], [-4.718647774311648, 3069.4276477743115], [-13.556456691690073, 3106.60345669169], [-44.3692620447564, 3144.9322620447565], [-43.3202737821166, 3184.4072737821166], [-44.54697106352069, 3224.993971063521], [-26.29875787765286, 3266.6307578776527], [-44.26119635629266, 3309.2281963562928], [-14.434411907624963, 3352.680411907625], [-20.26686669186438, 3396.8538666918644], [-19.137001362088995, 3441.606001362089], [-54.82458977940951, 3486.7815897794094], [-15.962445179377937, 3532.213445179378], [-13.740115428745412, 3577.7001154287454], [13.254828134039144, 3623.0301718659607], [56.03040174253829, 3667.983598257462], [103.0743373627106, 3712.348662637289], [72.17534795943993, 3755.94865204056], [54.629725036932086, 3798.671274963068], [44.07065050666142, 3840.4493494933386], [37.49016270204993, 3881.24983729795], [-1.5112441999231123, 3921.067244199923], [-9.093507374079763, 3959.91950737408], [-16.853619467602584, 3997.8236194676024], [28.2221103143429, 4034.790889685657], [61.17590627896425, 4070.8220937210353], [54.33135391434371, 4105.935646085656], [38.10480376716623, 4140.188196232833], [70.42964928802849, 4173.670350711972], [49.96346842507592, 4206.496531574924], [44.55282059571255, 4238.825179404287], [-7.584961950576144, 4270.845961950577], [-46.2033924769712, 4302.7763924769715], [-70.5402436455297, 4334.8292436455295], [-64.92941099801465, 4367.188410998015], [-143.35670242395554, 4399.993702423955], [-59.328344930890125, 4433.34434493089], [-68.42096758743628, 4467.249967587436], [-67.7401192465486, 4501.683119246549], [-90.30958565658057, 4536.573585656581], [-46.039814991368075, 4571.808814991368], [25.88118806672992, 4607.21981193327], [34.894193719122995, 4642.608806280877], [76.75179642495095, 4677.794203575049], [163.5497817724172, 4712.616218227583], [185.60796547656173, 4746.963034523438], [125.42694463927182, 4780.825055360729], [138.7413113837174, 4814.308688616283], [62.01826599282231, 4847.598734007178], [41.22129542972198, 4880.966704570278], [-41.202874758423604, 4914.722874758424], [-94.86328233441964, 4949.20328233442], [-189.4232132641573, 4984.718213264157], [-189.57666396200875, 5021.518663962009], [-146.40924133426506, 5059.7372413342655], [-121.87706687212176, 5099.388066872122], [-49.730756290781756, 5140.393756290781], [-53.65375213897278, 5182.600752138973], [-71.75241524251214, 5225.824415242512], [-78.34757283225463, 5269.846572832254], [-62.64220687943907, 5314.404206879439], [-3.054332122210326, 5359.185332122211], [48.08218808024685, 5403.838811919753], [2.7813993267363912, 5448.011600673263], [-21.975704151732316, 5491.380704151732], [150.9441335012807, 5533.62486649872], [165.8909029574852, 5574.409097042515], [202.72925480499816, 5613.492745195002], [175.21015781760616, 5650.7388421823935], [145.2808749847536, 5686.137125015246], [153.54816294750253, 5719.7868370524975], [137.61697779988754, 5751.878022200112], [125.77030803407706, 5782.696691965923], [-25.241868468956454, 5812.614868468956], [-65.46618027042405, 5842.083180270424], [11.923520235803153, 5871.536479764197], [104.34829701887429, 5901.368702981125], [25.813761847683963, 5931.981238152316], [66.34330880534071, 5963.8406911946595], [-42.36780162594641, 5997.429801625946], [-175.9397735321818, 6033.272773532181], [-182.7933311233055, 6071.867331123305], [-247.2312362505918, 6113.601236250592], [-287.7470049336489, 6158.748004933649], [-263.40663366935405, 6207.4266336693545], [-181.95727707636252, 6259.576277076362], [-117.50346062746212, 6314.971460627462], [-47.698986497183796, 6373.272986497183], [14.195782802878966, 6434.068217197121], [62.67929662760798, 6496.914703372392], [61.96413196753747, 6561.378868032462], [50.19769125317907, 6627.066308746821], [46.65364933213823, 6693.621350667861], [36.62430749527266, 6760.719692504727], [75.45680850246481, 6828.066191497535], [60.52940492147536, 6895.388595078524], [60.29518881462354, 6962.461811185376], [21.870421366526898, 7029.098578633473], [23.800679268247222, 7095.149320731753], [-7.119129802169482, 7160.47812980217], [-31.94497359120851, 7224.963973591209], [-18.971370389341246, 7288.4813703893415], [-18.326872878451468, 7350.8848728784515], [46.004823365975426, 7412.0171766340245], [24.890477064030165, 7471.70952293597], [63.059093921272506, 7529.821906078728], [45.852123094981835, 7586.2298769050185], [93.14260180878318, 7640.848398191217], [112.98190970953692, 7693.621090290463], [120.4662123176704, 7744.549787682329], [133.68606146012462, 7793.706938539875], [103.4567175813736, 7841.2402824186265], [140.311887337205, 7887.381112662795], [127.17261693510045, 7932.4253830648995], [82.7192576528214, 7976.756742347178], [-31.974322117525844, 8020.838322117525], [-115.02095351940625, 8065.184953519406], [-106.46948374567728, 8110.291483745677], [-119.04287189253682, 8156.580871892536], [-135.36353362929913, 8204.4095336293], [-96.44348283027102, 8254.059482830271], [-61.43413116116608, 8305.728131161166], [-30.191613110979233, 8359.55261311098], [1.3843331635525828, 8415.631666836447], [-41.56016073666615, 8474.045160736667], [-48.43882841860977, 8534.87382841861], [-67.06442838867042, 8598.17242838867], [-20.196444885799792, 8663.9654448858], [-4.31644688108463, 8732.235446881084], [44.35061943264736, 8802.952380567353], [28.205505641555646, 8876.083494358445], [51.55624419490778, 8951.623755805093], [-4.318760899315748, 9029.585760899316], [-65.34632828542271, 9110.014328285422], [-72.26757738268498, 9192.951577382684], [-94.12378615444868, 9278.398786154448], [-119.12406532883688, 9366.312065328837], [-49.53669826751866, 9456.588698267518], [-60.17251579067488, 9549.051515790676], [-51.03438828313483, 9643.492388283135], [-73.43057830678117, 9739.665578306782], [-27.742451930549578, 9837.293451930549], [-3.380481112519192, 9936.05248111252], [-26.727798777943462, 10035.601798777943], [-32.17342505148372, 10135.598425051483], [-41.40567518359967, 10235.6826751836], [-6.687756033938058, 10335.474756033938], [73.00600408459468, 10434.568995915406], [68.62345670680043, 10532.5555432932], [54.97882461487461, 10629.070175385126], [96.1224409305596, 10723.791559069441], [197.82127701038917, 10816.432722989612], [136.27722768487547, 10906.766772315124], [263.76354948672633, 10994.690450513273], [187.68132568151668, 11080.185674318484], [171.1447873158413, 11163.399212684159], [52.575864608266784, 11244.595135391733], [47.106522285317624, 11324.144477714683], [-62.376134842410465, 11402.451134842411], [-99.82044354035315, 11479.948443540354], [-79.1627554899751, 11557.030755489975], [-95.26003459472304, 11634.030034594723], [-114.79876803691695, 11711.228768036917], [-190.0259054765902, 11788.84990547659], [-221.22564734395564, 11867.044647343955], [-207.1394278781845, 11945.845427878185], [-89.68541528904825, 12025.146415289048], [-61.89531564415665, 12104.712315644156], [-56.62878162551715, 12184.251781625517], [-49.61678134413705, 12263.434781344136], [-38.36288992144182, 12341.895889921441], [-8.95667199145646, 12419.238671991456], [39.070284618668666, 12495.04271538133], [18.652990001844955, 12568.882009998155], [42.79803532226833, 12640.354964677732], [39.62735362631611, 12709.071646373684], [141.26912918778544, 12774.668870812215], [125.65377918443664, 12836.808220815563], [70.67642758858892, 12895.23957241141], [110.88766476031924, 12949.79133523968], [99.56490829291761, 13000.336091707082], [157.16127098809375, 13046.815729011907], [231.8746375812716, 13089.234362418729], [263.5546670125277, 13127.694332987472], [204.42209657392596, 13162.442903426074], [221.3739418903715, 13193.892058109628], [102.01845477671122, 13222.58154522329], [-107.26947166633909, 13249.18947166634], [-349.0477058718843, 13274.457705871884], [-397.557072853353, 13299.061072853354], [-333.11524280806225, 13323.456242808063]])
    dta = macrodata.load_pandas().data['realgdp'].values
    res = column_stack(hpfilter(dta, 1600))
    assert_almost_equal(res, hpfilt_res, 6)