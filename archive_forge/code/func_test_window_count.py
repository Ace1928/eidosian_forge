from qpd_test.tests_base import TestsBase
import pandas as pd
def test_window_count(self):
    for func in ['COUNT']:
        a = self.make_rand_df(100, a=float, b=(int, 50), c=(str, 50))
        self.eq_sqlite(f'\n                    SELECT a,b,\n                        {func}(b) OVER () AS a1,\n                        {func}(b) OVER (PARTITION BY c) AS a2,\n                        {func}(b+a) OVER (PARTITION BY c,b) AS a3,\n                        {func}(b+a) OVER (PARTITION BY b ORDER BY a\n                            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS a4,\n                        {func}(b+a) OVER (PARTITION BY b ORDER BY a DESC\n                            ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS a5,\n                        {func}(b+a) OVER (PARTITION BY b ORDER BY a\n                            ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n                            AS a6,\n\n                        {func}(c) OVER () AS b1,\n                        {func}(c) OVER (PARTITION BY c) AS b2,\n                        {func}(c) OVER (PARTITION BY c,b) AS b3,\n                        {func}(c) OVER (PARTITION BY b ORDER BY a\n                            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS b4,\n                        {func}(c) OVER (PARTITION BY b ORDER BY a DESC\n                            ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS b5,\n                        {func}(c) OVER (PARTITION BY b ORDER BY a\n                            ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n                            AS b6\n                    FROM a\n                    ', a=a)
        if pd.__version__ >= '1.1':
            self.eq_sqlite(f'\n                        SELECT a,b,\n                            {func}(b) OVER (ORDER BY a DESC\n                                ROWS BETWEEN 2 PRECEDING AND 0 PRECEDING) AS a6,\n                            {func}(b) OVER (PARTITION BY c ORDER BY a DESC\n                                ROWS BETWEEN 2 PRECEDING AND 0 PRECEDING) AS a9,\n\n                            {func}(c) OVER (ORDER BY a DESC\n                                ROWS BETWEEN 2 PRECEDING AND 0 PRECEDING) AS b6,\n                            {func}(c) OVER (PARTITION BY c ORDER BY a DESC\n                                ROWS BETWEEN 2 PRECEDING AND 0 PRECEDING) AS b9\n                        FROM a\n                        ', a=a)