import pytest
import cirq
def test_routed_circuit_with_mapping_multi_swaps():
    q = cirq.LineQubit.range(6)
    circuit = cirq.Circuit([cirq.Moment(cirq.CNOT(q[3], q[4])), cirq.Moment(cirq.CNOT(q[5], q[4]), cirq.CNOT(q[2], q[3])), cirq.Moment(cirq.CNOT(q[2], q[1]), cirq.SWAP(q[4], q[3]).with_tags(cirq.RoutingSwapTag())), cirq.Moment(cirq.SWAP(q[0], q[1]).with_tags(cirq.RoutingSwapTag()), cirq.SWAP(q[3], q[2]).with_tags(cirq.RoutingSwapTag())), cirq.Moment(cirq.CNOT(q[2], q[1])), cirq.Moment(cirq.CNOT(q[1], q[0]))])
    expected_diagram = '\n0: ───q(0)──────────────────────────────────────q(0)───×[cirq.RoutingSwapTag()]───q(1)───────X───\n      │                                         │      │                          │          │\n1: ───q(1)───────────X──────────────────────────q(1)───×──────────────────────────q(0)───X───@───\n      │              │                          │                                 │      │\n2: ───q(2)───────@───@──────────────────────────q(2)───×──────────────────────────q(4)───@───────\n      │          │                              │      │                          │\n3: ───q(3)───@───X───×──────────────────────────q(4)───×[cirq.RoutingSwapTag()]───q(2)───────────\n      │      │       │                          │                                 │\n4: ───q(4)───X───X───×[cirq.RoutingSwapTag()]───q(3)──────────────────────────────q(3)───────────\n      │          │                              │                                 │\n5: ───q(5)───────@──────────────────────────────q(5)──────────────────────────────q(5)───────────\n'
    cirq.testing.assert_has_diagram(cirq.routed_circuit_with_mapping(circuit), expected_diagram)