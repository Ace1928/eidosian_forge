import sys
import pytest
import numpy as np
from typing import NamedTuple
from numpy.testing import assert_allclose
from scipy.special import hyp2f1
from scipy.special._testutils import check_version, MissingModule
@pytest.mark.parametrize('hyp2f1_test_case', [pytest.param(Hyp2f1TestCase(a=4.5, b=16.088264119063613, c=8.5, z=0.6448275862068968 + 0.8724137931034486j, expected=0.018601324701770394 - 0.07618420586062377j, rtol=5e-08)), pytest.param(Hyp2f1TestCase(a=8.25, b=4.25, c=4.5, z=0.6448275862068968 - 0.8724137931034484j, expected=-1.391549471425551 - 0.118036604903893j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=2.050308316530781, c=-1.9631175993998025, z=0.6448275862068968 + 0.8724137931034486j, expected=-2309.178768155151 - 1932.7247727595172j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=1.0, c=-15.964218273004214, z=0.6448275862068968 + 0.8724137931034486j, expected=85592537010.05054 - 8061416766688.324j, rtol=2e-14)), pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=-0.5, c=1.5, z=0.6448275862068968 + 0.8724137931034486j, expected=1.2334498208515172 - 2.1639498536219732j, rtol=5e-11)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=-15.964218273004214, c=4.0, z=0.6448275862068968 + 0.8724137931034486j, expected=102266.35398605966 - 44976.97828737755j, rtol=0.001), marks=pytest.mark.xfail(reason='Unhandled parameters.')), pytest.param(Hyp2f1TestCase(a=4.0, b=-3.956227226099288, c=-15.964218273004214, z=0.6448275862068968 - 0.8724137931034484j, expected=-2.9590030930007236 - 4.190770764773225j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=-15.5, c=-7.5, z=0.5689655172413794 - 0.8724137931034484j, expected=-112554838.92074208 + 174941462.9202412j, rtol=5e-05)), pytest.param(Hyp2f1TestCase(a=-15.980848054962111, b=2.050308316530781, c=1.0, z=0.6448275862068968 - 0.8724137931034484j, expected=3.7519882374080145 + 7.360753798667486j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=2.050308316530781, c=4.0, z=0.6448275862068968 - 0.8724137931034484j, expected=0.000181132943964693 + 0.07742903103815582j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=4.0013768449590685, c=-1.9631175993998025, z=0.5689655172413794 + 0.8724137931034486j, expected=386338.760913596 - 386166.51762171905j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-15.980848054962111, b=8.0, c=-1.92872979730171, z=0.6448275862068968 + 0.8724137931034486j, expected=1348667126.3444858 - 2375132427.158893j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-3.5, b=-0.9629749245209605, c=4.5, z=0.5689655172413794 + 0.8724137931034486j, expected=1.428353429538678 + 0.6472718120804372j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=-0.9629749245209605, c=2.0397202577726152, z=0.5689655172413794 - 0.8724137931034484j, expected=3.1439267526119643 - 3.145305240375117j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-1.9214641416286231, b=-15.964218273004214, c=-7.93846038215665, z=0.6448275862068968 - 0.8724137931034484j, expected=75.27467675681773 + 144.0946946292215j, rtol=1e-07)), pytest.param(Hyp2f1TestCase(a=-3.75, b=-7.75, c=-7.5, z=0.5689655172413794 + 0.8724137931034486j, expected=-0.3699450626264222 + 0.8732812475910993j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=1.5, b=16.5, c=1.0561196186065624, z=0.5689655172413794 - 0.8724137931034484j, expected=5.5361025821300665 - 2.4709693474656285j, rtol=5e-09)), pytest.param(Hyp2f1TestCase(a=1.5, b=8.5, c=-3.9316537064827854, z=0.6448275862068968 - 0.8724137931034484j, expected=-782805.6699207705 - 537192.581278909j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=2.5, b=-15.5, c=1.0561196186065624, z=0.6448275862068968 + 0.8724137931034486j, expected=12.345113400639693 - 14.993248992902007j, rtol=0.0005)), pytest.param(Hyp2f1TestCase(a=1.5, b=-0.5, c=-15.964218273004214, z=0.6448275862068968 + 0.8724137931034486j, expected=23.698109392667842 + 97.15002033534108j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-7.5, b=16.5, c=4.0013768449590685, z=0.6448275862068968 - 0.8724137931034484j, expected=1115.2978631811834 + 915.9212658718577j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-15.5, b=16.5, c=-0.9629749245209605, z=0.6448275862068968 + 0.8724137931034486j, expected=642077722221.6489 + 535274495398.21027j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-7.5, b=-3.5, c=4.0013768449590685, z=0.5689655172413794 + 0.8724137931034486j, expected=-5.689219222945697 + 16.877463062787143j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-15.5, b=-1.5, c=-0.9629749245209605, z=0.5689655172413794 - 0.8724137931034484j, expected=-44.32070290703576 + 1026.9127058617403j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=16.25, b=2.25, c=4.5, z=0.11379310344827598 - 1.024137931034483j, expected=-0.021965227124574663 + 0.009908300237809064j, rtol=0.001), marks=pytest.mark.xfail(reason='Unhandled parameters.')), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=1.5, c=16.5, z=0.26551724137931054 + 1.024137931034483j, expected=1.0046072901244183 + 0.19945500134119992j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=1.0, c=-3.9316537064827854, z=0.3413793103448277 + 0.9482758620689657j, expected=21022.30133421465 + 49175.98317370489j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=16.088264119063613, c=-1.9631175993998025, z=0.4172413793103451 - 0.9482758620689655j, expected=-7024239.358547302 + 2481375.02681063j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=16.25, b=-15.75, c=1.5, z=0.18965517241379315 + 1.024137931034483j, expected=92371704.94848 - 403546832.548352j, rtol=5e-06)), pytest.param(Hyp2f1TestCase(a=8.5, b=-7.949900487447654, c=8.5, z=0.26551724137931054 - 1.024137931034483j, expected=1.9335109845308265 + 5.986542524829654j, rtol=5e-10)), pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=-1.92872979730171, c=-7.93846038215665, z=0.4931034482758623 + 0.8724137931034486j, expected=-122.52639696039328 - 59.72428067512221j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=16.25, b=-1.75, c=-1.5, z=0.4931034482758623 + 0.9482758620689657j, expected=-90.40642053579428 + 50.50649180047921j, rtol=5e-08)), pytest.param(Hyp2f1TestCase(a=-3.5, b=8.077282662161238, c=16.5, z=0.4931034482758623 + 0.9482758620689657j, expected=-0.2155745818150323 - 0.564628986876639j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=1.0561196186065624, c=8.031683612216888, z=0.4172413793103451 - 0.9482758620689655j, expected=0.9503140488280465 + 0.11574960074292677j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-0.75, b=2.25, c=-15.5, z=0.4172413793103451 + 0.9482758620689657j, expected=0.9285862488442175 + 0.8203699266719692j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=-7.75, b=4.25, c=-15.5, z=0.3413793103448277 - 0.9482758620689655j, expected=-1.0509834850116921 - 1.1145522325486075j, rtol=1e-14)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=-0.9629749245209605, c=2.0397202577726152, z=0.4931034482758623 - 0.9482758620689655j, expected=2.88119116536769 - 3.4249933450696806j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-15.5, b=-15.964218273004214, c=16.5, z=0.18965517241379315 + 1.024137931034483j, expected=199.65868451496038 + 347.79384207302877j, rtol=1e-13)), pytest.param(Hyp2f1TestCase(a=-15.75, b=-15.75, c=-3.5, z=0.4931034482758623 - 0.8724137931034484j, expected=-208138312553.07013 + 58631611809.026955j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=-15.5, c=-7.5, z=0.3413793103448277 + 0.9482758620689657j, expected=-23032.90519856288 - 18256.94050457296j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=4.5, b=1.5, c=1.0561196186065624, z=0.4931034482758623 - 0.8724137931034484j, expected=1.507342459587056 + 1.2332023580148403j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=2.5, b=4.5, c=-3.9316537064827854, z=0.4172413793103451 + 0.9482758620689657j, expected=7044.766127108853 - 40210.365567285575j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=1.5, b=-1.5, c=1.0561196186065624, z=0.03793103448275881 + 1.024137931034483j, expected=0.2725347741628333 - 2.247314875514784j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=4.5, b=-1.5, c=-7.949900487447654, z=0.26551724137931054 + 1.024137931034483j, expected=-11.250200011017546 + 12.597393659160472j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-7.5, b=8.5, c=16.088264119063613, z=0.26551724137931054 + 1.024137931034483j, expected=-0.18515160890991517 + 0.7959014164484782j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=-7.5, b=16.5, c=-3.9316537064827854, z=0.3413793103448277 - 1.024137931034483j, expected=998246378.8556538 + 1112032928.103645j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-1.5, b=-3.5, c=2.050308316530781, z=0.03793103448275881 + 1.024137931034483j, expected=0.5527670397711952 + 2.697662715303637j, rtol=1.2e-15)), pytest.param(Hyp2f1TestCase(a=-15.5, b=-1.5, c=-0.9629749245209605, z=0.4931034482758623 - 0.8724137931034484j, expected=55.396931662136886 + 968.467463806326j, rtol=5e-14))])
def test_region5(self, hyp2f1_test_case):
    """1 < |z| < 1.1 and |1 - z| >= 0.9 and real(z) >= 0"""
    a, b, c, z, expected, rtol = hyp2f1_test_case
    assert 1 < abs(z) < 1.1 and abs(1 - z) >= 0.9 and (z.real >= 0)
    assert_allclose(hyp2f1(a, b, c, z), expected, rtol=rtol)