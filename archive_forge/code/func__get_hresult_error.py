from __future__ import (absolute_import, division, print_function)
import traceback
from ansible.errors import AnsibleActionFail, AnsibleConnectionFailure
from ansible.module_utils.common.text.converters import to_native, to_text
from ansible.module_utils.common.validation import check_type_bool, check_type_int
from ansible.plugins.action import ActionBase
from ansible.utils.display import Display
from ..plugin_utils._reboot import reboot_host
def _get_hresult_error(hresult):
    """Converts a WUA HRESULT to a human readable error message.

    Windows doesn't offer an automatic way to get an error message from a WUA HRESULT. This method is used to convert
    those results to a human readable error message based on the values extracted from wuerror.h from the Windows SDK.

    Args:
        hresult (int): The HRESULT to convert.

    Returns:
        (str): The error message for the HRESULT
    """
    error_id, error_msg = {2359297: ('WU_S_SERVICE_STOP', 'Windows Update Agent was stopped successfully'), 2359298: ('WU_S_SELFUPDATE', 'Windows Update Agent updated itself'), 2359299: ('WU_S_UPDATE_ERROR', 'Operation completed successfully but there were errors applying the updates'), 2359300: ('WU_S_MARKED_FOR_DISCONNECT', 'A callback was marked to be disconnected later because the request to disconnect the operation came while a callback was executing'), 2359301: ('WU_S_REBOOT_REQUIRED', 'The system must be restarted to complete installation of the update'), 2359302: ('WU_S_ALREADY_INSTALLED', 'The update to be installed is already installed on the system'), 2359303: ('WU_S_ALREADY_UNINSTALLED', 'The update to be removed is not installed on the system'), 2359304: ('WU_S_ALREADY_DOWNLOADED', 'The update to be downloaded has already been downloaded'), 2359305: ('WU_S_SOME_UPDATES_SKIPPED_ON_BATTERY', 'The operation completed successfully, but some updates were skipped because the system is running on batteries'), 2359306: ('WU_S_ALREADY_REVERTED', 'The update to be reverted is not present on the system'), 2359312: ('WU_S_SEARCH_CRITERIA_NOT_SUPPORTED', 'The operation is skipped because the update service does not support the requested search criteria'), 2367509: ('WU_S_UH_INSTALLSTILLPENDING', 'The installation operation for the update is still in progress'), 2367510: ('WU_S_UH_DOWNLOAD_SIZE_CALCULATED', 'The actual download size has been calculated by the handler'), 2379777: ('WU_S_SIH_NOOP', 'No operation was required by the server-initiated healing server response'), 2383873: ('WU_S_DM_ALREADYDOWNLOADING', 'The update to be downloaded is already being downloaded'), 2388225: ('WU_S_METADATA_SKIPPED_BY_ENFORCEMENTMODE', 'Metadata verification was skipped by enforcement mode'), 2388226: ('WU_S_METADATA_IGNORED_SIGNATURE_VERIFICATION', 'A server configuration refresh resulted in metadata signature verification to be ignored'), 2392065: ('WU_S_SEARCH_LOAD_SHEDDING', 'Search operation completed successfully but one or more services were shedding load'), 2149842945: ('WU_E_NO_SERVICE', 'Windows Update Agent was unable to provide the service'), 2149842946: ('WU_E_MAX_CAPACITY_REACHED', 'The maximum capacity of the service was exceeded'), 2149842947: ('WU_E_UNKNOWN_ID', 'An ID cannot be found'), 2149842948: ('WU_E_NOT_INITIALIZED', 'The object could not be initialized'), 2149842949: ('WU_E_RANGEOVERLAP', 'The update handler requested a byte range overlapping a previously requested range'), 2149842950: ('WU_E_TOOMANYRANGES', 'The requested number of byte ranges exceeds the maximum number (2^31 - 1)'), 2149842951: ('WU_E_INVALIDINDEX', 'The index to a collection was invalid'), 2149842952: ('WU_E_ITEMNOTFOUND', 'The key for the item queried could not be found'), 2149842953: ('WU_E_OPERATIONINPROGRESS', 'Another conflicting operation was in progress. Some operations such as installation cannot be performed twice simultaneously'), 2149842954: ('WU_E_COULDNOTCANCEL', 'Cancellation of the operation was not allowed'), 2149842955: ('WU_E_CALL_CANCELLED', 'Operation was cancelled'), 2149842956: ('WU_E_NOOP', 'No operation was required'), 2149842957: ('WU_E_XML_MISSINGDATA', "Windows Update Agent could not find required information in the update's XML data"), 2149842958: ('WU_E_XML_INVALID', "Windows Update Agent found invalid information in the update's XML data"), 2149842959: ('WU_E_CYCLE_DETECTED', 'Circular update relationships were detected in the metadata'), 2149842960: ('WU_E_TOO_DEEP_RELATION', 'Update relationships too deep to evaluate were evaluated'), 2149842961: ('WU_E_INVALID_RELATIONSHIP', 'An invalid update relationship was detected'), 2149842962: ('WU_E_REG_VALUE_INVALID', 'An invalid registry value was read'), 2149842963: ('WU_E_DUPLICATE_ITEM', 'Operation tried to add a duplicate item to a list'), 2149842964: ('WU_E_INVALID_INSTALL_REQUESTED', 'Updates requested for install are not installable by caller'), 2149842966: ('WU_E_INSTALL_NOT_ALLOWED', 'Operation tried to install while another installation was in progress or the system was pending a mandatory restart'), 2149842967: ('WU_E_NOT_APPLICABLE', 'Operation was not performed because there are no applicable updates'), 2149842968: ('WU_E_NO_USERTOKEN', 'Operation failed because a required user token is missing'), 2149842969: ('WU_E_EXCLUSIVE_INSTALL_CONFLICT', 'An exclusive update cannot be installed with other updates at the same time'), 2149842970: ('WU_E_POLICY_NOT_SET', 'A policy value was not set'), 2149842971: ('WU_E_SELFUPDATE_IN_PROGRESS', 'The operation could not be performed because the Windows Update Agent is self-updating'), 2149842973: ('WU_E_INVALID_UPDATE', 'An update contains invalid metadata'), 2149842974: ('WU_E_SERVICE_STOP', 'Operation did not complete because the service or system was being shut down'), 2149842975: ('WU_E_NO_CONNECTION', 'Operation did not complete because the network connection was unavailable'), 2149842976: ('WU_E_NO_INTERACTIVE_USER', 'Operation did not complete because there is no logged-on interactive user'), 2149842977: ('WU_E_TIME_OUT', 'Operation did not complete because it timed out'), 2149842978: ('WU_E_ALL_UPDATES_FAILED', 'Operation failed for all the updates'), 2149842979: ('WU_E_EULAS_DECLINED', 'The license terms for all updates were declined'), 2149842980: ('WU_E_NO_UPDATE', 'There are no updates'), 2149842981: ('WU_E_USER_ACCESS_DISABLED', 'Group Policy settings prevented access to Windows Update'), 2149842982: ('WU_E_INVALID_UPDATE_TYPE', 'The type of update is invalid'), 2149842983: ('WU_E_URL_TOO_LONG', 'The URL exceeded the maximum length'), 2149842984: ('WU_E_UNINSTALL_NOT_ALLOWED', 'The update could not be uninstalled because the request did not originate from a WSUS server'), 2149842985: ('WU_E_INVALID_PRODUCT_LICENSE', 'Search may have missed some updates before there is an unlicensed application on the system'), 2149842986: ('WU_E_MISSING_HANDLER', 'A component required to detect applicable updates was missing'), 2149842987: ('WU_E_LEGACYSERVER', 'An operation did not complete because it requires a newer version of server'), 2149842988: ('WU_E_BIN_SOURCE_ABSENT', 'A delta-compressed update could not be installed because it required the source'), 2149842989: ('WU_E_SOURCE_ABSENT', 'A full-file update could not be installed because it required the source'), 2149842990: ('WU_E_WU_DISABLED', 'Access to an unmanaged server is not allowed'), 2149842991: ('WU_E_CALL_CANCELLED_BY_POLICY', 'Operation did not complete because the DisableWindowsUpdateAccess policy was set'), 2149842992: ('WU_E_INVALID_PROXY_SERVER', 'The format of the proxy list was invalid'), 2149842993: ('WU_E_INVALID_FILE', 'The file is in the wrong format'), 2149842994: ('WU_E_INVALID_CRITERIA', 'The search criteria string was invalid'), 2149842995: ('WU_E_EULA_UNAVAILABLE', 'License terms could not be downloaded'), 2149842996: ('WU_E_DOWNLOAD_FAILED', 'Update failed to download'), 2149842997: ('WU_E_UPDATE_NOT_PROCESSED', 'The update was not processed'), 2149842998: ('WU_E_INVALID_OPERATION', "The object's current state did not allow the operation"), 2149842999: ('WU_E_NOT_SUPPORTED', 'The functionality for the operation is not supported'), 2149843000: ('WU_E_WINHTTP_INVALID_FILE', 'The downloaded file has an unexpected content type'), 2149843001: ('WU_E_TOO_MANY_RESYNC', 'Agent is asked by server to resync too many times'), 2149843008: ('WU_E_NO_SERVER_CORE_SUPPORT', 'WUA API method does not run on Server Core installation'), 2149843009: ('WU_E_SYSPREP_IN_PROGRESS', 'Service is not available while sysprep is running'), 2149843010: ('WU_E_UNKNOWN_SERVICE', 'The update service is no longer registered with AU'), 2149843011: ('WU_E_NO_UI_SUPPORT', 'There is no support for WUA UI'), 2149843012: ('WU_E_PER_MACHINE_UPDATE_ACCESS_DENIED', 'Only administrators can perform this operation on per-machine updates'), 2149843013: ('WU_E_UNSUPPORTED_SEARCHSCOPE', 'A search was attempted with a scope that is not currently supported for this type of search'), 2149843014: ('WU_E_BAD_FILE_URL', 'The URL does not point to a file'), 2149843015: ('WU_E_REVERT_NOT_ALLOWED', 'The update could not be reverted'), 2149843016: ('WU_E_INVALID_NOTIFICATION_INFO', 'The featured update notification info returned by the server is invalid'), 2149843017: ('WU_E_OUTOFRANGE', 'The data is out of range'), 2149843018: ('WU_E_SETUP_IN_PROGRESS', 'Windows Update agent operations are not available while OS setup is running'), 2149843019: ('WU_E_ORPHANED_DOWNLOAD_JOB', 'An orphaned downloadjob was found with no active callers'), 2149843020: ('WU_E_LOW_BATTERY', 'An update could not be installed because the system battery power level is too low'), 2149843021: ('WU_E_INFRASTRUCTUREFILE_INVALID_FORMAT', 'The downloaded infrastructure file is incorrectly formatted'), 2149843022: ('WU_E_INFRASTRUCTUREFILE_REQUIRES_SSL', 'The infrastructure file must be downloaded using strong SSL'), 2149843023: ('WU_E_IDLESHUTDOWN_OPCOUNT_DISCOVERY', 'A discovery call contributed to a non-zero operation count at idle timer shutdown'), 2149843024: ('WU_E_IDLESHUTDOWN_OPCOUNT_SEARCH', 'A search call contributed to a non-zero operation count at idle timer shutdown'), 2149843025: ('WU_E_IDLESHUTDOWN_OPCOUNT_DOWNLOAD', 'A download call contributed to a non-zero operation count at idle timer shutdown'), 2149843026: ('WU_E_IDLESHUTDOWN_OPCOUNT_INSTALL', 'An install call contributed to a non-zero operation count at idle timer shutdown'), 2149843027: ('WU_E_IDLESHUTDOWN_OPCOUNT_OTHER', 'An unspecified call contributed to a non-zero operation count at idle timer shutdown'), 2149843028: ('WU_E_INTERACTIVE_CALL_CANCELLED', 'An interactive user cancelled this operation, which was started from the Windows Update Agent UI'), 2149843029: ('WU_E_AU_CALL_CANCELLED', 'Automatic Updates cancelled this operation because it applies to an update that is no longer applicable to this computer'), 2149843030: ('WU_E_SYSTEM_UNSUPPORTED', "This version or edition of the operating system doesn't support the needed functionality"), 2149843031: ('WU_E_NO_SUCH_HANDLER_PLUGIN', 'The requested update download or install handler, or update applicability expression evaluator, is not provided by this Agent plugin'), 2149843032: ('WU_E_INVALID_SERIALIZATION_VERSION', 'The requested serialization version is not supported'), 2149843033: ('WU_E_NETWORK_COST_EXCEEDS_POLICY', 'The current network cost does not meet the conditions set by the network cost policy'), 2149843034: ('WU_E_CALL_CANCELLED_BY_HIDE', 'The call is cancelled because it applies to an update that is hidden (no longer applicable to this computer)'), 2149843035: ('WU_E_CALL_CANCELLED_BY_INVALID', 'The call is cancelled because it applies to an update that is invalid (no longer applicable to this computer)'), 2149843036: ('WU_E_INVALID_VOLUMEID', 'The specified volume id is invalid'), 2149843037: ('WU_E_UNRECOGNIZED_VOLUMEID', 'The specified volume id is unrecognized by the system'), 2149843038: ('WU_E_EXTENDEDERROR_NOTSET', 'The installation extended error code is not specified'), 2149843039: ('WU_E_EXTENDEDERROR_FAILED', 'The installation extended error code is set to general fail'), 2149843040: ('WU_E_IDLESHUTDOWN_OPCOUNT_SERVICEREGISTRATION', 'A service registration call contributed to a non-zero operation count at idle timer shutdown'), 2149843041: ('WU_E_FILETRUST_SHA2SIGNATURE_MISSING', 'Signature validation of the file fails to find valid SHA2+ signature on MS signed payload'), 2149843042: ('WU_E_UPDATE_NOT_APPROVED', 'The update is not in the servicing approval list'), 2149843043: ('WU_E_CALL_CANCELLED_BY_INTERACTIVE_SEARCH', 'The search call was cancelled by another interactive search against the same service'), 2149843044: ('WU_E_INSTALL_JOB_RESUME_NOT_ALLOWED', 'Resume of install job not allowed due to another installation in progress'), 2149843045: ('WU_E_INSTALL_JOB_NOT_SUSPENDED', 'Resume of install job not allowed because job is not suspended'), 2149843046: ('WU_E_INSTALL_USERCONTEXT_ACCESSDENIED', 'User context passed to installation from caller with insufficient privileges'), 2149847039: ('WU_E_UNEXPECTED', 'An operation failed due to reasons not covered by another error code'), 2149847041: ('WU_E_MSI_WRONG_VERSION', 'Search may have missed some updates because the Windows Installer is less than version 3.1'), 2149847042: ('WU_E_MSI_NOT_CONFIGURED', 'Search may have missed some updates because the Windows Installer is not configured'), 2149847043: ('WU_E_MSP_DISABLED', 'Search may have missed some updates because policy has disabled Windows Installer patching'), 2149847044: ('WU_E_MSI_WRONG_APP_CONTEXT', 'An update could not be applied because the application is installed per-user'), 2149847045: ('WU_E_MSI_NOT_PRESENT', 'Search may have missed some updates because the Windows Installer is less than version 3.1'), 2149851135: ('WU_E_MSP_UNEXPECTED', 'Search may have missed some updates because there was a failure of the Windows Installer'), 2149859328: ('WU_E_PT_SOAPCLIENT_BASE', 'WU_E_PT_SOAPCLIENT_* error codes map to the SOAPCLIENT_ERROR enum of the ATL Server Library'), 2149859329: ('WU_E_PT_SOAPCLIENT_INITIALIZE', 'Same as SOAPCLIENT_INITIALIZE_ERROR - initialization of the SOAP client failed, possibly because of an MSXML installation failure'), 2149859330: ('WU_E_PT_SOAPCLIENT_OUTOFMEMORY', 'Same as SOAPCLIENT_OUTOFMEMORY - SOAP client failed because it ran out of memory'), 2149859331: ('WU_E_PT_SOAPCLIENT_GENERATE', 'Same as SOAPCLIENT_GENERATE_ERROR - SOAP client failed to generate the request'), 2149859332: ('WU_E_PT_SOAPCLIENT_CONNECT', 'Same as SOAPCLIENT_CONNECT_ERROR - SOAP client failed to connect to the server'), 2149859333: ('WU_E_PT_SOAPCLIENT_SEND', 'Same as SOAPCLIENT_SEND_ERROR - SOAP client failed to send a message for reasons of WU_E_WINHTTP_* error codes'), 2149859334: ('WU_E_PT_SOAPCLIENT_SERVER', 'Same as SOAPCLIENT_SERVER_ERROR - SOAP client failed because there was a server error'), 2149859335: ('WU_E_PT_SOAPCLIENT_SOAPFAULT', 'Same as SOAPCLIENT_SOAPFAULT - SOAP client failed because there was a SOAP fault for reasons of WU_E_PT_SOAP_* error codes'), 2149859336: ('WU_E_PT_SOAPCLIENT_PARSEFAULT', 'Same as SOAPCLIENT_PARSEFAULT_ERROR - SOAP client failed to parse a SOAP fault'), 2149859337: ('WU_E_PT_SOAPCLIENT_READ', 'Same as SOAPCLIENT_READ_ERROR - SOAP client failed while reading the response from the server'), 2149859338: ('WU_E_PT_SOAPCLIENT_PARSE', 'Same as SOAPCLIENT_PARSE_ERROR - SOAP client failed to parse the response from the server'), 2149859339: ('WU_E_PT_SOAP_VERSION', 'Same as SOAP_E_VERSION_MISMATCH - SOAP client found an unrecognizable namespace for the SOAP envelope'), 2149859340: ('WU_E_PT_SOAP_MUST_UNDERSTAND', 'Same as SOAP_E_MUST_UNDERSTAND - SOAP client was unable to understand a header'), 2149859341: ('WU_E_PT_SOAP_CLIENT', 'Same as SOAP_E_CLIENT - SOAP client found the message was malformed; fix before resending'), 2149859342: ('WU_E_PT_SOAP_SERVER', 'Same as SOAP_E_SERVER - The SOAP message could not be processed due to a server error; resend later'), 2149859343: ('WU_E_PT_WMI_ERROR', 'There was an unspecified Windows Management Instrumentation (WMI) error'), 2149859344: ('WU_E_PT_EXCEEDED_MAX_SERVER_TRIPS', 'The number of round trips to the server exceeded the maximum limit'), 2149859345: ('WU_E_PT_SUS_SERVER_NOT_SET', 'WUServer policy value is missing in the registry'), 2149859346: ('WU_E_PT_DOUBLE_INITIALIZATION', 'Initialization failed because the object was already initialized'), 2149859347: ('WU_E_PT_INVALID_COMPUTER_NAME', 'The computer name could not be determined'), 2149859349: ('WU_E_PT_REFRESH_CACHE_REQUIRED', 'The reply from the server indicates that the server was changed or the cookie was invalid; refresh the state of the internal cache and retry'), 2149859350: ('WU_E_PT_HTTP_STATUS_BAD_REQUEST', 'Same as HTTP status 400 - the server could not process the request due to invalid syntax'), 2149859351: ('WU_E_PT_HTTP_STATUS_DENIED', 'Same as HTTP status 401 - the requested resource requires user authentication'), 2149859352: ('WU_E_PT_HTTP_STATUS_FORBIDDEN', 'Same as HTTP status 403 - server understood the request, but declined to fulfill it'), 2149859353: ('WU_E_PT_HTTP_STATUS_NOT_FOUND', 'Same as HTTP status 404 - the server cannot find the requested URI (Uniform Resource Identifier)'), 2149859354: ('WU_E_PT_HTTP_STATUS_BAD_METHOD', 'Same as HTTP status 405 - the HTTP method is not allowed'), 2149859355: ('WU_E_PT_HTTP_STATUS_PROXY_AUTH_REQ', 'Same as HTTP status 407 - proxy authentication is required'), 2149859356: ('WU_E_PT_HTTP_STATUS_REQUEST_TIMEOUT', 'Same as HTTP status 408 - the server timed out waiting for the request'), 2149859357: ('WU_E_PT_HTTP_STATUS_CONFLICT', 'Same as HTTP status 409 - the request was not completed due to a conflict with the current state of the resource'), 2149859358: ('WU_E_PT_HTTP_STATUS_GONE', 'Same as HTTP status 410 - requested resource is no longer available at the server'), 2149859359: ('WU_E_PT_HTTP_STATUS_SERVER_ERROR', 'Same as HTTP status 500 - an error internal to the server prevented fulfilling the request'), 2149859360: ('WU_E_PT_HTTP_STATUS_NOT_SUPPORTED', 'Same as HTTP status 500 - server does not support the functionality required to fulfill the request'), 2149859361: ('WU_E_PT_HTTP_STATUS_BAD_GATEWAY', 'Same as HTTP status 502 - the server, while acting as a gateway or proxy, received an invalid response from the upstream server it accessed in attempting to fulfill the request'), 2149859362: ('WU_E_PT_HTTP_STATUS_SERVICE_UNAVAIL', 'Same as HTTP status 503 - the service is temporarily overloaded'), 2149859363: ('WU_E_PT_HTTP_STATUS_GATEWAY_TIMEOUT', 'Same as HTTP status 503 - the request was timed out waiting for a gateway'), 2149859364: ('WU_E_PT_HTTP_STATUS_VERSION_NOT_SUP', 'Same as HTTP status 505 - the server does not support the HTTP protocol version used for the request'), 2149859365: ('WU_E_PT_FILE_LOCATIONS_CHANGED', 'Operation failed due to a changed file location; refresh internal state and resend'), 2149859366: ('WU_E_PT_REGISTRATION_NOT_SUPPORTED', 'Operation failed because Windows Update Agent does not support registration with a non-WSUS server'), 2149859367: ('WU_E_PT_NO_AUTH_PLUGINS_REQUESTED', 'The server returned an empty authentication information list'), 2149859368: ('WU_E_PT_NO_AUTH_COOKIES_CREATED', 'Windows Update Agent was unable to create any valid authentication cookies'), 2149859369: ('WU_E_PT_INVALID_CONFIG_PROP', 'A configuration property value was wrong'), 2149859370: ('WU_E_PT_CONFIG_PROP_MISSING', 'A configuration property value was missing'), 2149859371: ('WU_E_PT_HTTP_STATUS_NOT_MAPPED', 'The HTTP request could not be completed and the reason did not correspond to any of the WU_E_PT_HTTP_* error codes'), 2149859372: ('WU_E_PT_WINHTTP_NAME_NOT_RESOLVED', 'Same as ERROR_WINHTTP_NAME_NOT_RESOLVED - the proxy server or target server name cannot be resolved'), 2149859373: ('WU_E_PT_LOAD_SHEDDING', 'The server is shedding load'), 2149863469: ('WU_E_PT_SAME_REDIR_ID', 'Windows Update Agent failed to download a redirector cabinet file with a new redirectorId value from the server during the recovery'), 2149863470: ('WU_E_PT_NO_MANAGED_RECOVER', 'A redirector recovery action did not complete because the server is managed'), 2149859375: ('WU_E_PT_ECP_SUCCEEDED_WITH_ERRORS', 'External cab file processing completed with some errors'), 2149859376: ('WU_E_PT_ECP_INIT_FAILED', 'The external cab processor initialization did not complete'), 2149859377: ('WU_E_PT_ECP_INVALID_FILE_FORMAT', 'The format of a metadata file was invalid'), 2149859378: ('WU_E_PT_ECP_INVALID_METADATA', 'External cab processor found invalid metadata'), 2149859379: ('WU_E_PT_ECP_FAILURE_TO_EXTRACT_DIGEST', 'The file digest could not be extracted from an external cab file'), 2149859380: ('WU_E_PT_ECP_FAILURE_TO_DECOMPRESS_CAB_FILE', 'An external cab file could not be decompressed'), 2149859381: ('WU_E_PT_ECP_FILE_LOCATION_ERROR', 'External cab processor was unable to get file locations'), 2149844022: ('WU_E_PT_CATALOG_SYNC_REQUIRED', 'The server does not support category-specific search; Full catalog search has to be issued instead'), 2149844023: ('WU_E_PT_SECURITY_VERIFICATION_FAILURE', 'There was a problem authorizing with the service'), 2149844024: ('WU_E_PT_ENDPOINT_UNREACHABLE', 'There is no route or network connectivity to the endpoint'), 2149844025: ('WU_E_PT_INVALID_FORMAT', 'The data received does not meet the data contract expectations'), 2149844026: ('WU_E_PT_INVALID_URL', 'The url is invalid'), 2149844027: ('WU_E_PT_NWS_NOT_LOADED', 'Unable to load NWS runtime'), 2149844028: ('WU_E_PT_PROXY_AUTH_SCHEME_NOT_SUPPORTED', 'The proxy auth scheme is not supported'), 2149844029: ('WU_E_SERVICEPROP_NOTAVAIL', 'The requested service property is not available'), 2149844030: ('WU_E_PT_ENDPOINT_REFRESH_REQUIRED', 'The endpoint provider plugin requires online refresh'), 2149844031: ('WU_E_PT_ENDPOINTURL_NOTAVAIL', 'A URL for the requested service endpoint is not available'), 2149844032: ('WU_E_PT_ENDPOINT_DISCONNECTED', 'The connection to the service endpoint died'), 2149844033: ('WU_E_PT_INVALID_OPERATION', 'The operation is invalid because protocol talker is in an inappropriate state'), 2149844034: ('WU_E_PT_OBJECT_FAULTED', 'The object is in a faulted state due to a previous error'), 2149844035: ('WU_E_PT_NUMERIC_OVERFLOW', 'The operation would lead to numeric overflow'), 2149844036: ('WU_E_PT_OPERATION_ABORTED', 'The operation was aborted'), 2149844037: ('WU_E_PT_OPERATION_ABANDONED', 'The operation was abandoned'), 2149844038: ('WU_E_PT_QUOTA_EXCEEDED', 'A quota was exceeded'), 2149844039: ('WU_E_PT_NO_TRANSLATION_AVAILABLE', 'The information was not available in the specified language'), 2149844040: ('WU_E_PT_ADDRESS_IN_USE', 'The address is already being used'), 2149844041: ('WU_E_PT_ADDRESS_NOT_AVAILABLE', 'The address is not valid for this context'), 2149844042: ('WU_E_PT_OTHER', 'Unrecognized error occurred in the Windows Web Services framework'), 2149844043: ('WU_E_PT_SECURITY_SYSTEM_FAILURE', 'A security operation failed in the Windows Web Services framework'), 2149863423: ('WU_E_PT_UNEXPECTED', 'A communication error not covered by another WU_E_PT_* error code'), 2149863425: ('WU_E_REDIRECTOR_LOAD_XML', 'The redirector XML document could not be loaded into the DOM class'), 2149863426: ('WU_E_REDIRECTOR_S_FALSE', 'The redirector XML document is missing some required information'), 2149863427: ('WU_E_REDIRECTOR_ID_SMALLER', 'The redirectorId in the downloaded redirector cab is less than in the cached cab'), 2149863428: ('WU_E_REDIRECTOR_UNKNOWN_SERVICE', 'The service ID is not supported in the service environment'), 2149863429: ('WU_E_REDIRECTOR_UNSUPPORTED_CONTENTTYPE', 'The response from the redirector server had an unsupported content type'), 2149863430: ('WU_E_REDIRECTOR_INVALID_RESPONSE', 'The response from the redirector server had an error status or was invalid'), 2149863432: ('WU_E_REDIRECTOR_ATTRPROVIDER_EXCEEDED_MAX_NAMEVALUE', 'The maximum number of name value pairs was exceeded by the attribute provider'), 2149863433: ('WU_E_REDIRECTOR_ATTRPROVIDER_INVALID_NAME', 'The name received from the attribute provider was invalid'), 2149863434: ('WU_E_REDIRECTOR_ATTRPROVIDER_INVALID_VALUE', 'The value received from the attribute provider was invalid'), 2149863435: ('WU_E_REDIRECTOR_SLS_GENERIC_ERROR', 'There was an error in connecting to or parsing the response from the Service Locator Service redirector server'), 2149863436: ('WU_E_REDIRECTOR_CONNECT_POLICY', 'Connections to the redirector server are disallowed by managed policy'), 2149863437: ('WU_E_REDIRECTOR_ONLINE_DISALLOWED', 'The redirector would go online but is disallowed by caller configuration'), 2149863679: ('WU_E_REDIRECTOR_UNEXPECTED', 'The redirector failed for reasons not covered by another WU_E_REDIRECTOR_* error code'), 2149863681: ('WU_E_SIH_VERIFY_DOWNLOAD_ENGINE', 'Verification of the servicing engine package failed'), 2149863682: ('WU_E_SIH_VERIFY_DOWNLOAD_PAYLOAD', 'Verification of a servicing package failed'), 2149863683: ('WU_E_SIH_VERIFY_STAGE_ENGINE', 'Verification of the staged engine failed'), 2149863684: ('WU_E_SIH_VERIFY_STAGE_PAYLOAD', 'Verification of a staged payload failed'), 2149863685: ('WU_E_SIH_ACTION_NOT_FOUND', 'An internal error occurred where the servicing action was not found'), 2149863686: ('WU_E_SIH_SLS_PARSE', 'There was a parse error in the service environment response'), 2149863687: ('WU_E_SIH_INVALIDHASH', 'A downloaded file failed an integrity check'), 2149863688: ('WU_E_SIH_NO_ENGINE', 'No engine was provided by the server-initiated healing server response'), 2149863689: ('WU_E_SIH_POST_REBOOT_INSTALL_FAILED', 'Post-reboot install failed'), 2149863690: ('WU_E_SIH_POST_REBOOT_NO_CACHED_SLS_RESPONSE', 'There were pending reboot actions, but cached SLS response was not found post-reboot'), 2149863691: ('WU_E_SIH_PARSE', 'Parsing command line arguments failed'), 2149863692: ('WU_E_SIH_SECURITY', 'Security check failed'), 2149863693: ('WU_E_SIH_PPL', 'PPL check failed'), 2149863694: ('WU_E_SIH_POLICY', 'Execution was disabled by policy'), 2149863695: ('WU_E_SIH_STDEXCEPTION', 'A standard exception was caught'), 2149863696: ('WU_E_SIH_NONSTDEXCEPTION', 'A non-standard exception was caught'), 2149863697: ('WU_E_SIH_ENGINE_EXCEPTION', 'The server-initiated healing engine encountered an exception not covered by another WU_E_SIH_* error code'), 2149863698: ('WU_E_SIH_BLOCKED_FOR_PLATFORM', 'You are running SIH Client with cmd not supported on your platform'), 2149863699: ('WU_E_SIH_ANOTHER_INSTANCE_RUNNING', 'Another SIH Client is already running'), 2149863700: ('WU_E_SIH_DNSRESILIENCY_OFF', 'Disable DNS resiliency feature per service configuration'), 2149863935: ('WU_E_SIH_UNEXPECTED', 'There was a failure for reasons not covered by another WU_E_SIH_* error code'), 2149892097: ('WU_E_DRV_PRUNED', 'A driver was skipped'), 2149892098: ('WU_E_DRV_NOPROP_OR_LEGACY', 'A property for the driver could not be found. It may not conform with required specifications'), 2149892099: ('WU_E_DRV_REG_MISMATCH', 'The registry type read for the driver does not match the expected type'), 2149892100: ('WU_E_DRV_NO_METADATA', 'The driver update is missing metadata'), 2149892101: ('WU_E_DRV_MISSING_ATTRIBUTE', 'The driver update is missing a required attribute'), 2149892102: ('WU_E_DRV_SYNC_FAILED', 'Driver synchronization failed'), 2149892103: ('WU_E_DRV_NO_PRINTER_CONTENT', 'Information required for the synchronization of applicable printers is missing'), 2149892104: ('WU_E_DRV_DEVICE_PROBLEM', 'After installing a driver update, the updated device has reported a problem'), 2149896191: ('WU_E_DRV_UNEXPECTED', 'A driver error not covered by another WU_E_DRV_* code'), 2149875712: ('WU_E_DS_SHUTDOWN', 'An operation failed because Windows Update Agent is shutting down'), 2149875713: ('WU_E_DS_INUSE', 'An operation failed because the data store was in use'), 2149875714: ('WU_E_DS_INVALID', 'The current and expected states of the data store do not match'), 2149875715: ('WU_E_DS_TABLEMISSING', 'The data store is missing a table'), 2149875716: ('WU_E_DS_TABLEINCORRECT', 'The data store contains a table with unexpected columns'), 2149875717: ('WU_E_DS_INVALIDTABLENAME', 'A table could not be opened because the table is not in the data store'), 2149875718: ('WU_E_DS_BADVERSION', 'The current and expected versions of the data store do not match'), 2149875719: ('WU_E_DS_NODATA', 'The information requested is not in the data store'), 2149875720: ('WU_E_DS_MISSINGDATA', 'The data store is missing required information or has a NULL in a table column that requires a non-null value'), 2149875721: ('WU_E_DS_MISSINGREF', 'The data store is missing required information or has a reference to missing license terms, file, localized property or linked row'), 2149875722: ('WU_E_DS_UNKNOWNHANDLER', 'The update was not processed because its update handler could not be recognized'), 2149875723: ('WU_E_DS_CANTDELETE', 'The update was not deleted because it is still referenced by one or more services'), 2149875724: ('WU_E_DS_LOCKTIMEOUTEXPIRED', 'The data store section could not be locked within the allotted time'), 2149875725: ('WU_E_DS_NOCATEGORIES', 'The category was not added because it contains no parent categories and is not a top-level category itself'), 2149875726: ('WU_E_DS_ROWEXISTS', 'The row was not added because an existing row has the same primary key'), 2149875727: ('WU_E_DS_STOREFILELOCKED', 'The data store could not be initialized because it was locked by another process'), 2149875728: ('WU_E_DS_CANNOTREGISTER', 'The data store is not allowed to be registered with COM in the current process'), 2149875729: ('WU_E_DS_UNABLETOSTART', 'Could not create a data store object in another process'), 2149875731: ('WU_E_DS_DUPLICATEUPDATEID', 'The server sent the same update to the client with two different revision IDs'), 2149875732: ('WU_E_DS_UNKNOWNSERVICE', 'An operation did not complete because the service is not in the data store'), 2149875733: ('WU_E_DS_SERVICEEXPIRED', 'An operation did not complete because the registration of the service has expired'), 2149875734: ('WU_E_DS_DECLINENOTALLOWED', 'A request to hide an update was declined because it is a mandatory update or because it was deployed with a deadline'), 2149875735: ('WU_E_DS_TABLESESSIONMISMATCH', 'A table was not closed because it is not associated with the session'), 2149875736: ('WU_E_DS_SESSIONLOCKMISMATCH', 'A table was not closed because it is not associated with the session'), 2149875737: ('WU_E_DS_NEEDWINDOWSSERVICE', 'A request to remove the Windows Update service or to unregister it with Automatic Updates was declined because it is a built-in service and/or Automatic Updates cannot fall back to another service'), 2149875738: ('WU_E_DS_INVALIDOPERATION', 'A request was declined because the operation is not allowed'), 2149875739: ('WU_E_DS_SCHEMAMISMATCH', 'The schema of the current data store and the schema of a table in a backup XML document do not match'), 2149875740: ('WU_E_DS_RESETREQUIRED', 'The data store requires a session reset; release the session and retry with a new session'), 2149875741: ('WU_E_DS_IMPERSONATED', 'A data store operation did not complete because it was requested with an impersonated identity'), 2149875742: ('WU_E_DS_DATANOTAVAILABLE', 'An operation against update metadata did not complete because the data was never received from server'), 2149875743: ('WU_E_DS_DATANOTLOADED', 'An operation against update metadata did not complete because the data was available but not loaded from datastore'), 2149875744: ('WU_E_DS_NODATA_NOSUCHREVISION', 'A data store operation did not complete because no such update revision is known'), 2149875745: ('WU_E_DS_NODATA_NOSUCHUPDATE', 'A data store operation did not complete because no such update is known'), 2149875746: ('WU_E_DS_NODATA_EULA', "A data store operation did not complete because an update's EULA information is missing"), 2149875747: ('WU_E_DS_NODATA_SERVICE', "A data store operation did not complete because a service's information is missing"), 2149875748: ('WU_E_DS_NODATA_COOKIE', "A data store operation did not complete because a service's synchronization information is missing"), 2149875749: ('WU_E_DS_NODATA_TIMER', "A data store operation did not complete because a timer's information is missing"), 2149875750: ('WU_E_DS_NODATA_CCR', "A data store operation did not complete because a download's information is missing"), 2149875751: ('WU_E_DS_NODATA_FILE', "A data store operation did not complete because a file's information is missing"), 2149875752: ('WU_E_DS_NODATA_DOWNLOADJOB', "A data store operation did not complete because a download job's information is missing"), 2149875753: ('WU_E_DS_NODATA_TMI', "A data store operation did not complete because a service's timestamp information is missing"), 2149879807: ('WU_E_DS_UNEXPECTED', 'A data store error not covered by another WU_E_DS_* code'), 2149879809: ('WU_E_INVENTORY_PARSEFAILED', 'Parsing of the rule file failed'), 2149879810: ('WU_E_INVENTORY_GET_INVENTORY_TYPE_FAILED', 'Failed to get the requested inventory type from the server'), 2149879811: ('WU_E_INVENTORY_RESULT_UPLOAD_FAILED', 'Failed to upload inventory result to the server'), 2149879812: ('WU_E_INVENTORY_UNEXPECTED', 'There was an inventory error not covered by another error code'), 2149879813: ('WU_E_INVENTORY_WMI_ERROR', 'A WMI error occurred when enumerating the instances for a particular class'), 2149883904: ('WU_E_AU_NOSERVICE', 'Automatic Updates was unable to service incoming requests'), 2149883906: ('WU_E_AU_NONLEGACYSERVER', 'The old version of the Automatic Updates client has stopped because the WSUS server has been upgraded'), 2149883907: ('WU_E_AU_LEGACYCLIENTDISABLED', 'The old version of the Automatic Updates client was disabled'), 2149883908: ('WU_E_AU_PAUSED', 'Automatic Updates was unable to process incoming requests because it was paused'), 2149883909: ('WU_E_AU_NO_REGISTERED_SERVICE', 'No unmanaged service is registered with AU'), 2149883910: ('WU_E_AU_DETECT_SVCID_MISMATCH', 'The default service registered with AU changed during the search'), 2149883911: ('WU_E_REBOOT_IN_PROGRESS', 'A reboot is in progress'), 2149883912: ('WU_E_AU_OOBE_IN_PROGRESS', "Automatic Updates can't process incoming requests while Windows Welcome is running"), 2149887999: ('WU_E_AU_UNEXPECTED', 'An Automatic Updates error not covered by another WU_E_AU * code'), 2149851136: ('WU_E_UH_REMOTEUNAVAILABLE', 'A request for a remote update handler could not be completed because no remote process is available'), 2149851137: ('WU_E_UH_LOCALONLY', 'A request for a remote update handler could not be completed because the handler is local only'), 2149851138: ('WU_E_UH_UNKNOWNHANDLER', 'A request for an update handler could not be completed because the handler could not be recognized'), 2149851139: ('WU_E_UH_REMOTEALREADYACTIVE', 'A remote update handler could not be created because one already exists'), 2149851140: ('WU_E_UH_DOESNOTSUPPORTACTION', 'A request for the handler to install (uninstall) an update could not be completed because the update does not support install (uninstall)'), 2149851141: ('WU_E_UH_WRONGHANDLER', 'An operation did not complete because the wrong handler was specified'), 2149851142: ('WU_E_UH_INVALIDMETADATA', 'A handler operation could not be completed because the update contains invalid metadata'), 2149851143: ('WU_E_UH_INSTALLERHUNG', 'An operation could not be completed because the installer exceeded the time limit'), 2149851144: ('WU_E_UH_OPERATIONCANCELLED', 'An operation being done by the update handler was cancelled'), 2149851145: ('WU_E_UH_BADHANDLERXML', 'An operation could not be completed because the handler-specific metadata is invalid'), 2149851146: ('WU_E_UH_CANREQUIREINPUT', 'A request to the handler to install an update could not be completed because the update requires user input'), 2149851147: ('WU_E_UH_INSTALLERFAILURE', 'The installer failed to install (uninstall) one or more updates'), 2149851148: ('WU_E_UH_FALLBACKTOSELFCONTAINED', 'The update handler should download self-contained content rather than delta-compressed content for the update'), 2149851149: ('WU_E_UH_NEEDANOTHERDOWNLOAD', 'The update handler did not install the update because it needs to be downloaded again'), 2149851150: ('WU_E_UH_NOTIFYFAILURE', 'The update handler failed to send notification of the status of the install (uninstall) operation'), 2149851151: ('WU_E_UH_INCONSISTENT_FILE_NAMES', 'The file names contained in the update metadata and in the update package are inconsistent'), 2149851152: ('WU_E_UH_FALLBACKERROR', 'The update handler failed to fall back to the self-contained content'), 2149851153: ('WU_E_UH_TOOMANYDOWNLOADREQUESTS', 'The update handler has exceeded the maximum number of download requests'), 2149851154: ('WU_E_UH_UNEXPECTEDCBSRESPONSE', 'The update handler has received an unexpected response from CBS'), 2149851155: ('WU_E_UH_BADCBSPACKAGEID', 'The update metadata contains an invalid CBS package identifier'), 2149851156: ('WU_E_UH_POSTREBOOTSTILLPENDING', 'The post-reboot operation for the update is still in progress'), 2149851157: ('WU_E_UH_POSTREBOOTRESULTUNKNOWN', 'The result of the post-reboot operation for the update could not be determined'), 2149851158: ('WU_E_UH_POSTREBOOTUNEXPECTEDSTATE', 'The state of the update after its post-reboot operation has completed is unexpected'), 2149851159: ('WU_E_UH_NEW_SERVICING_STACK_REQUIRED', 'The OS servicing stack must be updated before this update is downloaded or installed'), 2149851160: ('WU_E_UH_CALLED_BACK_FAILURE', 'A callback installer called back with an error'), 2149851161: ('WU_E_UH_CUSTOMINSTALLER_INVALID_SIGNATURE', 'The custom installer signature did not match the signature required by the update'), 2149851162: ('WU_E_UH_UNSUPPORTED_INSTALLCONTEXT', 'The installer does not support the installation configuration'), 2149851163: ('WU_E_UH_INVALID_TARGETSESSION', 'The targeted session for install is invalid'), 2149851164: ('WU_E_UH_DECRYPTFAILURE', 'The handler failed to decrypt the update files'), 2149851165: ('WU_E_UH_HANDLER_DISABLEDUNTILREBOOT', 'The update handler is disabled until the system reboots'), 2149851166: ('WU_E_UH_APPX_NOT_PRESENT', 'The AppX infrastructure is not present on the system'), 2149851167: ('WU_E_UH_NOTREADYTOCOMMIT', 'The update cannot be committed because it has not been previously installed or staged'), 2149851168: ('WU_E_UH_APPX_INVALID_PACKAGE_VOLUME', 'The specified volume is not a valid AppX package volume'), 2149851169: ('WU_E_UH_APPX_DEFAULT_PACKAGE_VOLUME_UNAVAILABLE', 'The configured default storage volume is unavailable'), 2149851170: ('WU_E_UH_APPX_INSTALLED_PACKAGE_VOLUME_UNAVAILABLE', 'The volume on which the application is installed is unavailable'), 2149851171: ('WU_E_UH_APPX_PACKAGE_FAMILY_NOT_FOUND', 'The specified package family is not present on the system'), 2149851172: ('WU_E_UH_APPX_SYSTEM_VOLUME_NOT_FOUND', 'Unable to find a package volume marked as system'), 2149855231: ('WU_E_UH_UNEXPECTED', 'An update handler error not covered by another WU_E_UH_* code'), 2149867521: ('WU_E_DM_URLNOTAVAILABLE', 'A download manager operation could not be completed because the requested file does not have a URL'), 2149867522: ('WU_E_DM_INCORRECTFILEHASH', 'A download manager operation could not be completed because the file digest was not recognized'), 2149867523: ('WU_E_DM_UNKNOWNALGORITHM', 'A download manager operation could not be completed because the file metadata requested an unrecognized hash algorithm'), 2149867524: ('WU_E_DM_NEEDDOWNLOADREQUEST', 'An operation could not be completed because a download request is required from the download handler'), 2149867525: ('WU_E_DM_NONETWORK', 'A download manager operation could not be completed because the network connection was unavailable'), 2149867526: ('WU_E_DM_WRONGBITSVERSION', 'A download manager operation could not be completed because the version of Background Intelligent Transfer Service (BITS) is incompatible'), 2149867527: ('WU_E_DM_NOTDOWNLOADED', 'The update has not been downloaded'), 2149867528: ('WU_E_DM_FAILTOCONNECTTOBITS', 'A download manager operation failed because the download manager was unable to connect the Background Intelligent Transfer Service (BITS)'), 2149867529: ('WU_E_DM_BITSTRANSFERERROR', 'A download manager operation failed because there was an unspecified Background Intelligent Transfer Service (BITS) transfer error'), 2149867530: ('WU_E_DM_DOWNLOADLOCATIONCHANGED', 'A download must be restarted because the location of the source of the download has changed'), 2149867531: ('WU_E_DM_CONTENTCHANGED', 'A download must be restarted because the update content changed in a new revision'), 2149867532: ('WU_E_DM_DOWNLOADLIMITEDBYUPDATESIZE', 'A download failed because the current network limits downloads by update size for the update service'), 2149867534: ('WU_E_DM_UNAUTHORIZED', 'The download failed because the client was denied authorization to download the content'), 2149867535: ('WU_E_DM_BG_ERROR_TOKEN_REQUIRED', 'The download failed because the user token associated with the BITS job no longer exists'), 2149867536: ('WU_E_DM_DOWNLOADSANDBOXNOTFOUND', 'The sandbox directory for the downloaded update was not found'), 2149867537: ('WU_E_DM_DOWNLOADFILEPATHUNKNOWN', 'The downloaded update has an unknown file path'), 2149867538: ('WU_E_DM_DOWNLOADFILEMISSING', 'One or more of the files for the downloaded update is missing'), 2149867539: ('WU_E_DM_UPDATEREMOVED', 'An attempt was made to access a downloaded update that has already been removed'), 2149867540: ('WU_E_DM_READRANGEFAILED', "Windows Update couldn't find a needed portion of a downloaded update's file"), 2149867542: ('WU_E_DM_UNAUTHORIZED_NO_USER', 'The download failed because the client was denied authorization to download the content due to no user logged on'), 2149867543: ('WU_E_DM_UNAUTHORIZED_LOCAL_USER', 'The download failed because the local user was denied authorization to download the content'), 2149867544: ('WU_E_DM_UNAUTHORIZED_DOMAIN_USER', 'The download failed because the domain user was denied authorization to download the content'), 2149867545: ('WU_E_DM_UNAUTHORIZED_MSA_USER', 'The download failed because the MSA account associated with the user was denied authorization to download the content'), 2149867546: ('WU_E_DM_FALLINGBACKTOBITS', 'The download will be continued by falling back to BITS to download the content'), 2149867547: ('WU_E_DM_DOWNLOAD_VOLUME_CONFLICT', 'Another caller has requested download to a different volume'), 2149867548: ('WU_E_DM_SANDBOX_HASH_MISMATCH', "The hash of the update's sandbox does not match the expected value"), 2149867549: ('WU_E_DM_HARDRESERVEID_CONFLICT', 'The hard reserve id specified conflicts with an id from another caller'), 2149867550: ('WU_E_DM_DOSVC_REQUIRED', 'The update has to be downloaded via DO'), 2149871615: ('WU_E_DM_UNEXPECTED', 'There was a download manager error not covered by another WU_E_DM_* error code'), 2149896193: ('WU_E_SETUP_INVALID_INFDATA', 'Windows Update Agent could not be updated because an INF file contains invalid information'), 2149896194: ('WU_E_SETUP_INVALID_IDENTDATA', 'Windows Update Agent could not be updated because the wuident.cab file contains invalid information'), 2149896195: ('WU_E_SETUP_ALREADY_INITIALIZED', 'Windows Update Agent could not be updated because of an internal error that caused setup initialization to be performed twice'), 2149896196: ('WU_E_SETUP_NOT_INITIALIZED', 'Windows Update Agent could not be updated because setup initialization never completed successfully'), 2149896197: ('WU_E_SETUP_SOURCE_VERSION_MISMATCH', 'Windows Update Agent could not be updated because the versions specified in the INF do not match the actual source file versions'), 2149896198: ('WU_E_SETUP_TARGET_VERSION_GREATER', 'Windows Update Agent could not be updated because a WUA file on the target system is newer than the corresponding source file'), 2149896199: ('WU_E_SETUP_REGISTRATION_FAILED', 'Windows Update Agent could not be updated because regsvr32.exe returned an error'), 2149896200: ('WU_E_SELFUPDATE_SKIP_ON_FAILURE', 'An update to the Windows Update Agent was skipped because previous attempts to update have failed'), 2149896201: ('WU_E_SETUP_SKIP_UPDATE', 'An update to the Windows Update Agent was skipped due to a directive in the wuident.cab file'), 2149896202: ('WU_E_SETUP_UNSUPPORTED_CONFIGURATION', 'Windows Update Agent could not be updated because the current system configuration is not supported'), 2149896203: ('WU_E_SETUP_BLOCKED_CONFIGURATION', 'Windows Update Agent could not be updated because the system is configured to block the update'), 2149896204: ('WU_E_SETUP_REBOOT_TO_FIX', 'Windows Update Agent could not be updated because a restart of the system is required'), 2149896205: ('WU_E_SETUP_ALREADYRUNNING', 'Windows Update Agent setup is already running'), 2149896206: ('WU_E_SETUP_REBOOTREQUIRED', 'Windows Update Agent setup package requires a reboot to complete installation'), 2149896207: ('WU_E_SETUP_HANDLER_EXEC_FAILURE', 'Windows Update Agent could not be updated because the setup handler failed during execution'), 2149896208: ('WU_E_SETUP_INVALID_REGISTRY_DATA', 'Windows Update Agent could not be updated because the registry contains invalid information'), 2149896209: ('WU_E_SELFUPDATE_REQUIRED', 'Windows Update Agent must be updated before search can continue'), 2149896210: ('WU_E_SELFUPDATE_REQUIRED_ADMIN', 'Windows Update Agent must be updated before search can continue.  An administrator is required to perform the operation'), 2149896211: ('WU_E_SETUP_WRONG_SERVER_VERSION', 'Windows Update Agent could not be updated because the server does not contain update information for this version'), 2149896212: ('WU_E_SETUP_DEFERRABLE_REBOOT_PENDING', 'Windows Update Agent is successfully updated, but a reboot is required to complete the setup'), 2149896213: ('WU_E_SETUP_NON_DEFERRABLE_REBOOT_PENDING', 'Windows Update Agent is successfully updated, but a reboot is required to complete the setup'), 2149896214: ('WU_E_SETUP_FAIL', 'Windows Update Agent could not be updated because of an unknown error'), 2149900287: ('WU_E_SETUP_UNEXPECTED', 'Windows Update Agent could not be updated because of an error not covered by another WU_E_SETUP_* error code'), 2149900289: ('WU_E_EE_UNKNOWN_EXPRESSION', 'An expression evaluator operation could not be completed because an expression was unrecognized'), 2149900290: ('WU_E_EE_INVALID_EXPRESSION', 'An expression evaluator operation could not be completed because an expression was invalid'), 2149900291: ('WU_E_EE_MISSING_METADATA', 'An expression evaluator operation could not be completed because an expression contains an incorrect number of metadata nodes'), 2149900292: ('WU_E_EE_INVALID_VERSION', 'An expression evaluator operation could not be completed because the version of the serialized expression data is invalid'), 2149900293: ('WU_E_EE_NOT_INITIALIZED', 'The expression evaluator could not be initialized'), 2149900294: ('WU_E_EE_INVALID_ATTRIBUTEDATA', 'An expression evaluator operation could not be completed because there was an invalid attribute'), 2149900295: ('WU_E_EE_CLUSTER_ERROR', 'An expression evaluator operation could not be completed because the cluster state of the computer could not be determined'), 2149904383: ('WU_E_EE_UNEXPECTED', 'There was an expression evaluator error not covered by another WU_E_EE_* error code'), 2149855233: ('WU_E_INSTALLATION_RESULTS_UNKNOWN_VERSION', 'The results of download and installation could not be read from the registry due to an unrecognized data format version'), 2149855234: ('WU_E_INSTALLATION_RESULTS_INVALID_DATA', 'The results of download and installation could not be read from the registry due to an invalid data format'), 2149855235: ('WU_E_INSTALLATION_RESULTS_NOT_FOUND', 'The results of download and installation are not available; the operation may have failed to start'), 2149855236: ('WU_E_TRAYICON_FAILURE', 'A failure occurred when trying to create an icon in the taskbar notification area'), 2149859325: ('WU_E_NON_UI_MODE', 'Unable to show UI when in non-UI mode; WU client UI modules may not be installed'), 2149859326: ('WU_E_WUCLTUI_UNSUPPORTED_VERSION', 'Unsupported version of WU client UI exported functions'), 2149859327: ('WU_E_AUCLIENT_UNEXPECTED', 'There was a user interface error not covered by another WU_E_AUCLIENT_* error code'), 2149904385: ('WU_E_REPORTER_EVENTCACHECORRUPT', 'The event cache file was defective'), 2149904386: ('WU_E_REPORTER_EVENTNAMESPACEPARSEFAILED', 'The XML in the event namespace descriptor could not be parsed'), 2149904387: ('WU_E_INVALID_EVENT', 'The XML in the event namespace descriptor could not be parsed'), 2149904388: ('WU_E_SERVER_BUSY', 'The server rejected an event because the server was too busy'), 2149904389: ('WU_E_CALLBACK_COOKIE_NOT_FOUND', 'The specified callback cookie is not found'), 2149908479: ('WU_E_REPORTER_UNEXPECTED', 'There was a reporter error not covered by another error code'), 2149871617: ('WU_E_OL_INVALID_SCANFILE', 'An operation could not be completed because the scan package was invalid'), 2149871618: ('WU_E_OL_NEWCLIENT_REQUIRED', 'An operation could not be completed because the scan package requires a greater version of the Windows Update Agent'), 2149871619: ('WU_E_INVALID_EVENT_PAYLOAD', 'An invalid event payload was specified'), 2149871620: ('WU_E_INVALID_EVENT_PAYLOADSIZE', 'The size of the event payload submitted is invalid'), 2149871621: ('WU_E_SERVICE_NOT_REGISTERED', 'The service is not registered'), 2149875711: ('WU_E_OL_UNEXPECTED', 'Search using the scan package failed'), 2149871872: ('WU_E_METADATA_NOOP', 'No operation was required by update metadata verification'), 2149871873: ('WU_E_METADATA_CONFIG_INVALID_BINARY_ENCODING', 'The binary encoding of metadata config data was invalid'), 2149871874: ('WU_E_METADATA_FETCH_CONFIG', 'Unable to fetch required configuration for metadata signature verification'), 2149871876: ('WU_E_METADATA_INVALID_PARAMETER', 'A metadata verification operation failed due to an invalid parameter'), 2149871877: ('WU_E_METADATA_UNEXPECTED', 'A metadata verification operation failed due to reasons not covered by another error code'), 2149871878: ('WU_E_METADATA_NO_VERIFICATION_DATA', 'None of the update metadata had verification data, which may be disabled on the update server'), 2149871879: ('WU_E_METADATA_BAD_FRAGMENTSIGNING_CONFIG', 'The fragment signing configuration used for verifying update metadata signatures was bad'), 2149871880: ('WU_E_METADATA_FAILURE_PROCESSING_FRAGMENTSIGNING_CONFIG', 'There was an unexpected operational failure while parsing fragment signing configuration'), 2149871904: ('WU_E_METADATA_XML_MISSING', 'Required xml data was missing from configuration'), 2149871905: ('WU_E_METADATA_XML_FRAGMENTSIGNING_MISSING', 'Required fragmentsigning data was missing from xml configuration'), 2149871906: ('WU_E_METADATA_XML_MODE_MISSING', 'Required mode data was missing from xml configuration'), 2149871907: ('WU_E_METADATA_XML_MODE_INVALID', 'An invalid metadata enforcement mode was detected'), 2149871908: ('WU_E_METADATA_XML_VALIDITY_INVALID', 'An invalid timestamp validity window configuration was detected'), 2149871909: ('WU_E_METADATA_XML_LEAFCERT_MISSING', 'Required leaf certificate data was missing from xml configuration'), 2149871910: ('WU_E_METADATA_XML_INTERMEDIATECERT_MISSING', 'Required intermediate certificate data was missing from xml configuration'), 2149871911: ('WU_E_METADATA_XML_LEAFCERT_ID_MISSING', 'Required leaf certificate id attribute was missing from xml configuration'), 2149871912: ('WU_E_METADATA_XML_BASE64CERDATA_MISSING', 'Required certificate base64CerData attribute was missing from xml configuration'), 2149871936: ('WU_E_METADATA_BAD_SIGNATURE', 'The metadata for an update was found to have a bad or invalid digital signature'), 2149871937: ('WU_E_METADATA_UNSUPPORTED_HASH_ALG', 'An unsupported hash algorithm for metadata verification was specified'), 2149871938: ('WU_E_METADATA_SIGNATURE_VERIFY_FAILED', "An error occurred during an update's metadata signature verification"), 2149871952: ('WU_E_METADATATRUST_CERTIFICATECHAIN_VERIFICATION', 'An failure occurred while verifying trust for metadata signing certificate chains'), 2149871953: ('WU_E_METADATATRUST_UNTRUSTED_CERTIFICATECHAIN', 'A metadata signing certificate had an untrusted certificate chain'), 2149871968: ('WU_E_METADATA_TIMESTAMP_TOKEN_MISSING', 'An expected metadata timestamp token was missing'), 2149871969: ('WU_E_METADATA_TIMESTAMP_TOKEN_VERIFICATION_FAILED', 'A metadata Timestamp token failed verification'), 2149871970: ('WU_E_METADATA_TIMESTAMP_TOKEN_UNTRUSTED', 'A metadata timestamp token signer certificate chain was untrusted'), 2149871971: ('WU_E_METADATA_TIMESTAMP_TOKEN_VALIDITY_WINDOW', 'A metadata signature timestamp token was no longer within the validity window'), 2149871972: ('WU_E_METADATA_TIMESTAMP_TOKEN_SIGNATURE', 'A metadata timestamp token failed signature validation'), 2149871973: ('WU_E_METADATA_TIMESTAMP_TOKEN_CERTCHAIN', 'A metadata timestamp token certificate failed certificate chain verification'), 2149871974: ('WU_E_METADATA_TIMESTAMP_TOKEN_REFRESHONLINE', 'A failure occurred when refreshing a missing timestamp token from the network'), 2149871975: ('WU_E_METADATA_TIMESTAMP_TOKEN_ALL_BAD', 'All update metadata verification timestamp tokens from the timestamp token cache are invalid'), 2149871976: ('WU_E_METADATA_TIMESTAMP_TOKEN_NODATA', 'No update metadata verification timestamp tokens exist in the timestamp token cache'), 2149871977: ('WU_E_METADATA_TIMESTAMP_TOKEN_CACHELOOKUP', 'An error occurred during cache lookup of update metadata verification timestamp token'), 2149871998: ('WU_E_METADATA_TIMESTAMP_TOKEN_VALIDITYWINDOW_UNEXPECTED', 'An metadata timestamp token validity window failed unexpectedly due to reasons not covered by another error code'), 2149871999: ('WU_E_METADATA_TIMESTAMP_TOKEN_UNEXPECTED', 'An metadata timestamp token verification operation failed due to reasons not covered by another error code'), 2149872000: ('WU_E_METADATA_CERT_MISSING', 'An expected metadata signing certificate was missing'), 2149872001: ('WU_E_METADATA_LEAFCERT_BAD_TRANSPORT_ENCODING', 'The transport encoding of a metadata signing leaf certificate was malformed'), 2149872002: ('WU_E_METADATA_INTCERT_BAD_TRANSPORT_ENCODING', 'The transport encoding of a metadata signing intermediate certificate was malformed'), 2149872003: ('WU_E_METADATA_CERT_UNTRUSTED', 'A metadata certificate chain was untrusted'), 2149888001: ('WU_E_WUTASK_INPROGRESS', 'The task is currently in progress'), 2149888002: ('WU_E_WUTASK_STATUS_DISABLED', 'The operation cannot be completed since the task status is currently disabled'), 2149888003: ('WU_E_WUTASK_NOT_STARTED', 'The operation cannot be completed since the task is not yet started'), 2149888004: ('WU_E_WUTASK_RETRY', 'The task was stopped and needs to be run again to complete'), 2149888005: ('WU_E_WUTASK_CANCELINSTALL_DISALLOWED', 'Cannot cancel a non-scheduled install'), 2149888257: ('WU_E_UNKNOWN_HARDWARECAPABILITY', 'Hardware capability meta data was not found after a sync with the service'), 2149888258: ('WU_E_BAD_XML_HARDWARECAPABILITY', 'Hardware capability meta data was malformed and/or failed to parse'), 2149888259: ('WU_E_WMI_NOT_SUPPORTED', "Unable to complete action due to WMI dependency, which isn't supported on this platform"), 2149888260: ('WU_E_UPDATE_MERGE_NOT_ALLOWED', 'Merging of the update is not allowed'), 2149888261: ('WU_E_SKIPPED_UPDATE_INSTALLATION', 'Installing merged updates only. So skipping non mergeable updates'), 2149888513: ('WU_E_SLS_INVALID_REVISION', 'SLS response returned invalid revision number'), 2149888769: ('WU_E_FILETRUST_DUALSIGNATURE_RSA', 'File signature validation fails to find valid RSA signature on infrastructure payload'), 2149888770: ('WU_E_FILETRUST_DUALSIGNATURE_ECC', 'File signature validation fails to find valid ECC signature on infrastructure payload'), 2149888771: ('WU_E_TRUST_SUBJECT_NOT_TRUSTED', 'The subject is not trusted by WU for the specified action'), 2149888772: ('WU_E_TRUST_PROVIDER_UNKNOWN', 'Unknown trust provider for WU'), 2149890305: ('WU_E_RUXIM_EXCEPTION', 'An unexpected exception occurred during RUXIM processing'), 2149890306: ('WU_E_RUXIM_LOGGINGCVERROR', 'An error occurred while processing the correlation vector during RUXIM logging'), 2149890307: ('WU_E_RUXIM_UNEXPECTEDINTERACTIONRESPONSE', 'The RUXIM Interaction Handler returned an unexpected response while processing an interaction campaign'), 2149890308: ('WU_E_RUXIM_INTERACTIONALREADYCOMPLETED', 'An attempt was made to present a RUXIM interaction campaign that is already completed'), 2149890309: ('WU_E_RUXIM_STOREDSTATENOTAVAILABLE', 'RUXIM was unable to create or retrieve the stored state for an interaction campaign'), 2149890310: ('WU_E_RUXIM_NOSUCHINTERACTIONCAMPAIGN', 'RUXIM was unable to retrieve the requested interaction campaign'), 2149890335: ('WU_E_RUXIM_UNEXPECTED', 'An unexpected failure occurred during RUXIM processing'), 2149890336: ('WU_E_RUXIM_ICSPEC_INVALIDFORMAT', 'The RUXIM interaction campaign specification does not have the expected XML format'), 2149890337: ('WU_E_RUXIM_ICSPEC_MISSINGCONTROLCUSTOMIZATION', 'The RUXIM interaction campaign specification does not have a control customization for one or more controls in the interaction'), 2149890338: ('WU_E_RUXIM_ICSPEC_NOSUITABLELOCALIZATION', "The RUXIM interaction campaign specification does not have localized resources that match the user's preferred languages"), 2149890339: ('WU_E_RUXIM_ICSPEC_COMMANDLINETOOLONG', 'The RUXIM interaction campaign specification specifies an immediate action, and the command line set for that immediate action is too long'), 2149890340: ('WU_E_RUXIM_ICSPEC_DIRECTORYPATHTOOLONG', 'The RUXIM interaction campaign specification specifies an immediate action, and the current directory set for that immediate action is too long'), 2149890341: ('WU_E_RUXIM_ICSPEC_PARAMETEROUTOFRANGE', 'The RUXIM interaction campaign specification includes a parameter that is too large or too small'), 2149890367: ('WU_E_RUXIM_ICSPEC_UNEXPECTED', 'An unexpected problem occurred while processing an interaction campaign specification'), 2149890368: ('WU_E_RUXIM_ICO_NOREMAININGCAMPAIGNS', 'There are no more interaction campaigns remaining to evaluate'), 2149890384: ('WU_E_RUXIM_ICS_IHRESULTUNKNOWN', 'Interaction Campaign Scheduler launched Interaction Handler to process a campaign, but Interaction Handler did not report its result'), 2149890496: ('WU_E_EVALUATOR_UNKNOWNCHECKHANDLERNAME', 'The evaluation request includes a check handler name which the Evaluator DLL does not support'), 2149890497: ('WU_E_EVALUATOR_UNKNOWNCHECKNAME', 'The evaluation request includes a check name which the Evaluator DLL does not support'), 2149890498: ('WU_E_EVALUATOR_UNKNOWNCOMPARISON', 'The evaluation request includes a comparison which the Evaluator DLL does not support'), 2149890499: ('WU_E_EVALUATOR_MISFORMATTEDCHECKNAME', "The evaluation request includes a check node whose check node is not in the format 'checkhandlername:checkname'"), 2149890500: ('WU_E_EVALUATOR_INVALIDCHECKPARAMETERS', 'The evaluation request includes a check which requires parameters, and one of those parameters is missing or in an unexpected format'), 2149890501: ('WU_E_EVALUATOR_INVALIDNOT', "The evaluation request includes a 'not' attribute on a check which does not return a Boolean value"), 2149890559: ('WU_E_EVALUATOR_UNEXPECTED', 'An unexpected error occurred while processing an evaluation request')}.get(hresult, ('UNKNOWN', 'Unknown WUA HRESULT %s' % hresult))
    return '%s (%s 0x%08X)' % (error_msg, error_id, hresult & 4294967295)