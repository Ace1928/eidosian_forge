from mpmath import *
from mpmath.libmp import round_up, from_float, mpf_zeta_int
def test_polygamma_high_order():
    mp.dps = 100
    assert str(psi(50, pi)) == '-1344100348958402765749252447726432491812.641985273160531055707095989227897753035823152397679626136483'
    assert str(psi(50, pi + 14 * e)) == '-0.00000000000000000189793739550804321623512073101895801993019919886375952881053090844591920308111549337295143780341396'
    assert str(psi(50, pi + 14 * e * j)) == '(-0.00000000000000005225169411521692489752254721556835657523758895106315132447859377385233700094871256507814151956624433 - 0.00000000000000001813157041407010184702414110218205348527862196327980417757665282244728963891298080199341480881811613j)'
    mp.dps = 15
    assert str(psi(50, pi)) == '-1.34410034895841e+39'
    assert str(psi(50, pi + 14 * e)) == '-1.89793739550804e-18'
    assert str(psi(50, pi + 14 * e * j)) == '(-5.2251694115217e-17 - 1.81315704140701e-17j)'