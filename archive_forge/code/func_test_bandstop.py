import warnings
from scipy._lib import _pep440
import numpy as np
from numpy.testing import (assert_array_almost_equal,
import pytest
from pytest import raises as assert_raises
from numpy import array, spacing, sin, pi, sort, sqrt
from scipy.signal import (argrelextrema, BadCoefficients, bessel, besselap, bilinear,
from scipy.signal._filter_design import (_cplxreal, _cplxpair, _norm_factor,
def test_bandstop(self):
    z, p, k = ellip(8, 1, 65, [0.2, 0.4], 'stop', output='zpk')
    z2 = [0.352857809428651 + 0.9356769561794296j, 0.352857809428651 - 0.9356769561794296j, 0.3769716042264783 + 0.9262248159096587j, 0.3769716042264783 - 0.9262248159096587j, 0.4406101783111199 + 0.8976985411420985j, 0.4406101783111199 - 0.8976985411420985j, 0.5539386470258847 + 0.832557490706276j, 0.5539386470258847 - 0.832557490706276j, 0.6748464963023645 + 0.7379581332490555j, 0.6748464963023645 - 0.7379581332490555j, 0.7489887970285254 + 0.6625826604475596j, 0.7489887970285254 - 0.6625826604475596j, 0.7913118471618432 + 0.6114127579150699j, 0.7913118471618432 - 0.6114127579150699j, 0.7806804740916381 + 0.6249303940216475j, 0.7806804740916381 - 0.6249303940216475j]
    p2 = [-0.102529914669373 + 0.5662682444754943j, -0.102529914669373 - 0.5662682444754943j, 0.1698463595163031 + 0.8926678667070186j, 0.1698463595163031 - 0.8926678667070186j, 0.2750532687820631 + 0.9351020170094005j, 0.2750532687820631 - 0.9351020170094005j, 0.3070095178909486 + 0.9457373499553291j, 0.3070095178909486 - 0.9457373499553291j, 0.7695332312152288 + 0.2792567212705257j, 0.7695332312152288 - 0.2792567212705257j, 0.808381899922562 + 0.499072349686396j, 0.808381899922562 - 0.499072349686396j, 0.8066158014414928 + 0.5649811440393374j, 0.8066158014414928 - 0.5649811440393374j, 0.8062787978834571 + 0.5855780880424964j, 0.8062787978834571 - 0.5855780880424964j]
    k2 = 0.2068622545291259
    assert_allclose(sorted(z, key=np.angle), sorted(z2, key=np.angle), rtol=1e-06)
    assert_allclose(sorted(p, key=np.angle), sorted(p2, key=np.angle), rtol=1e-05)
    assert_allclose(k, k2, rtol=1e-05)