import os
from glob import glob
import numpy as np
from ... import logging
from ...utils.filemanip import ensure_list, simplify_list, split_filename
from ..base import (
from .base import SPMCommand, SPMCommandInputSpec, scans_for_fnames, ImageFileSPM
class Level1DesignInputSpec(SPMCommandInputSpec):
    spm_mat_dir = Directory(exists=True, field='dir', desc='directory to store SPM.mat file (opt)')
    timing_units = traits.Enum('secs', 'scans', field='timing.units', desc='units for specification of onsets', mandatory=True)
    interscan_interval = traits.Float(field='timing.RT', desc='Interscan interval in secs', mandatory=True)
    microtime_resolution = traits.Int(field='timing.fmri_t', desc='Number of time-bins per scan in secs (opt)')
    microtime_onset = traits.Float(field='timing.fmri_t0', desc='The onset/time-bin in seconds for alignment (opt)')
    session_info = traits.Any(field='sess', desc='Session specific information generated by ``modelgen.SpecifyModel``', mandatory=True)
    factor_info = traits.List(traits.Dict(traits.Enum('name', 'levels')), field='fact', desc='Factor specific information file (opt)')
    bases = traits.Dict(traits.Enum('hrf', 'fourier', 'fourier_han', 'gamma', 'fir'), field='bases', desc='Dictionary names of the basis function to parameters:\n\n    * hrf\n\n        * derivs -- (2-element list) Model  HRF  Derivatives. No derivatives: [0,0],\n          Time derivatives : [1,0], Time and Dispersion derivatives: [1,1]\n\n    * fourier, fourier_han, gamma, or fir:\n\n        * length -- (int) Post-stimulus window length (in seconds)\n        * order -- (int) Number of basis functions\n\n', mandatory=True)
    volterra_expansion_order = traits.Enum(1, 2, field='volt', desc='Model interactions - no:1, yes:2')
    global_intensity_normalization = traits.Enum('none', 'scaling', field='global', desc='Global intensity normalization - scaling or none')
    mask_image = File(exists=True, field='mask', desc='Image  for  explicitly  masking the analysis')
    mask_threshold = traits.Either(traits.Enum('-Inf'), traits.Float(), desc='Thresholding for the mask', default='-Inf', usedefault=True)
    model_serial_correlations = traits.Enum('AR(1)', 'FAST', 'none', field='cvi', desc='Model serial correlations AR(1), FAST or none. FAST is available in SPM12')
    flags = traits.Dict(desc='Additional arguments to the job, e.g., a common SPM operation is to modify the default masking threshold (mthresh)')