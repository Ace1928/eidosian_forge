import re
from pygments.lexer import Lexer, RegexLexer, do_insertions, bygroups, words
from pygments.token import Punctuation, Whitespace, Text, Comment, Operator, \
from pygments.lexers import get_lexer_by_name, ClassNotFound
from pygments.lexers._postgres_builtins import KEYWORDS, DATATYPES, \
from pygments.lexers._mysql_builtins import \
from pygments.lexers import _tsql_builtins
class PostgresExplainLexer(RegexLexer):
    """
    Handle PostgreSQL EXPLAIN output

    .. versionadded:: 2.15
    """
    name = 'PostgreSQL EXPLAIN dialect'
    aliases = ['postgres-explain']
    filenames = ['*.explain']
    mimetypes = ['text/x-postgresql-explain']
    tokens = {'root': [('(:|\\(|\\)|ms|kB|->|\\.\\.|\\,)', Punctuation), ('(\\s+)', Whitespace), ('(cost)(=?)', bygroups(Name.Class, Punctuation), 'instrumentation'), ('(actual)( )(=?)', bygroups(Name.Class, Whitespace, Punctuation), 'instrumentation'), (words(('actual', 'Memory Usage', 'Memory', 'Buckets', 'Batches', 'originally', 'row', 'rows', 'Hits', 'Misses', 'Evictions', 'Overflows'), suffix='\\b'), Comment.Single), ('(hit|read|dirtied|written|write|time|calls)(=)', bygroups(Comment.Single, Operator)), ('(shared|temp|local)', Keyword.Pseudo), ('(Sort Method)(: )', bygroups(Comment.Preproc, Punctuation), 'sort'), ('(Sort Key|Group Key|Presorted Key|Hash Key)(:)( )', bygroups(Comment.Preproc, Punctuation, Whitespace), 'object_name'), ('(Cache Key|Cache Mode)(:)( )', bygroups(Comment, Punctuation, Whitespace), 'object_name'), (words(('Join Filter', 'Subplans Removed', 'Filter', 'Merge Cond', 'Hash Cond', 'Index Cond', 'Recheck Cond', 'Heap Blocks', 'TID Cond', 'Run Condition', 'Order By', 'Function Call', 'Table Function Call', 'Inner Unique', 'Params Evaluated', 'Single Copy', 'Sampling', 'One-Time Filter', 'Output', 'Relations', 'Remote SQL'), suffix='\\b'), Comment.Preproc, 'predicate'), ('Conflict ', Comment.Preproc, 'conflict'), ('(InitPlan|SubPlan)( )(\\d+)( )', bygroups(Keyword, Whitespace, Number.Integer, Whitespace), 'init_plan'), (words(('Sort Method', 'Join Filter', 'Planning time', 'Planning Time', 'Execution time', 'Execution Time', 'Workers Planned', 'Workers Launched', 'Buffers', 'Planning', 'Worker', 'Query Identifier', 'Time', 'Full-sort Groups', 'Pre-sorted Groups'), suffix='\\b'), Comment.Preproc), (words(('Rows Removed by Join Filter', 'Rows Removed by Filter', 'Rows Removed by Index Recheck', 'Heap Fetches', 'never executed'), suffix='\\b'), Name.Exception), ('(I/O Timings)(:)( )', bygroups(Name.Exception, Punctuation, Whitespace)), (words(EXPLAIN_KEYWORDS, suffix='\\b'), Keyword), ('((Right|Left|Full|Semi|Anti) Join)', Keyword.Type), ('(Parallel |Async |Finalize |Partial )', Comment.Preproc), ('Backward', Comment.Preproc), ('(Intersect|Except|Hash)', Comment.Preproc), ('(CTE)( )(\\w*)?', bygroups(Comment, Whitespace, Name.Variable)), ('(on|using)', Punctuation, 'object_name'), ("'(''|[^'])*'", String.Single), ('\\d+\\.\\d+', Number.Float), ('(\\d+)', Number.Integer), ('(true|false)', Name.Constant), ('\\s*QUERY PLAN\\s*\\n\\s*-+', Comment.Single), ('(Settings)(:)( )', bygroups(Comment.Preproc, Punctuation, Whitespace), 'setting'), ('(JIT|Functions|Options|Timing)(:)', bygroups(Comment.Preproc, Punctuation)), ('(Inlining|Optimization|Expressions|Deforming|Generation|Emission|Total)', Keyword.Pseudo), ('(Trigger)( )(\\S*)(:)( )', bygroups(Comment.Preproc, Whitespace, Name.Variable, Punctuation, Whitespace))], 'expression': [('\\(', Punctuation, '#push'), ('\\)', Punctuation, '#pop'), ('(never executed)', Name.Exception), ('[^)(]+', Comment)], 'object_name': [('(\\(cost)(=?)', bygroups(Name.Class, Punctuation), 'instrumentation'), ('(\\(actual)( )(=?)', bygroups(Name.Class, Whitespace, Punctuation), 'instrumentation'), ('\\(', Punctuation, 'expression'), ('(on)', Punctuation), ('\\w+(\\.\\w+)*( USING \\S+| \\w+ USING \\S+)', Name.Variable), ('\\"?\\w+\\"?(?:\\.\\"?\\w+\\"?)?', Name.Variable), ("\\'\\S*\\'", Name.Variable), (',\\n', Punctuation, 'object_name'), (',', Punctuation, 'object_name'), ('"\\*SELECT\\*( \\d+)?"(.\\w+)?', Name.Variable), ('"\\*VALUES\\*(_\\d+)?"(.\\w+)?', Name.Variable), ('"ANY_subquery"', Name.Variable), ('\\$\\d+', Name.Variable), ('::\\w+', Name.Variable), (' +', Whitespace), ('"', Punctuation), ('\\[\\.\\.\\.\\]', Punctuation), ('\\)', Punctuation, '#pop')], 'predicate': [('(\\()([^\\n]*)(\\))', bygroups(Punctuation, Name.Variable, Punctuation), '#pop'), ('[^\\n]*', Name.Variable, '#pop')], 'instrumentation': [('=|\\.\\.', Punctuation), (' +', Whitespace), ('(rows|width|time|loops)', Name.Class), ('\\d+\\.\\d+', Number.Float), ('(\\d+)', Number.Integer), ('\\)', Punctuation, '#pop')], 'conflict': [('(Resolution: )(\\w+)', bygroups(Comment.Preproc, Name.Variable)), ('(Arbiter \\w+:)', Comment.Preproc, 'object_name'), ('(Filter: )', Comment.Preproc, 'predicate')], 'setting': [("([a-z_]*?)(\\s*)(=)(\\s*)(\\'.*?\\')", bygroups(Name.Attribute, Whitespace, Operator, Whitespace, String)), ('\\, ', Punctuation)], 'init_plan': [('\\(', Punctuation), ('returns \\$\\d+(,\\$\\d+)?', Name.Variable), ('\\)', Punctuation, '#pop')], 'sort': [(':|kB', Punctuation), ('(quicksort|top-N|heapsort|Average|Memory|Peak)', Comment.Prepoc), ('(external|merge|Disk|sort)', Name.Exception), ('(\\d+)', Number.Integer), (' +', Whitespace)]}