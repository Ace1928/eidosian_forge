import json
import urllib
import numpy as np
import pytest
import cirq
from cirq import quirk_url_to_circuit, quirk_json_to_circuit
from cirq.interop.quirk.cells.testing import assert_url_to_circuit_returns
def test_example_qft_circuit():
    qft_example_diagram = '\n0: ───×───────────────H───@───────────@────────────────────@──────────────────────────────@─────────────────────────────────────────@───────────────────────────────────────────────────@─────────────────────────────────────────────────────────────@───────────────────────────────────────────────────────────────────────\n      │                   │           │                    │                              │                                         │                                                   │                                                             │\n1: ───┼───×───────────────@^0.5───H───┼────────@───────────┼─────────@────────────────────┼──────────@──────────────────────────────┼─────────@─────────────────────────────────────────┼─────────@───────────────────────────────────────────────────┼─────────@─────────────────────────────────────────────────────────────\n      │   │                           │        │           │         │                    │          │                              │         │                                         │         │                                                   │         │\n2: ───┼───┼───×───────────────────────@^0.25───@^0.5───H───┼─────────┼────────@───────────┼──────────┼─────────@────────────────────┼─────────┼──────────@──────────────────────────────┼─────────┼─────────@─────────────────────────────────────────┼─────────┼─────────@───────────────────────────────────────────────────\n      │   │   │                                            │         │        │           │          │         │                    │         │          │                              │         │         │                                         │         │         │\n3: ───┼───┼───┼───×────────────────────────────────────────@^(1/8)───@^0.25───@^0.5───H───┼──────────┼─────────┼────────@───────────┼─────────┼──────────┼─────────@────────────────────┼─────────┼─────────┼──────────@──────────────────────────────┼─────────┼─────────┼─────────@─────────────────────────────────────────\n      │   │   │   │                                                                       │          │         │        │           │         │          │         │                    │         │         │          │                              │         │         │         │\n4: ───┼───┼───┼───×───────────────────────────────────────────────────────────────────────@^(1/16)───@^(1/8)───@^0.25───@^0.5───H───┼─────────┼──────────┼─────────┼────────@───────────┼─────────┼─────────┼──────────┼─────────@────────────────────┼─────────┼─────────┼─────────┼──────────@──────────────────────────────\n      │   │   │                                                                                                                     │         │          │         │        │           │         │         │          │         │                    │         │         │         │          │\n5: ───┼───┼───×─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────@^0.031───@^(1/16)───@^(1/8)───@^0.25───@^0.5───H───┼─────────┼─────────┼──────────┼─────────┼────────@───────────┼─────────┼─────────┼─────────┼──────────┼─────────@────────────────────\n      │   │                                                                                                                                                                             │         │         │          │         │        │           │         │         │         │          │         │\n6: ───┼───×─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────@^0.016───@^0.031───@^(1/16)───@^(1/8)───@^0.25───@^0.5───H───┼─────────┼─────────┼─────────┼──────────┼─────────┼────────@───────────\n      │                                                                                                                                                                                                                                               │         │         │         │          │         │        │\n7: ───×───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────@^0.008───@^0.016───@^0.031───@^(1/16)───@^(1/8)───@^0.25───@^0.5───H───\n    '
    qft_example_json = '{"cols":[["Chance8"],["…","…","…","…","…","…","…","…"],["Swap",1,1,1,1,1,1,"Swap"],[1,"Swap",1,1,1,1,"Swap"],[1,1,"Swap",1,1,"Swap"],[1,1,1,"Swap","Swap"],["H"],["Z^½","•"],[1,"H"],["Z^¼","Z^½","•"],[1,1,"H"],["Z^⅛","Z^¼","Z^½","•"],[1,1,1,"H"],["Z^⅟₁₆","Z^⅛","Z^¼","Z^½","•"],[1,1,1,1,"H"],["Z^⅟₃₂","Z^⅟₁₆","Z^⅛","Z^¼","Z^½","•"],[1,1,1,1,1,"H"],["Z^⅟₆₄","Z^⅟₃₂","Z^⅟₁₆","Z^⅛","Z^¼","Z^½","•"],[1,1,1,1,1,1,"H"],["Z^⅟₁₂₈","Z^⅟₆₄","Z^⅟₃₂","Z^⅟₁₆","Z^⅛","Z^¼","Z^½","•"],[1,1,1,1,1,1,1,"H"]]}'
    qft_example_json_uri_escaped = '{%22cols%22:[[%22Chance8%22],[%22%E2%80%A6%22,%22%E2%80%A6%22,%22%E2%80%A6%22,%22%E2%80%A6%22,%22%E2%80%A6%22,%22%E2%80%A6%22,%22%E2%80%A6%22,%22%E2%80%A6%22],[%22Swap%22,1,1,1,1,1,1,%22Swap%22],[1,%22Swap%22,1,1,1,1,%22Swap%22],[1,1,%22Swap%22,1,1,%22Swap%22],[1,1,1,%22Swap%22,%22Swap%22],[%22H%22],[%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,%22H%22],[%22Z^%C2%BC%22,%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,1,%22H%22],[%22Z^%E2%85%9B%22,%22Z^%C2%BC%22,%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,1,1,%22H%22],[%22Z^%E2%85%9F%E2%82%81%E2%82%86%22,%22Z^%E2%85%9B%22,%22Z^%C2%BC%22,%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,1,1,1,%22H%22],[%22Z^%E2%85%9F%E2%82%83%E2%82%82%22,%22Z^%E2%85%9F%E2%82%81%E2%82%86%22,%22Z^%E2%85%9B%22,%22Z^%C2%BC%22,%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,1,1,1,1,%22H%22],[%22Z^%E2%85%9F%E2%82%86%E2%82%84%22,%22Z^%E2%85%9F%E2%82%83%E2%82%82%22,%22Z^%E2%85%9F%E2%82%81%E2%82%86%22,%22Z^%E2%85%9B%22,%22Z^%C2%BC%22,%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,1,1,1,1,1,%22H%22],[%22Z^%E2%85%9F%E2%82%81%E2%82%82%E2%82%88%22,%22Z^%E2%85%9F%E2%82%86%E2%82%84%22,%22Z^%E2%85%9F%E2%82%83%E2%82%82%22,%22Z^%E2%85%9F%E2%82%81%E2%82%86%22,%22Z^%E2%85%9B%22,%22Z^%C2%BC%22,%22Z^%C2%BD%22,%22%E2%80%A2%22],[1,1,1,1,1,1,1,%22H%22]]}'
    assert_url_to_circuit_returns(qft_example_json, diagram=qft_example_diagram)
    assert_url_to_circuit_returns(qft_example_json_uri_escaped, diagram=qft_example_diagram)