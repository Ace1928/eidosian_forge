import numpy as np
from ase.io import read
from numpy.linalg import norm
def write_output_socketio():
    output = '\n  MPI-parallelism will be employed.\n------------------------------------------------------------\n          Invoking FHI-aims ...\n\n          When using FHI-aims, please cite the following reference:\n\n          Volker Blum, Ralf Gehrke, Felix Hanke, Paula Havu,\n          Ville Havu, Xinguo Ren, Karsten Reuter, and Matthias Scheffler,\n          \'Ab Initio Molecular Simulations with Numeric Atom-Centered Orbitals\',\n          Computer Physics Communications 180, 2175-2196 (2009)\n\n          For any questions about FHI-aims, please visit the aimsclub website\n          with its forums and wiki. Contributions to both the forums and the\n          wiki are warmly encouraged - they are for you, and everyone is welcome there.\n\n------------------------------------------------------------\n\n\n\n  Date     :  20200311, Time     :  204314.253\n  Time zero on CPU 1             :   0.194170000000000E-01  s.\n  Internal wall clock time zero  :           353191394.253  s.\n\n  FHI-aims created a unique identifier for this run for later identification\n  aims_uuid : CF4170FC-8FB7-4BC2-A03C-9EC1F9140948\n\n  Build configuration of the current instance of FHI-aims\n  -------------------------------------------------------\n  FHI-aims version      : 190813\n  Commit number         : 6bedc122e\n  CMake host system     : Linux-4.15.0-58-generic\n  CMake version         : 3.5.1\n  Fortran compiler      : /home/knoop/local/openmpi-3.0.0/build/bin/mpifort (Intel) version 17.0.1.20161005\n  Fortran compiler flags: -O3 -ip -fp-model precise\n  C compiler            : /usr/bin/gcc (GNU) version 8.3.0\n  C compiler flags      :\n  Architecture          :\n  Using MPI\n  Using C files\n  Using LibXC\n  Using SPGlib\n  Using i-PI\n  Linking against: /home/knoop/local/anaconda3/pkgs/mkl-2019.4-243/lib/libmkl_intel_lp64.so\n                   /home/knoop/local/anaconda3/pkgs/mkl-2019.4-243/lib/libmkl_sequential.so\n                   /home/knoop/local/anaconda3/pkgs/mkl-2019.4-243/lib/libmkl_core.so\n\n  #===============================================================================\n  # FHI-aims file: ./control.in\n  # Created using the Atomic Simulation Environment (ASE)\n  # Wed Mar 11 20:43:14 2020\n  #===============================================================================\n  xc                                 pbesol\n  sc_accuracy_rho                    0.001\n  compute_analytical_stress          .true.\n  relativistic                       atomic_zora scalar\n  output_level                       MD_light\n  k_grid                             4 4 4\n  use_pimd_wrapper                   localhost 12345\n  #===============================================================================\n\n  ################################################################################\n  #\n  #  FHI-aims code project\n  #  VB, Fritz-Haber Institut, 2009\n  #\n  #  Suggested "light" defaults for Mg atom (to be pasted into control.in file)\n  #  Be sure to double-check any results obtained with these settings for post-processing,\n  #  e.g., with the "tight" defaults and larger basis sets.\n  #\n  ################################################################################\n    species        Mg\n  #     global species definitions\n      nucleus             12\n      mass                24.3050\n  #\n      l_hartree           4\n  #\n      cut_pot             4.0          1.5  1.0\n      basis_dep_cutoff    1e-4\n  #\n      radial_base         40 5.5\n      radial_multiplier   1\n      angular_grids       specified\n        division   0.7029   50\n        division   0.9689  110\n        division   1.1879  194\n        division   1.3129  302\n  #      division   1.4867  434\n  #      division   1.6018  590\n  #      division   1.8611  770\n  #      division   1.9576  974\n  #      division   2.2261 1202\n  #      outer_grid   974\n        outer_grid   302\n  ################################################################################\n  #\n  #  Definition of "minimal" basis\n  #\n  ################################################################################\n  #     valence basis states\n      valence      3  s   2.\n      valence      2  p   6.\n  #     ion occupancy\n      ion_occ      2  s   2.\n      ion_occ      2  p   6.\n  ################################################################################\n  #\n  #  Suggested additional basis functions. For production calculations,\n  #  uncomment them one after another (the most important basis functions are\n  #  listed first).\n  #\n  #  Constructed for dimers: 2.125 A, 2.375 A, 2.875 A, 3.375 A, 4.5 A\n  #\n  ################################################################################\n  #  "First tier" - improvements: -230.76 meV to -21.94 meV\n       hydro 2 p 1.5\n       ionic 3 d auto\n       hydro 3 s 2.4\n  #  "Second tier" - improvements: -5.43 meV to -1.64 meV\n  #     hydro 4 f 4.3\n  #     hydro 2 p 3.4\n  #     hydro 4 s 11.2\n  #     hydro 3 d 6.2\n  #  "Third tier" - improvements: -0.92 meV to -0.22 meV\n  #     hydro 2 s 0.6\n  #     hydro 3 p 4.8\n  #     hydro 4 f 7.4\n  #     hydro 5 g 6.6\n  #     hydro 2 p 1.6\n  #     hydro 3 d 1.8\n  #  "Fourth tier" - improvements: -0.09 meV to -0.05 meV\n  #     hydro 4 p 0.45\n  #     hydro 5 g 10.4\n  #     hydro 2 s 12.4\n  #     hydro 4 d 1.7\n  ################################################################################\n  #\n  #  FHI-aims code project\n  #  VB, Fritz-Haber Institut, 2009\n  #\n  #  Suggested "light" defaults for O atom (to be pasted into control.in file)\n  #  Be sure to double-check any results obtained with these settings for post-processing,\n  #  e.g., with the "tight" defaults and larger basis sets.\n  #\n  ################################################################################\n    species        O\n  #     global species definitions\n      nucleus             8\n      mass                15.9994\n  #\n      l_hartree           4\n  #\n      cut_pot             3.5  1.5  1.0\n      basis_dep_cutoff    1e-4\n  #\n      radial_base         36 5.0\n      radial_multiplier   1\n       angular_grids specified\n        division   0.2659   50\n        division   0.4451  110\n        division   0.6052  194\n        division   0.7543  302\n  #      division   0.8014  434\n  #      division   0.8507  590\n  #      division   0.8762  770\n  #      division   0.9023  974\n  #      division   1.2339 1202\n  #      outer_grid 974\n        outer_grid 302\n  ################################################################################\n  #\n  #  Definition of "minimal" basis\n  #\n  ################################################################################\n  #     valence basis states\n      valence      2  s   2.\n      valence      2  p   4.\n  #     ion occupancy\n      ion_occ      2  s   1.\n      ion_occ      2  p   3.\n  ################################################################################\n  #\n  #  Suggested additional basis functions. For production calculations,\n  #  uncomment them one after another (the most important basis functions are\n  #  listed first).\n  #\n  #  Constructed for dimers: 1.0 A, 1.208 A, 1.5 A, 2.0 A, 3.0 A\n  #\n  ################################################################################\n  #  "First tier" - improvements: -699.05 meV to -159.38 meV\n       hydro 2 p 1.8\n       hydro 3 d 7.6\n       hydro 3 s 6.4\n  #  "Second tier" - improvements: -49.91 meV to -5.39 meV\n  #     hydro 4 f 11.6\n  #     hydro 3 p 6.2\n  #     hydro 3 d 5.6\n  #     hydro 5 g 17.6\n  #     hydro 1 s 0.75\n  #  "Third tier" - improvements: -2.83 meV to -0.50 meV\n  #     ionic 2 p auto\n  #     hydro 4 f 10.8\n  #     hydro 4 d 4.7\n  #     hydro 2 s 6.8\n  #  "Fourth tier" - improvements: -0.40 meV to -0.12 meV\n  #     hydro 3 p 5\n  #     hydro 3 s 3.3\n  #     hydro 5 g 15.6\n  #     hydro 4 f 17.6\n  #     hydro 4 d 14\n  # Further basis functions - -0.08 meV and below\n  #     hydro 3 s 2.1\n  #     hydro 4 d 11.6\n  #     hydro 3 p 16\n  #     hydro 2 s 17.2\n\n  -----------------------------------------------------------------------\n  Completed first pass over input file control.in .\n  -----------------------------------------------------------------------\n\n\n  -----------------------------------------------------------------------\n  Parsing geometry.in (first pass over file, find array dimensions only).\n  The contents of geometry.in will be repeated verbatim below\n  unless switched off by setting \'verbatim_writeout .false.\' .\n  in the first line of geometry.in .\n  -----------------------------------------------------------------------\n\n  #=======================================================\n  # FHI-aims file: ./geometry.in\n  # Created using the Atomic Simulation Environment (ASE)\n  # Wed Mar 11 20:43:14 2020\n  #=======================================================\n  lattice_vector 0.0000000000000000 2.1131357400000002 2.1131357400000002\n  lattice_vector 2.1131357400000002 0.0000000000000000 2.1131357400000002\n  lattice_vector 2.1131357400000002 2.1131357400000002 0.0000000000000000\n  atom_frac 0.0000000000000000 0.0000000000000000 -0.0000000000000000 Mg\n  atom_frac 0.5200000000000000 0.5000000000000000 0.5000000000000000 O\n\n  -----------------------------------------------------------------------\n  Completed first pass over input file geometry.in .\n  -----------------------------------------------------------------------\n\n\n  Basic array size parameters:\n  | Number of species                 :        2\n  | Number of atoms                   :        2\n  | Number of lattice vectors         :        3\n  | Max. basis fn. angular momentum   :        2\n  | Max. atomic/ionic basis occupied n:        3\n  | Max. number of basis fn. types    :        3\n  | Max. radial fns per species/type  :        4\n  | Max. logarithmic grid size        :     1334\n  | Max. radial integration grid size :       40\n  | Max. angular integration grid size:      302\n  | Max. angular grid division number :        8\n  | Radial grid for Hartree potential :     1334\n  | Number of spin channels           :        1\n\n------------------------------------------------------------\n          Reading file control.in.\n------------------------------------------------------------\n  XC: Using PBEsol gradient-corrected functionals.\n  Convergence accuracy of self-consistent charge density:  0.1000E-02\n  Scalar relativistic treatment of kinetic energy: on-site free-atom approximation to ZORA.\n  Requested output level: MD_light\n  Found k-point grid:         4         4         4\n  Using external wrapper (i-PI) for performing (path integral) molecular dynamics\n  **Attention: initial geometry.in file will be ignored!\n\n  Reading configuration options for species Mg                  .\n  | Found nuclear charge :  12.0000\n  | Found atomic mass :    24.3050000000000      amu\n  | Found l_max for Hartree potential  :   4\n  | Found cutoff potl. onset [A], width [A], scale factor :    4.00000    1.50000    1.00000\n  | Threshold for basis-dependent cutoff potential is   0.100000E-03\n  | Found data for basic radial integration grid :    40 points, outermost radius =    5.500 A\n  | Found multiplier for basic radial grid :   1\n  | Found angular grid specification: user-specified.\n  | Specified grid contains     5 separate shells.\n  | Check grid settings after all constraints further below.\n  | Found free-atom valence shell :  3 s   2.000\n  | Found free-atom valence shell :  2 p   6.000\n  | Found free-ion valence shell :  2 s   2.000\n  | Found free-ion valence shell :  2 p   6.000\n  | Found hydrogenic basis function :  2 p   1.500\n  | Found ionic basis function :  3 d , default cutoff radius.\n  | Found hydrogenic basis function :  3 s   2.400\n  Species Mg                  : Missing cutoff potential type.\n  Defaulting to exp(1/x)/(1-x)^2 type cutoff potential.\n  Species Mg: No \'logarithmic\' tag. Using default grid for free atom:\n  | Default logarithmic grid data [bohr] : 0.1000E-03 0.1000E+03 0.1012E+01\n  | Will include ionic basis functions of  2.0-fold positive Mg                   ion.\n  Species Mg: On-site basis accuracy parameter (for Gram-Schmidt orthonormalisation) not specified.\n  Using default value basis_acc =  0.1000000E-03.\n  Species Mg                  : Using default innermost maximum threshold i_radial=  2 for radial functions.\n  Species Mg                  : Default cutoff onset for free atom density etc. : 0.40000000E+01 AA.\n  Species Mg                  : Basic radial grid will be enhanced according to radial_multiplier =   1, to contain    40 grid points.\n\n  Reading configuration options for species O                   .\n  | Found nuclear charge :   8.0000\n  | Found atomic mass :    15.9994000000000      amu\n  | Found l_max for Hartree potential  :   4\n  | Found cutoff potl. onset [A], width [A], scale factor :    3.50000    1.50000    1.00000\n  | Threshold for basis-dependent cutoff potential is   0.100000E-03\n  | Found data for basic radial integration grid :    36 points, outermost radius =    5.000 A\n  | Found multiplier for basic radial grid :   1\n  | Found angular grid specification: user-specified.\n  | Specified grid contains     5 separate shells.\n  | Check grid settings after all constraints further below.\n  | Found free-atom valence shell :  2 s   2.000\n  | Found free-atom valence shell :  2 p   4.000\n  | Found free-ion valence shell :  2 s   1.000\n  | Found free-ion valence shell :  2 p   3.000\n  | Found hydrogenic basis function :  2 p   1.800\n  | Found hydrogenic basis function :  3 d   7.600\n  | Found hydrogenic basis function :  3 s   6.400\n  Species O                   : Missing cutoff potential type.\n  Defaulting to exp(1/x)/(1-x)^2 type cutoff potential.\n  Species O : No \'logarithmic\' tag. Using default grid for free atom:\n  | Default logarithmic grid data [bohr] : 0.1000E-03 0.1000E+03 0.1012E+01\n  Species O : On-site basis accuracy parameter (for Gram-Schmidt orthonormalisation) not specified.\n  Using default value basis_acc =  0.1000000E-03.\n  Species O                   : Using default innermost maximum threshold i_radial=  2 for radial functions.\n  Species O                   : Default cutoff onset for free atom density etc. : 0.35000000E+01 AA.\n  Species O                   : Basic radial grid will be enhanced according to radial_multiplier =   1, to contain    36 grid points.\n\n  Finished reading input file \'control.in\'. Consistency checks are next.\n\n  MPI_IN_PLACE appears to work with this MPI implementation.\n  | Keeping use_mpi_in_place .true. (see manual).\n  Target number of points in a grid batch is not set. Defaulting to  100\n  Method for grid partitioning is not set. Defaulting to parallel hash+maxmin partitioning.\n  Batch size limit is not set. Defaulting to    200\n  By default, will store active basis functions for each batch.\n  If in need of memory, prune_basis_once .false. can be used to disable this option.\n  communication_type for Hartree potential was not specified.\n  Defaulting to calc_hartree .\n  Defaulting to Pulay charge density mixer.\n  Pulay mixer: Number of relevant iterations not set.\n  Defaulting to    8 iterations.\n  Pulay mixer: Number of initial linear mixing iterations not set.\n  Defaulting to    0 iterations.\n  Work space size for distributed Hartree potential not set.\n  Defaulting to   0.200000E+03 MB.\n  Mixing parameter for charge density mixing has not been set.\n  Using default: charge_mix_param =     0.0500.\n  The mixing parameter will be adjusted in iteration number     2 of the first full s.c.f. cycle only.\n  Algorithm-dependent basis array size parameters:\n  | n_max_pulay                         :        8\n  Maximum number of self-consistency iterations not provided.\n  Presetting  1000 iterations.\n  Presetting      1001 iterations before the initial mixing cycle\n  is restarted anyway using the sc_init_iter criterion / keyword.\n  Presetting a factor      1.000 between actual scf density residual\n  and density convergence criterion sc_accuracy_rho below which sc_init_iter\n  takes no effect.\n  Calculation of forces was not defined in control.in. No forces will be calculated.\n  Geometry relaxation not requested: no relaxation will be performed.\n  Analytical stress will be computed.\n  Analytical stress calculation: Only the upper triangle is calculated.\n                                 Final output is symmetrized.\n  Analytical stress calculation: scf convergence accuracy of stress not set.\n                                 Analytical stress self-consistency will not be checked explicitly.\n                                 Be sure to set other criteria like sc_accuracy_rho tight enough.\n  Force calculation: scf convergence accuracy of forces not set.\n  Defaulting to \'sc_accuracy_forces not_checked\'.\n  Handling of forces: Unphysical translation and rotation will be removed from forces.\n  No accuracy limit for integral partition fn. given. Defaulting to  0.1000E-14.\n  No threshold value for u(r) in integrations given. Defaulting to  0.1000E-05.\n  No occupation type (smearing scheme) given. Defaulting to Gaussian broadening, width =  0.1000E-01 eV.\n  The width will be adjusted in iteration number     2 of the first full s.c.f. cycle only.\n  S.C.F. convergence parameters will be adjusted in iteration number     2 of the first full s.c.f. cycle only.\n  No accuracy for occupation numbers given. Defaulting to  0.1000E-12.\n  No threshold value for occupation numbers given. Defaulting to  0.0000E+00.\n  No accuracy for fermi level given. Defaulting to  0.1000E-19.\n  Maximum # of iterations to find E_F not set. Defaulting to  200.\n  Preferred method for the eigenvalue solver (\'KS_method\') not specified in \'control.in\'.\n  Defaulting to serial version, LAPACK (via ELSI), since more k-points than CPUs available.\n  Will not use alltoall communication since running on < 1024 CPUs.\n  Threshold for basis singularities not set.\n  Default threshold for basis singularities:  0.1000E-04\n  partition_type (choice of integration weights) for integrals was not specified.\n  | Using a version of the partition function of Stratmann and coworkers (\'stratmann_sparse\').\n  | At each grid point, the set of atoms used to build the partition table is smoothly restricted to\n  | only those atoms whose free-atom density would be non-zero at that grid point.\n  Partitioning for Hartree potential was not defined. Using partition_type for integrals.\n  | Adjusted default value of keyword multip_moments_threshold to:       0.10000000E-11\n  | This value may affect high angular momentum components of the Hartree potential in periodic systems.\n  Spin handling was not defined in control.in. Defaulting to unpolarized case.\n  Angular momentum expansion for Kerker preconditioner not set explicitly.\n  | Using default value of   0\n  No explicit requirement for turning off preconditioner.\n  | By default, it will be turned off when the charge convergence reaches\n  | sc_accuracy_rho  =   0.100000E-02\n  No special mixing parameter while Kerker preconditioner is on.\n  Using default: charge_mix_param =     0.0500.\n  No q(lm)/r^(l+1) cutoff set for long-range Hartree potential.\n  | Using default value of  0.100000E-09 .\n  | Verify using the multipole_threshold keyword.\n  Defaulting to new monopole extrapolation.\n  Density update method: automatic selection selected.\n  Using density matrix based charge density update.\n  Using density matrix based charge density update.\n  Using packed matrix style: index .\n  Defaulting to use time-reversal symmetry for k-point grid.\n------------------------------------------------------------\n\n\n------------------------------------------------------------\n          Reading geometry description geometry.in.\n------------------------------------------------------------\n  Input structure read successfully.\n  The structure contains        2 atoms,  and a total of         20.000 electrons.\n\n  Input geometry:\n  | Unit cell:\n  |        0.00000000        2.11313574        2.11313574\n  |        2.11313574        0.00000000        2.11313574\n  |        2.11313574        2.11313574        0.00000000\n  | Atomic structure:\n  |       Atom                x [A]            y [A]            z [A]\n  |    1: Species Mg            0.00000000        0.00000000        0.00000000\n  |    2: Species O             2.11313574        2.15539845        2.15539845\n\n  Lattice parameters for 3D lattice (in Angstroms) :     2.988425    2.988425    2.988425\n  Angle(s) between unit vectors (in degrees)       :    60.000000   60.000000   60.000000\n\n  | The smallest distance between any two atoms is         2.07130423 AA.\n  | The first atom of this pair is atom number                      2 .\n  | The second atom of this pair is atom number                     1 .\n  | Wigner-Seitz cell of the first atom image           0     1     0 .\n  | (The Wigner-Seitz cell of the second atom is 0 0 0  by definition.)\n\n  Symmetry information by spglib:\n  | Precision set to  0.1E-04\n  | Number of Operations  : 4\n  | Space group           : 44\n  | International         : Imm2\n  | Schoenflies           : C2v^20\n\n  Quantities derived from the lattice vectors:\n  | Reciprocal lattice vector 1: -1.486697  1.486697  1.486697\n  | Reciprocal lattice vector 2:  1.486697 -1.486697  1.486697\n  | Reciprocal lattice vector 3:  1.486697  1.486697 -1.486697\n  | Unit cell volume                               :   0.188718E+02  A^3\n\n  Range separation radius for Ewald summation (hartree_convergence_parameter):      2.90574234 bohr.\n\n  Number of empty states per atom not set in control.in - providing a guess from actual geometry.\n  | Total number of empty states used during s.c.f. cycle:        6\n  If you use a very high smearing, use empty_states (per atom!) in control.in to increase this value.\n\n  Structure-dependent array size parameters:\n  | Maximum number of distinct radial functions  :       13\n  | Maximum number of basis functions            :       29\n  | Number of Kohn-Sham states (occupied + empty):       16\n------------------------------------------------------------\n\n************************** W A R N I N G *******************************\n* You are using the PIMD wrapper. Specifications and positions         *\n* in geometry.in will be IGNORED - all is received from the wrapper.   *\n* Please make sure species are declared in the same order in           *\n* geometry.in and wrapper input.                                       *\n************************************************************************\n\n\n------------------------------------------------------------\n          Preparing all fixed parts of the calculation.\n------------------------------------------------------------\n  Determining machine precision:\n    2.225073858507201E-308\n  Setting up grids for atomic and cluster calculations.\n\n  Creating wave function, potential, and density for free atoms.\n\n  Species: Mg\n\n  List of occupied orbitals and eigenvalues:\n    n    l              occ      energy [Ha]    energy [eV]\n    1    0           2.0000       -46.359170     -1261.4972\n    2    0           2.0000        -2.927498       -79.6613\n    3    0           2.0000        -0.167982        -4.5710\n    2    1           6.0000        -1.706030       -46.4234\n\n\n  Species: O\n\n  List of occupied orbitals and eigenvalues:\n    n    l              occ      energy [Ha]    energy [eV]\n    1    0           2.0000       -18.926989      -515.0296\n    2    0           2.0000        -0.880247       -23.9527\n    2    1           4.0000        -0.331514        -9.0210\n\n  Creating fixed part of basis set: Ionic, confined, hydrogenic.\n\n  Mg                   ion:\n\n  List of free ionic orbitals and eigenvalues:\n    n    l      energy [Ha]    energy [eV]\n    1    0       -47.122987     -1282.2817\n    2    0        -3.674099       -99.9773\n    2    1        -2.451441       -66.7071\n\n\n  List of ionic basis orbitals and eigenvalues:\n    n    l      energy [Ha]    energy [eV]    outer radius [A]\n    3    2        -0.253797        -6.9062       5.100062\n\n\n  Mg                   hydrogenic:\n\n  List of hydrogenic basis orbitals:\n    n    l      effective z      eigenvalue [eV]  inner max. [A]     outer max. [A]     outer radius [A]\n    2    1         1.500000        -7.5955           1.395712           1.395712           5.100062\n    3    0         2.400000        -8.0111           0.162319           2.734035           5.100062\n\n\n  O                    hydrogenic:\n\n  List of hydrogenic basis orbitals:\n    n    l      effective z      eigenvalue [eV]  inner max. [A]     outer max. [A]     outer radius [A]\n    2    1         1.800000       -10.9749           1.164242           1.164242           4.578029\n    3    2         7.600000       -87.3180           0.624125           0.624125           3.251020\n    3    0         6.400000       -61.9207           0.061167           1.081902           4.001998\n\n\n  Adding cutoff potential to free-atom effective potential.\n  Creating atomic-like basis functions for current effective potential.\n\n  Species Mg                  :\n\n  List of atomic basis orbitals and eigenvalues:\n    n    l      energy [Ha]    energy [eV]    outer radius [A]\n    1    0       -46.359170     -1261.4972       0.921046\n    2    0        -2.927498       -79.6613       3.621735\n    3    0        -0.167982        -4.5710       5.100062\n    2    1        -1.706030       -46.4234       4.404175\n\n\n  Species O                   :\n\n  List of atomic basis orbitals and eigenvalues:\n    n    l      energy [Ha]    energy [eV]    outer radius [A]\n    1    0       -18.926989      -515.0296       1.415765\n    2    0        -0.880247       -23.9527       4.413171\n    2    1        -0.331514        -9.0210       4.522403\n\n  Assembling full basis from fixed parts.\n  | Species Mg :   atomic orbital   1 s accepted.\n  | Species Mg :   atomic orbital   2 s accepted.\n  | Species Mg :   atomic orbital   3 s accepted.\n  | Species Mg :    hydro orbital   3 s accepted.\n  | Species Mg :   atomic orbital   2 p accepted.\n  | Species Mg :    hydro orbital   2 p accepted.\n  | Species Mg :    ionic orbital   3 d accepted.\n  | Species O :   atomic orbital   1 s accepted.\n  | Species O :    hydro orbital   3 s accepted.\n  | Species O :   atomic orbital   2 s accepted.\n  | Species O :   atomic orbital   2 p accepted.\n  | Species O :    hydro orbital   2 p accepted.\n  | Species O :    hydro orbital   3 d accepted.\n\n  Basis size parameters after reduction:\n  | Total number of radial functions:       13\n  | Total number of basis functions :       29\n\n  Per-task memory consumption for arrays in subroutine allocate_ext:\n  |           4.441052MB.\n  Testing on-site integration grid accuracy.\n  |  Species  Function  <phi|h_atom|phi> (log., in eV)  <phi|h_atom|phi> (rad., in eV)\n           1        1              -1261.4972086064              -1261.4966102663\n           1        2                -79.6612686792                -79.6612661850\n           1        3                 -4.5766449847                 -4.5764463354\n           1        4                  4.2856803862                  4.2813226631\n           1        5                -46.4234362291                -46.4234361907\n           1        6                 -0.5282558506                 -0.5281575826\n           1        7                  4.0144889854                  4.0133736295\n           2        8               -515.0295626295               -515.0294562738\n           2        9                 15.1698434419                 15.1699322204\n           2       10                -21.6038822678                -21.6039118105\n           2       11                 -9.0211123393                 -9.0212703513\n           2       12                  8.3047696391                  8.2854840999\n           2       13                 45.8428042125                 45.8427461222\n\n  Preparing densities etc. for the partition functions (integrals / Hartree potential).\n\n  Preparations completed.\n  max(cpu_time)          :      0.155 s.\n  Wall clock time (cpu1) :      0.155 s.\n------------------------------------------------------------\n\n************************** W A R N I N G *******************************\n* Skipping the SCF initialization for now - done inside wrapper      *\n************************************************************************\n\n  @ DRIVER MODE: Connecting to host:port localhost       12345\n  @ DRIVER MODE: Message from server: STATUS\n  @ DRIVER MODE: Message from server: POSDATA\n  @ DRIVER MODE: Received positions\n\n------------------------------------------------------------\n          Begin self-consistency loop: Initialization.\n\n          Date     :  20200311, Time     :  204314.465\n------------------------------------------------------------\n\n  Initializing index lists of integration centers etc. from given atomic structure:\n  Mapping all atomic coordinates to central unit cell.\n\n  Initializing the k-points\n          Using symmetry for reducing the k-points\n  | k-points reduced from:       64 to       36\n  | Number of k-points                             :        36\n  The eigenvectors in the calculations are COMPLEX.\n  | K-points in task   0:         9\n  | K-points in task   1:         9\n  | K-points in task   2:         9\n  | K-points in task   3:         9\n  | Number of basis functions in the Hamiltonian integrals :      1946\n  | Number of basis functions in a single unit cell        :        29\n  | Number of centers in hartree potential         :      1017\n  | Number of centers in hartree multipole         :       776\n  | Number of centers in electron density summation:       530\n  | Number of centers in basis integrals           :       582\n  | Number of centers in integrals                 :       189\n  | Number of centers in hamiltonian               :       580\n  | Consuming        186 KiB for k_phase.\n  | Number of super-cells (origin) [n_cells]                     :        2197\n  | Number of super-cells (after PM_index) [n_cells]             :         332\n  | Number of super-cells in hamiltonian [n_cells_in_hamiltonian]:         332\n  | Size of matrix packed + index [n_hamiltonian_matrix_size] :       70918\n  | Estimated reciprocal-space cutoff momentum G_max:         3.25739508 bohr^-1 .\n  | Reciprocal lattice points for long-range Hartree potential:      64\n  Partitioning the integration grid into batches with parallel hashing+maxmin method.\n  | Number of batches:      191\n  | Maximal batch size:     112\n  | Minimal batch size:      54\n  | Average batch size:      62.492\n  | Standard deviation of batch sizes:       5.898\n\n  Integration load balanced across     4 MPI tasks.\n  Work distribution over tasks is as follows:\n  Task     0 has       3012 integration points.\n  Task     1 has       2986 integration points.\n  Task     2 has       2985 integration points.\n  Task     3 has       2953 integration points.\n  Initializing partition tables, free-atom densities, potentials, etc. across the integration grid (initialize_grid_storage).\n  | initialize_grid_storage: Actual outermost partition radius vs. multipole_radius_free\n  | (-- VB: in principle, multipole_radius_free should be larger, hence this output)\n  | Species        1: Confinement radius =              5.500000000000000 AA, multipole_radius_free =              5.555717568450569 AA.\n  | Species        1: outer_partition_radius set to              5.555717568450569 AA .\n  | Species        2: Confinement radius =              4.999999999999999 AA, multipole_radius_free =              5.048384829883283 AA.\n  | Species        2: outer_partition_radius set to              5.048384829883283 AA .\n  | The sparse table of interatomic distances needs       1970.16 kbyte instead of      2709.79 kbyte of memory.\n  | Net number of integration points:    11936\n  | of which are non-zero points    :     9118\n  | Numerical average free-atom electrostatic potential    :    -17.34765164 eV\n  Renormalizing the initial density to the exact electron count on the 3D integration grid.\n  | Initial density: Formal number of electrons (from input files) :      20.0000000000\n  | Integrated number of electrons on 3D grid     :      20.0026739480\n  | Charge integration error                      :       0.0026739480\n  | Normalization factor for density and gradient :       0.9998663205\n  Obtaining max. number of non-zero basis functions in each batch (get_n_compute_maxes).\n  | Maximal number of non-zero basis functions:      807 in task     0\n  | Maximal number of non-zero basis functions:      785 in task     1\n  | Maximal number of non-zero basis functions:      825 in task     2\n  | Maximal number of non-zero basis functions:      821 in task     3\n  Allocating        0.064 MB for KS_eigenvector_complex\n  Integrating Hamiltonian matrix: batch-based integration.\n  Time summed over all CPUs for integration: real work        1.226 s, elapsed        1.244 s\n  Integrating overlap matrix.\n  Time summed over all CPUs for integration: real work        0.906 s, elapsed        0.920 s\n  Decreasing sparse matrix size:\n   Tolerance:  9.999999824516700E-014\n   Hamiltonian matrix\n  | Array has    57094 nonzero elements out of    70918 elements\n  | Sparsity factor is 0.195\n   Overlap matrix\n  | Array has    53782 nonzero elements out of    70918 elements\n  | Sparsity factor is 0.242\n  New size of hamiltonian matrix:       57179\n\n  Updating Kohn-Sham eigenvalues and eigenvectors using ELSI and the (modified) LAPACK eigensolver.\n  Singularity check in k-point 4, task 0 (analysis for other k-points/tasks may follow below):\n\n  Obtaining occupation numbers and chemical potential using ELSI.\n  | Chemical potential (Fermi level):    -9.39880369 eV\n  Writing Kohn-Sham eigenvalues.\n  K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  State    Occupation    Eigenvalue [Ha]    Eigenvalue [eV]\n      1       2.00000         -46.246119        -1258.42094\n      2       2.00000         -18.949515         -515.64253\n      3       2.00000          -2.939241          -79.98081\n      4       2.00000          -1.724501          -46.92607\n      5       2.00000          -1.724472          -46.92526\n      6       2.00000          -1.724438          -46.92436\n      7       2.00000          -1.074630          -29.24216\n      8       2.00000          -0.457085          -12.43791\n      9       2.00000          -0.456823          -12.43079\n     10       2.00000          -0.456820          -12.43071\n     11       0.00000          -0.221801           -6.03551\n     12       0.00000           0.221833            6.03638\n     13       0.00000           0.222549            6.05588\n     14       0.00000           0.222984            6.06771\n     15       0.00000           0.425167           11.56937\n     16       0.00000           0.425678           11.58330\n\n  What follows are estimated values for band gap, HOMO, LUMO, etc.\n  | They are estimated on a discrete k-point grid and not necessarily exact.\n  | For converged numbers, create a DOS and/or band structure plot on a denser k-grid.\n\n  Highest occupied state (VBM) at    -12.43071357 eV (relative to internal zero)\n  | Occupation number:      2.00000000\n  | K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  Lowest unoccupied state (CBM) at    -6.03551047 eV (relative to internal zero)\n  | Occupation number:      0.00000000\n  | K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  ESTIMATED overall HOMO-LUMO gap:      6.39520310 eV between HOMO at k-point 1 and LUMO at k-point 1\n  | This appears to be a direct band gap.\n  The gap value is above 0.2 eV. Unless you are using a very sparse k-point grid,\n  this system is most likely an insulator or a semiconductor.\n  Calculating total energy contributions from superposition of free atom densities.\n\n  Total energy components:\n  | Sum of eigenvalues            :        -151.77161455 Ha       -4129.91575979 eV\n  | XC energy correction          :         -24.34440425 Ha        -662.44494434 eV\n  | XC potential correction       :          31.70940006 Ha         862.85667742 eV\n  | Free-atom electrostatic energy:        -130.88597416 Ha       -3561.58856859 eV\n  | Hartree energy correction     :           0.00000000 Ha           0.00000000 eV\n  | Entropy correction            :           0.00000000 Ha           0.00000000 eV\n  | ---------------------------\n  | Total energy                  :        -275.29259290 Ha       -7491.09259530 eV\n  | Total energy, T -> 0          :        -275.29259290 Ha       -7491.09259530 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy        :        -275.29259290 Ha       -7491.09259530 eV\n\n  Derived energy quantities:\n  | Kinetic energy                :         276.03701172 Ha        7511.34926225 eV\n  | Electrostatic energy          :        -526.98520038 Ha      -14339.99691322 eV\n  | Energy correction for multipole\n  | error in Hartree potential    :           0.00000000 Ha           0.00000000 eV\n  | Sum of eigenvalues per atom                           :       -2064.95787990 eV\n  | Total energy (T->0) per atom                          :       -3745.54629765 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy per atom                       :       -3745.54629765 eV\n  Initialize hartree_potential_storage\n  Max. number of atoms included in rho_multipole:            2\n\n  End scf initialization - timings             :  max(cpu_time)    wall_clock(cpu1)\n  | Time for scf. initialization               :        0.904 s           0.904 s\n  | Boundary condition initialization          :        0.062 s           0.061 s\n  | Integration                                :        0.544 s           0.544 s\n  | Solution of K.-S. eqns.                    :        0.007 s           0.007 s\n  | Grid partitioning                          :        0.016 s           0.016 s\n  | Preloading free-atom quantities on grid    :        0.002 s           0.002 s\n  | Free-atom superposition energy             :        0.023 s           0.023 s\n  | Total energy evaluation                    :        0.000 s           0.000 s\n\n  Partial memory accounting:\n  | Current value for overall tracked memory usage:\n  |   Minimum:        1.155 MB (on task 0)\n  |   Maximum:        1.155 MB (on task 0)\n  |   Average:        1.155 MB\n  | Peak value for overall tracked memory usage:\n  |   Minimum:        8.148 MB (on task 1 after allocating wave)\n  |   Maximum:        8.743 MB (on task 2 after allocating wave)\n  |   Average:        8.512 MB\n  | Largest tracked array allocation so far:\n  |   Minimum:        4.701 MB (hamiltonian_shell on task 1)\n  |   Maximum:        5.193 MB (hamiltonian_shell on task 2)\n  |   Average:        5.001 MB\n  Note:  These values currently only include a subset of arrays which are explicitly tracked.\n  The "true" memory usage will be greater.\n------------------------------------------------------------\nConvergence:    q app. |  density  | eigen (eV) | Etot (eV) | forces (eV/A) |       CPU time |     Clock time\n  SCF    1 :  0.28E-02 |  0.27E+00 |   0.14E+01 |  0.25E+00 |             . |        1.078 s |        1.078 s\n  SCF    2 :  0.42E-02 |  0.24E+00 |   0.14E+02 |  0.11E+01 |             . |        1.076 s |        1.076 s\n  SCF    3 :  0.42E-02 |  0.81E-01 |  -0.54E+01 | -0.20E-01 |             . |        1.068 s |        1.068 s\n  SCF    4 :  0.45E-02 |  0.66E-01 |  -0.33E+01 |  0.72E-01 |             . |        1.062 s |        1.063 s\n  SCF    5 :  0.35E-02 |  0.32E-01 |   0.37E+01 |  0.15E-01 |             . |        1.069 s |        1.069 s\n  SCF    6 :  0.34E-02 |  0.56E-02 |   0.32E-01 |  0.38E-03 |             . |        1.072 s |        1.072 s\n  SCF    7 :  0.28E-02 |  0.26E-02 |   0.86E-01 | -0.15E-05 |             . |        1.077 s |        1.077 s\n  SCF    8 :  0.27E-02 |  0.49E-03 |  -0.15E-01 |  0.48E-05 |             . |        1.133 s |        1.134 s\n  SCF    9 :  0.27E-02 |  0.63E-03 |   0.33E-01 | -0.18E-04 |      0.11E+01 |        1.454 s |        1.453 s\n  SCF   10 :  0.27E-02\n  Analytical stress tensor components [eV]         xx                  yy                  zz                  xy                  xz                  yz\n  -----------------------------------------------------------------------------------------------------------------------------------------------------------\n    Nuclear Hellmann-Feynman      :    -0.3870932949E+02   -0.3875207926E+02   -0.3875207926E+02    0.4430429868E-10    0.4427216952E-10    0.2146800652E-01\n    Multipole Hellmann-Feynman    :    -0.5289450565E+02   -0.5304899474E+02   -0.5304899474E+02    0.2987199479E-10    0.3011368558E-10    0.8812370048E-01\n    On-site Multipole corrections :    -0.1380739258E+00   -0.1382119934E+00   -0.1382119933E+00   -0.1672464662E-10   -0.4833712897E-12    0.2520670526E-03\n    Strain deriv. of the orbitals :     0.9174321372E+02    0.9186596802E+02    0.9186596802E+02    0.2265077863E-09    0.5002460457E-09   -0.9978486771E-01\n  -----------------------------------------------------------------------------------------------------------------------------------------------------------\n  Sum of all contributions        :     0.1304653355E-02   -0.7331797879E-01   -0.7331797897E-01    0.2839594332E-09    0.5741485295E-09    0.1005890634E-01\n\n  +-------------------------------------------------------------------+\n  |              Analytical stress tensor - Symmetrized               |\n  |                  Cartesian components [eV/A**3]                   |\n  +-------------------------------------------------------------------+\n  |                x                y                z                |\n  |                                                                   |\n  |  x         0.00006913       0.00000000       0.00000000           |\n  |  y         0.00000000      -0.00388507       0.00053301           |\n  |  z         0.00000000       0.00053301      -0.00388507           |\n  |                                                                   |\n  |  Pressure:       0.00256700   [eV/A**3]                           |\n  |                                                                   |\n  +-------------------------------------------------------------------+\n\n * Warning: Stress tensor is anisotropic. Be aware that pressure is an isotropic quantity.\n\n |  0.12E-03 |   0.32E-01 | -0.12E-04 |      0.12E-02 |       14.861 s |       14.863 s\n\n  Total energy components:\n  | Sum of eigenvalues            :        -151.37923990 Ha       -4119.23870235 eV\n  | XC energy correction          :         -24.44685738 Ha        -665.23283605 eV\n  | XC potential correction       :          31.84308529 Ha         866.49443746 eV\n  | Free-atom electrostatic energy:        -130.88597416 Ha       -3561.58856859 eV\n  | Hartree energy correction     :          -0.37115708 Ha         -10.09969792 eV\n  | Entropy correction            :           0.00000000 Ha           0.00000000 eV\n  | ---------------------------\n  | Total energy                  :        -275.24014324 Ha       -7489.66536745 eV\n  | Total energy, T -> 0          :        -275.24014324 Ha       -7489.66536745 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy        :        -275.24014324 Ha       -7489.66536745 eV\n\n  Derived energy quantities:\n  | Kinetic energy                :         275.72011310 Ha        7502.72601198 eV\n  | Electrostatic energy          :        -526.51339896 Ha      -14327.15854338 eV\n  | Energy correction for multipole\n  | error in Hartree potential    :           0.00356157 Ha           0.09691537 eV\n  | Sum of eigenvalues per atom                           :       -2059.61935117 eV\n  | Total energy (T->0) per atom                          :       -3744.83268372 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy per atom                       :       -3744.83268372 eV\n  What follows are estimated values for band gap, HOMO, LUMO, etc.\n  | They are estimated on a discrete k-point grid and not necessarily exact.\n  | For converged numbers, create a DOS and/or band structure plot on a denser k-grid.\n\n  Highest occupied state (VBM) at     -9.64325638 eV (relative to internal zero)\n  | Occupation number:      2.00000000\n  | K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  Lowest unoccupied state (CBM) at    -5.16542680 eV (relative to internal zero)\n  | Occupation number:      0.00000000\n  | K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  ESTIMATED overall HOMO-LUMO gap:      4.47782958 eV between HOMO at k-point 1 and LUMO at k-point 1\n  | This appears to be a direct band gap.\n  The gap value is above 0.2 eV. Unless you are using a very sparse k-point grid,\n  this system is most likely an insulator or a semiconductor.\n\n  Self-consistency cycle converged.\n\n  Removing unitary transformations (pure translations, rotations) from forces on atoms.\n  Atomic forces before filtering:\n  | Net force on center of mass :  -0.379388E-08 -0.426476E-02 -0.426475E-02 eV/A\n  Atomic forces after filtering:\n  | Net force on center of mass :  -0.265846E-23 -0.446015E-16  0.000000E+00 eV/A\n\n  Energy and forces in a compact form:\n  | Total energy uncorrected      :         -0.748966536744980E+04 eV\n  | Total energy corrected        :         -0.748966536744980E+04 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy        :         -0.748966536744980E+04 eV\n  Total atomic forces (unitary forces cleaned) [eV/Ang]:\n  |    1         -0.108555415821635E-07          0.232312241621526E+00          0.232312248124934E+00\n  |    2          0.108555415821635E-07         -0.232312241621526E+00         -0.232312248124934E+00\n\n  Removing unitary transformations (pure translations, rotations) from forces on atoms.\n  Atomic forces before filtering:\n  | Net force on center of mass :  -0.265846E-23 -0.446015E-16  0.000000E+00 eV/A\n  Atomic forces after filtering:\n  | Net force on center of mass :   0.000000E+00  0.446015E-16  0.000000E+00 eV/A\n ------------------------------------------------------------------------\n Atomic structure that was used in the preceding time step of the wrapper\n                         x [A]             y [A]             z [A]\n  lattice_vector         0.00000000        2.11313574        2.11313574\n  lattice_vector         2.11313574        0.00000000        2.11313574\n  lattice_vector         2.11313574        2.11313574        0.00000000\n\n            atom         0.00000000        0.00000000        0.00000000  Mg\n            atom         2.11313574        0.04226271        0.04226271  O\n ------------------------------------------------------------------------\n  @ DRIVER MODE: Message from server: STATUS\n  @ DRIVER MODE: Message from server: GETFORCE\n  @ DRIVER MODE: Returning v,forces,stress\n  @ DRIVER MODE: Message from server: STATUS\n  @ DRIVER MODE: Message from server: INIT\n  @ DRIVER MODE: Receiving replica           0\n  @ DRIVER MODE: Message from server: STATUS\n  @ DRIVER MODE: Message from server: POSDATA\n  @ DRIVER MODE: Received positions\n\n------------------------------------------------------------\n          Begin self-consistency loop: Re-initialization.\n\n  Date     :  20200311, Time     :  204340.453\n------------------------------------------------------------\n\n  Initializing index lists of integration centers etc. from given atomic structure:\n  Mapping all atomic coordinates to central unit cell.\n\n  Initializing the k-points\n          Using symmetry for reducing the k-points\n  | k-points reduced from:       64 to       36\n  | Number of k-points                             :        36\n  The eigenvectors in the calculations are COMPLEX.\n  | K-points in task   0:         9\n  | K-points in task   1:         9\n  | K-points in task   2:         9\n  | K-points in task   3:         9\n  | Number of basis functions in the Hamiltonian integrals :      1949\n  | Number of basis functions in a single unit cell        :        29\n  | Number of centers in hartree potential         :      1097\n  | Number of centers in hartree multipole         :       842\n  | Number of centers in electron density summation:       585\n  | Number of centers in basis integrals           :       633\n  | Number of centers in integrals                 :       203\n  | Number of centers in hamiltonian               :       654\n  | Consuming        228 KiB for k_phase.\n  | Number of super-cells (origin) [n_cells]                     :        2197\n  | Number of super-cells (after PM_index) [n_cells]             :         406\n  | Number of super-cells in hamiltonian [n_cells_in_hamiltonian]:         406\n  | Size of matrix packed + index [n_hamiltonian_matrix_size] :       70804\n  Partitioning the integration grid into batches with parallel hashing+maxmin method.\n  Initializing partition tables, free-atom densities, potentials, etc. across the integration grid (initialize_grid_storage).\n  | Species        1: outer_partition_radius set to              5.555717568450569 AA .\n  | Species        2: outer_partition_radius set to              5.048384829883283 AA .\n  | The sparse table of interatomic distances needs       2198.75 kbyte instead of      3205.51 kbyte of memory.\n  | Net number of integration points:    11936\n  | of which are non-zero points    :     9174\n  Renormalizing the initial density to the exact electron count on the 3D integration grid.\n  | Initial density: Formal number of electrons (from input files) :      20.0000000000\n  | Integrated number of electrons on 3D grid     :      20.0033111186\n  | Charge integration error                      :       0.0033111186\n  | Normalization factor for density and gradient :       0.9998344715\n  Calculating total energy contributions from superposition of free atom densities.\n  Initialize hartree_potential_storage\n  Max. number of atoms included in rho_multipole:            2\n  Integrating overlap matrix.\n  Time summed over all CPUs for integration: real work        1.006 s, elapsed        1.029 s\n  Orthonormalizing eigenvectors\n\n  End scf reinitialization - timings           :  max(cpu_time)    wall_clock(cpu1)\n  | Time for scf. reinitialization             :        0.696 s           0.697 s\n  | Boundary condition initialization          :        0.095 s           0.095 s\n  | Integration                                :        0.258 s           0.258 s\n  | Grid partitioning                          :        0.019 s           0.019 s\n  | Preloading free-atom quantities on grid    :        0.296 s           0.295 s\n  | Free-atom superposition energy             :        0.026 s           0.027 s\n  | K.-S. eigenvector reorthonormalization     :        0.002 s           0.001 s\n------------------------------------------------------------\nConvergence:    q app. |  density  | eigen (eV) | Etot (eV) | forces (eV/A) |       CPU time |     Clock time\n  SCF    1 :  0.33E-02 |  0.39E+00 |  -0.41E+04 | -0.75E+04 |             . |        1.072 s |        1.072 s\n  SCF    2 :  0.32E-02 |  0.91E+00 |  -0.22E+02 |  0.79E+01 |             . |        1.400 s |        1.400 s\n  SCF    3 :  0.31E-02 |  0.56E+00 |  -0.39E+02 |  0.45E+01 |             . |        1.449 s |        1.450 s\n  SCF    4 :  0.31E-02 |  0.59E-01 |   0.28E+01 |  0.14E-01 |             . |        1.252 s |        1.253 s\n  SCF    5 :  0.32E-02 |  0.25E-01 |  -0.32E+00 | -0.21E-02 |             . |        1.350 s |        1.349 s\n  SCF    6 :  0.33E-02 |  0.32E-02 |  -0.25E+00 |  0.29E-03 |             . |        1.176 s |        1.175 s\n  SCF    7 :  0.35E-02 |  0.49E-02 |   0.60E+00 |  0.44E-04 |             . |        1.185 s |        1.186 s\n  SCF    8 :  0.34E-02 |  0.11E-02 |   0.10E+00 | -0.69E-04 |             . |        1.165 s |        1.165 s\n  SCF    9 :  0.34E-02 |  0.82E-04 |   0.41E-02 | -0.33E-05 |             . |        1.168 s |        1.168 s\n  SCF   10 :  0.33E-02 |  0.72E-04 |  -0.19E-02 | -0.80E-05 |      0.33E-02 |        1.642 s |        1.642 s\n  SCF   11 :  0.33E-02\n  Analytical stress tensor components [eV]         xx                  yy                  zz                  xy                  xz                  yz\n  -----------------------------------------------------------------------------------------------------------------------------------------------------------\n    Nuclear Hellmann-Feynman      :    -0.3864674379E+02   -0.3864415535E+02   -0.3864415535E+02   -0.2513001734E-11   -0.2404967012E-11    0.2659262711E-04\n    Multipole Hellmann-Feynman    :    -0.5297314950E+02   -0.5297337267E+02   -0.5297337267E+02   -0.2417076525E-11   -0.1885368919E-11    0.4490875098E-05\n    On-site Multipole corrections :    -0.1375921434E+00   -0.1375921435E+00   -0.1375921434E+00    0.1740136643E-11    0.5800455476E-11    0.4302004478E-11\n    Strain deriv. of the orbitals :     0.9175132185E+02    0.9174867058E+02    0.9174867058E+02   -0.4651096734E-09   -0.3547552527E-09   -0.1085119856E-04\n  -----------------------------------------------------------------------------------------------------------------------------------------------------------\n  Sum of all contributions        :    -0.6163591118E-02   -0.6449573826E-02   -0.6449574530E-02   -0.4682996150E-09   -0.3532451331E-09    0.2023230795E-04\n\n  +-------------------------------------------------------------------+\n  |              Analytical stress tensor - Symmetrized               |\n  |                  Cartesian components [eV/A**3]                   |\n  +-------------------------------------------------------------------+\n  |                x                y                z                |\n  |                                                                   |\n  |  x        -0.00032660      -0.00000000      -0.00000000           |\n  |  y        -0.00000000      -0.00034176       0.00000107           |\n  |  z        -0.00000000       0.00000107      -0.00034176           |\n  |                                                                   |\n  |  Pressure:       0.00033671   [eV/A**3]                           |\n  |                                                                   |\n  +-------------------------------------------------------------------+\n\n * Warning: Stress tensor is anisotropic. Be aware that pressure is an isotropic quantity.\n\n |  0.17E-04 |   0.99E-03 | -0.18E-05 |      0.29E-02 |       16.571 s |       16.572 s\n\n  Total energy components:\n  | Sum of eigenvalues            :        -151.38002476 Ha       -4119.26005928 eV\n  | XC energy correction          :         -24.44607870 Ha        -665.21164709 eV\n  | XC potential correction       :          31.84204127 Ha         866.46602823 eV\n  | Free-atom electrostatic energy:        -130.88928774 Ha       -3561.67873571 eV\n  | Hartree energy correction     :          -0.36705358 Ha          -9.98803622 eV\n  | Entropy correction            :           0.00000000 Ha           0.00000000 eV\n  | ---------------------------\n  | Total energy                  :        -275.24040352 Ha       -7489.67245007 eV\n  | Total energy, T -> 0          :        -275.24040352 Ha       -7489.67245007 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy        :        -275.24040352 Ha       -7489.67245007 eV\n\n  Derived energy quantities:\n  | Kinetic energy                :         275.71490212 Ha        7502.58421404 eV\n  | Electrostatic energy          :        -526.50922694 Ha      -14327.04501702 eV\n  | Energy correction for multipole\n  | error in Hartree potential    :           0.00349067 Ha           0.09498603 eV\n  | Sum of eigenvalues per atom                           :       -2059.63002964 eV\n  | Total energy (T->0) per atom                          :       -3744.83622503 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy per atom                       :       -3744.83622503 eV\n  What follows are estimated values for band gap, HOMO, LUMO, etc.\n  | They are estimated on a discrete k-point grid and not necessarily exact.\n  | For converged numbers, create a DOS and/or band structure plot on a denser k-grid.\n\n  Highest occupied state (VBM) at     -9.63993423 eV (relative to internal zero)\n  | Occupation number:      2.00000000\n  | K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  Lowest unoccupied state (CBM) at    -5.16099556 eV (relative to internal zero)\n  | Occupation number:      0.00000000\n  | K-point:       1 at    0.000000    0.000000    0.000000 (in units of recip. lattice)\n\n  ESTIMATED overall HOMO-LUMO gap:      4.47893868 eV between HOMO at k-point 1 and LUMO at k-point 1\n  | This appears to be a direct band gap.\n  The gap value is above 0.2 eV. Unless you are using a very sparse k-point grid,\n  this system is most likely an insulator or a semiconductor.\n\n  Self-consistency cycle converged.\n\n  Removing unitary transformations (pure translations, rotations) from forces on atoms.\n  Atomic forces before filtering:\n  | Net force on center of mass :  -0.173882E-08  0.213870E-03  0.213872E-03 eV/A\n  Atomic forces after filtering:\n  | Net force on center of mass :  -0.132923E-23  0.000000E+00  0.653343E-19 eV/A\n\n  Energy and forces in a compact form:\n  | Total energy uncorrected      :         -0.748967245006648E+04 eV\n  | Total energy corrected        :         -0.748967245006648E+04 eV  <-- do not rely on this value for anything but (periodic) metals\n  | Electronic free energy        :         -0.748967245006648E+04 eV\n  Total atomic forces (unitary forces cleaned) [eV/Ang]:\n  |    1          0.773348206613320E-08         -0.167235616064691E-03         -0.167231728110871E-03\n  |    2         -0.773348206613320E-08          0.167235616064691E-03          0.167231728110871E-03\n\n  Removing unitary transformations (pure translations, rotations) from forces on atoms.\n  Atomic forces before filtering:\n  | Net force on center of mass :  -0.132923E-23  0.000000E+00  0.653343E-19 eV/A\n  Atomic forces after filtering:\n  | Net force on center of mass :  -0.132923E-23  0.000000E+00  0.217781E-19 eV/A\n ------------------------------------------------------------------------\n Atomic structure that was used in the preceding time step of the wrapper\n                         x [A]             y [A]             z [A]\n  lattice_vector         0.00000000        2.11313574        2.11313574\n  lattice_vector         2.11313574        0.00000000        2.11313574\n  lattice_vector         2.11313574        2.11313574        0.00000000\n\n            atom         0.00000000        0.00000000        0.00000000  Mg\n            atom         2.11313574        2.11313574        2.11313574  O\n ------------------------------------------------------------------------\n  @ DRIVER MODE: Message from server: STATUS\n  @ DRIVER MODE: Message from server: GETFORCE\n  @ DRIVER MODE: Returning v,forces,stress\n\n------------------------------------------------------------------------------\n  Final output of selected total energy values:\n\n  The following output summarizes some interesting total energy values\n  at the end of a run (AFTER all relaxation, molecular dynamics, etc.).\n\n  | Total energy of the DFT / Hartree-Fock s.c.f. calculation      :          -7489.672450066 eV\n  | Final zero-broadening corrected energy (caution - metals only) :          -7489.672450066 eV\n  | For reference only, the value of 1 Hartree used in FHI-aims is :             27.211384500 eV\n  | For reference only, the overall average (free atom contribution\n  | + realspace contribution) of the electrostatic potential after\n  | s.c.f. convergence is                                          :            -16.786786172 eV\n\n  Before relying on these values, please be sure to understand exactly which\n  total energy value is referred to by a given number. Different objects may\n  all carry the same name \'total energy\'. Definitions:\n\n  Total energy of the DFT / Hartree-Fock s.c.f. calculation:\n  | Note that this energy does not include ANY quantities calculated after the\n  | s.c.f. cycle, in particular not ANY RPA, MP2, etc. many-body perturbation terms.\n\n  Final zero-broadening corrected energy:\n  | For metallic systems only, a broadening of the occupation numbers at the Fermi\n  | level can be extrapolated back to zero broadening by an electron-gas inspired\n  | formula. For all systems that are not real metals, this value can be\n  | meaningless and should be avoided.\n\n------------------------------------------------------------------------------\n  Methods described in the following list of references were used in this FHI-aims run.\n  If you publish the results, please make sure to cite these reference if they apply.\n  FHI-aims is an academic code, and for our developers (often, Ph.D. students\n  and postdocs), scientific credit in the community is essential.\n  Thank you for helping us!\n\n  For any use of FHI-aims, please cite:\n\n    Volker Blum, Ralf Gehrke, Felix Hanke, Paula Havu, Ville Havu,\n    Xinguo Ren, Karsten Reuter, and Matthias Scheffler\n    \'Ab initio molecular simulations with numeric atom-centered orbitals\'\n    Computer Physics Communications 180, 2175-2196 (2009)\n    http://dx.doi.org/10.1016/j.cpc.2009.06.022\n\n\n  For the analytical stress tensor used in your run, please cite:\n\n    Franz Knuth, Christian Carbogno, Viktor Atalla, Volker Blum, Matthias Scheffler\n    \'All-electron formalism for total energy strain derivatives and\n    stress tensor components for numeric atom-centered orbitals\'\n    Computer Physics Communications 190, 33-50 (2015).\n    http://dx.doi.org/10.1016/j.cpc.2015.01.003\n\n\n  The provided symmetry information was generated with SPGlib:\n\n    Atsushi Togo, Yusuke Seto, Dimitar Pashov\n    SPGlib 1.7.3 obtained from http://spglib.sourceforge.net\n    Copyright (C) 2008 Atsushi Togo\n\n\n  The ELSI infrastructure was used in your run to solve the Kohn-Sham electronic structure.\n  Please check out http://elsi-interchange.org to learn more.\n  If scalability is important for your project, please acknowledge ELSI by citing:\n\n    V. W-z. Yu, F. Corsetti, A. Garcia, W. P. Huhn, M. Jacquelin, W. Jia,\n    B. Lange, L. Lin, J. Lu, W. Mi, A. Seifitokaldani, A. Vazquez-Mayagoitia,\n    C. Yang, H. Yang, and V. Blum\n    \'ELSI: A unified software interface for Kohn-Sham electronic structure solvers\'\n    Computer Physics Communications 222, 267-285 (2018).\n    http://dx.doi.org/10.1016/j.cpc.2017.09.007\n\n\n  For the real-space grid partitioning and parallelization used in this calculation, please cite:\n\n    Ville Havu, Volker Blum, Paula Havu, and Matthias Scheffler,\n    \'Efficient O(N) integration for all-electron electronic structure calculation\'\n    \'using numerically tabulated basis functions\'\n    Journal of Computational Physics 228, 8367-8379 (2009).\n    http://dx.doi.org/10.1016/j.jcp.2009.08.008\n\n  Of course, there are many other important community references, e.g., those cited in the\n  above references. Our list is limited to references that describe implementations in the\n  FHI-aims code. The reason is purely practical (length of this list) - please credit others as well.\n\n------------------------------------------------------------\n          Leaving FHI-aims.\n          Date     :  20200311, Time     :  204410.632\n\n          Computational steps:\n          | Number of self-consistency cycles          :           21\n          | Number of SCF (re)initializations          :            2\n\n          Detailed time accounting                     :  max(cpu_time)    wall_clock(cpu1)\n          | Total time                                 :       56.355 s          56.379 s\n          | Preparation time                           :        0.155 s           0.155 s\n          | Boundary condition initalization           :        0.157 s           0.156 s\n          | Grid partitioning                          :        0.035 s           0.035 s\n          | Preloading free-atom quantities on grid    :        0.298 s           0.297 s\n          | Free-atom superposition energy             :        0.049 s           0.050 s\n          | Total time for integrations                :        8.101 s           8.102 s\n          | Total time for solution of K.-S. equations :        0.136 s           0.136 s\n          | Total time for density & force components  :       40.500 s          40.501 s\n          | Total time for mixing & preconditioning    :        1.391 s           1.394 s\n          | Total time for Hartree multipole update    :        0.013 s           0.012 s\n          | Total time for Hartree multipole sum       :        5.042 s           5.044 s\n          | Total time for total energy evaluation     :        0.002 s           0.001 s\n          | Total time for scaled ZORA corrections     :        0.000 s           0.000 s\n\n          Partial memory accounting:\n          | Residual value for overall tracked memory usage across tasks:     0.000000 MB (should be 0.000000 MB)\n          | Peak values for overall tracked memory usage:\n          |   Minimum:       20.033 MB (on task 1 after allocating d_wave)\n          |   Maximum:       20.979 MB (on task 0 after allocating d_wave)\n          |   Average:       20.447 MB\n          | Largest tracked array allocation:\n          |   Minimum:        5.130 MB (density_matrix_con on task 1)\n          |   Maximum:        5.538 MB (density_matrix_con on task 0)\n          |   Average:        5.251 MB\n          Note:  These values currently only include a subset of arrays which are explicitly tracked.\n          The "true" memory usage will be greater.\n\n          Have a nice day.\n------------------------------------------------------------\n'
    with open('aims.out', 'w') as fd:
        fd.write(output)