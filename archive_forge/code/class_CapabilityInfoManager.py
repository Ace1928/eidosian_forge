from __future__ import absolute_import, division, print_function
from ansible.module_utils.basic import AnsibleModule
from ansible_collections.community.vmware.plugins.module_utils.vmware import vmware_argument_spec, PyVmomi
class CapabilityInfoManager(PyVmomi):

    def __init__(self, module):
        super(CapabilityInfoManager, self).__init__(module)
        cluster_name = self.params.get('cluster_name', None)
        esxi_host_name = self.params.get('esxi_hostname', None)
        self.hosts = self.get_all_host_objs(cluster_name=cluster_name, esxi_host_name=esxi_host_name)

    def gather_host_capability_info(self):
        hosts_capability_info = dict()
        for host in self.hosts:
            hc = host.capability
            hosts_capability_info[host.name] = dict(recursiveResourcePoolsSupported=hc.recursiveResourcePoolsSupported, cpuMemoryResourceConfigurationSupported=hc.cpuMemoryResourceConfigurationSupported, rebootSupported=hc.rebootSupported, shutdownSupported=hc.shutdownSupported, vmotionSupported=hc.vmotionSupported, standbySupported=hc.standbySupported, ipmiSupported=hc.ipmiSupported, maxSupportedVMs=hc.maxSupportedVMs, maxRunningVMs=hc.maxRunningVMs, maxSupportedVcpus=hc.maxSupportedVcpus, maxRegisteredVMs=hc.maxRegisteredVMs, datastorePrincipalSupported=hc.datastorePrincipalSupported, sanSupported=hc.sanSupported, nfsSupported=hc.nfsSupported, iscsiSupported=hc.iscsiSupported, vlanTaggingSupported=hc.vlanTaggingSupported, nicTeamingSupported=hc.nicTeamingSupported, highGuestMemSupported=hc.highGuestMemSupported, maintenanceModeSupported=hc.maintenanceModeSupported, suspendedRelocateSupported=hc.suspendedRelocateSupported, restrictedSnapshotRelocateSupported=hc.restrictedSnapshotRelocateSupported, perVmSwapFiles=hc.perVmSwapFiles, localSwapDatastoreSupported=hc.localSwapDatastoreSupported, unsharedSwapVMotionSupported=hc.unsharedSwapVMotionSupported, backgroundSnapshotsSupported=hc.backgroundSnapshotsSupported, preAssignedPCIUnitNumbersSupported=hc.preAssignedPCIUnitNumbersSupported, screenshotSupported=hc.screenshotSupported, scaledScreenshotSupported=hc.scaledScreenshotSupported, storageVMotionSupported=hc.storageVMotionSupported, vmotionWithStorageVMotionSupported=hc.vmotionWithStorageVMotionSupported, vmotionAcrossNetworkSupported=hc.vmotionAcrossNetworkSupported, maxNumDisksSVMotion=hc.maxNumDisksSVMotion, hbrNicSelectionSupported=hc.hbrNicSelectionSupported, vrNfcNicSelectionSupported=hc.vrNfcNicSelectionSupported, recordReplaySupported=hc.recordReplaySupported, ftSupported=hc.ftSupported, replayUnsupportedReason=hc.replayUnsupportedReason, smpFtSupported=hc.smpFtSupported, maxVcpusPerFtVm=hc.maxVcpusPerFtVm, loginBySSLThumbprintSupported=hc.loginBySSLThumbprintSupported, cloneFromSnapshotSupported=hc.cloneFromSnapshotSupported, deltaDiskBackingsSupported=hc.deltaDiskBackingsSupported, perVMNetworkTrafficShapingSupported=hc.perVMNetworkTrafficShapingSupported, tpmSupported=hc.tpmSupported, virtualExecUsageSupported=hc.virtualExecUsageSupported, storageIORMSupported=hc.storageIORMSupported, vmDirectPathGen2Supported=hc.vmDirectPathGen2Supported, vmDirectPathGen2UnsupportedReasonExtended=hc.vmDirectPathGen2UnsupportedReasonExtended, vStorageCapable=hc.vStorageCapable, snapshotRelayoutSupported=hc.snapshotRelayoutSupported, firewallIpRulesSupported=hc.firewallIpRulesSupported, servicePackageInfoSupported=hc.servicePackageInfoSupported, maxHostRunningVms=hc.maxHostRunningVms, maxHostSupportedVcpus=hc.maxHostSupportedVcpus, vmfsDatastoreMountCapable=hc.vmfsDatastoreMountCapable, eightPlusHostVmfsSharedAccessSupported=hc.eightPlusHostVmfsSharedAccessSupported, nestedHVSupported=hc.nestedHVSupported, vPMCSupported=hc.vPMCSupported, interVMCommunicationThroughVMCISupported=hc.interVMCommunicationThroughVMCISupported, scheduledHardwareUpgradeSupported=hc.scheduledHardwareUpgradeSupported, featureCapabilitiesSupported=hc.featureCapabilitiesSupported, latencySensitivitySupported=hc.latencySensitivitySupported, storagePolicySupported=hc.storagePolicySupported, accel3dSupported=hc.accel3dSupported, reliableMemoryAware=hc.reliableMemoryAware, multipleNetworkStackInstanceSupported=hc.multipleNetworkStackInstanceSupported, messageBusProxySupported=hc.messageBusProxySupported, vsanSupported=hc.vsanSupported, vFlashSupported=hc.vFlashSupported, hostAccessManagerSupported=hc.hostAccessManagerSupported, provisioningNicSelectionSupported=hc.provisioningNicSelectionSupported, nfs41Supported=hc.nfs41Supported, nfs41Krb5iSupported=hc.nfs41Krb5iSupported, turnDiskLocatorLedSupported=hc.turnDiskLocatorLedSupported, virtualVolumeDatastoreSupported=hc.virtualVolumeDatastoreSupported, markAsSsdSupported=hc.markAsSsdSupported, markAsLocalSupported=hc.markAsLocalSupported, smartCardAuthenticationSupported=hc.smartCardAuthenticationSupported, cryptoSupported=hc.cryptoSupported, oneKVolumeAPIsSupported=hc.oneKVolumeAPIsSupported, gatewayOnNicSupported=hc.gatewayOnNicSupported, upitSupported=hc.upitSupported, cpuHwMmuSupported=hc.cpuHwMmuSupported, encryptedVMotionSupported=hc.encryptedVMotionSupported, encryptionChangeOnAddRemoveSupported=hc.encryptionChangeOnAddRemoveSupported, encryptionHotOperationSupported=hc.encryptionHotOperationSupported, encryptionWithSnapshotsSupported=hc.encryptionWithSnapshotsSupported, encryptionFaultToleranceSupported=hc.encryptionFaultToleranceSupported, encryptionMemorySaveSupported=hc.encryptionMemorySaveSupported, encryptionRDMSupported=hc.encryptionRDMSupported, encryptionVFlashSupported=hc.encryptionVFlashSupported, encryptionCBRCSupported=hc.encryptionCBRCSupported, encryptionHBRSupported=hc.encryptionHBRSupported, supportedVmfsMajorVersion=list(hc.supportedVmfsMajorVersion), vmDirectPathGen2UnsupportedReason=list(hc.vmDirectPathGen2UnsupportedReason), ftCompatibilityIssues=list(hc.ftCompatibilityIssues), smpFtCompatibilityIssues=list(hc.smpFtCompatibilityIssues), replayCompatibilityIssues=list(hc.replayCompatibilityIssues))
            hosts_capability_info[host.name]['checkpointFtSupported'] = hosts_capability_info[host.name]['smpFtSupported']
            hosts_capability_info[host.name]['checkpointFtCompatibilityIssues'] = hosts_capability_info[host.name]['smpFtCompatibilityIssues']
        return hosts_capability_info