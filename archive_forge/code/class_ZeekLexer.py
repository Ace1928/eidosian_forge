import re
from pygments.lexer import ExtendedRegexLexer, RegexLexer, bygroups, words, \
from pygments.token import Text, Comment, Operator, Keyword, Name, String, \
class ZeekLexer(RegexLexer):
    """
    For Zeek scripts.

    .. versionadded:: 2.5
    """
    name = 'Zeek'
    url = 'https://www.zeek.org/'
    aliases = ['zeek', 'bro']
    filenames = ['*.zeek', '*.bro']
    _hex = '[0-9a-fA-F]'
    _float = '((\\d*\\.?\\d+)|(\\d+\\.?\\d*))([eE][-+]?\\d+)?'
    _h = '[A-Za-z0-9][-A-Za-z0-9]*'
    tokens = {'root': [include('whitespace'), include('comments'), include('directives'), include('attributes'), include('types'), include('keywords'), include('literals'), include('operators'), include('punctuation'), ('((?:[A-Za-z_]\\w*)(?:::(?:[A-Za-z_]\\w*))*)(?=\\s*\\()', Name.Function), include('identifiers')], 'whitespace': [('\\n', Whitespace), ('\\s+', Whitespace), ('(\\\\)(\\n)', bygroups(Text, Whitespace))], 'comments': [('#.*$', Comment)], 'directives': [('@(load-plugin|load-sigs|load|unload)\\b.*$', Comment.Preproc), ('@(DEBUG|DIR|FILENAME|deprecated|if|ifdef|ifndef|else|endif)\\b', Comment.Preproc), ('(@prefixes)(\\s*)((\\+?=).*)$', bygroups(Comment.Preproc, Whitespace, Comment.Preproc))], 'attributes': [(words(('redef', 'priority', 'log', 'optional', 'default', 'add_func', 'delete_func', 'expire_func', 'read_expire', 'write_expire', 'create_expire', 'synchronized', 'persistent', 'rotate_interval', 'rotate_size', 'encrypt', 'raw_output', 'mergeable', 'error_handler', 'type_column', 'deprecated'), prefix='&', suffix='\\b'), Keyword.Pseudo)], 'types': [(words(('any', 'enum', 'record', 'set', 'table', 'vector', 'function', 'hook', 'event', 'addr', 'bool', 'count', 'double', 'file', 'int', 'interval', 'pattern', 'port', 'string', 'subnet', 'time'), suffix='\\b'), Keyword.Type), ('(opaque)(\\s+)(of)(\\s+)((?:[A-Za-z_]\\w*)(?:::(?:[A-Za-z_]\\w*))*)\\b', bygroups(Keyword.Type, Whitespace, Operator.Word, Whitespace, Keyword.Type)), ('(type)(\\s+)((?:[A-Za-z_]\\w*)(?:::(?:[A-Za-z_]\\w*))*)(\\s*)(:)(\\s*)\\b(record|enum)\\b', bygroups(Keyword, Whitespace, Name.Class, Whitespace, Operator, Whitespace, Keyword.Type)), ('(type)(\\s+)((?:[A-Za-z_]\\w*)(?:::(?:[A-Za-z_]\\w*))*)(\\s*)(:)', bygroups(Keyword, Whitespace, Name, Whitespace, Operator)), ('(redef)(\\s+)(record|enum)(\\s+)((?:[A-Za-z_]\\w*)(?:::(?:[A-Za-z_]\\w*))*)\\b', bygroups(Keyword, Whitespace, Keyword.Type, Whitespace, Name.Class))], 'keywords': [(words(('redef', 'export', 'if', 'else', 'for', 'while', 'return', 'break', 'next', 'continue', 'fallthrough', 'switch', 'default', 'case', 'add', 'delete', 'when', 'timeout', 'schedule'), suffix='\\b'), Keyword), ('(print)\\b', Keyword), ('(global|local|const|option)\\b', Keyword.Declaration), ('(module)(\\s+)(([A-Za-z_]\\w*)(?:::([A-Za-z_]\\w*))*)\\b', bygroups(Keyword.Namespace, Whitespace, Name.Namespace))], 'literals': [('"', String, 'string'), ('/(?=.*/)', String.Regex, 'regex'), ('(T|F)\\b', Keyword.Constant), ('\\d{1,5}/(udp|tcp|icmp|unknown)\\b', Number), ('(\\d{1,3}.){3}(\\d{1,3})\\b', Number), ('\\[([0-9a-fA-F]{0,4}:){2,7}([0-9a-fA-F]{0,4})?((\\d{1,3}.){3}(\\d{1,3}))?\\]', Number), ('0[xX]' + _hex + '+\\b', Number.Hex), (_float + '\\s*(day|hr|min|sec|msec|usec)s?\\b', Number.Float), (_float + '\\b', Number.Float), ('(\\d+)\\b', Number.Integer), (_h + '(\\.' + _h + ')+', String)], 'operators': [('[!%*/+<=>~|&^-]', Operator), ('([-+=&|]{2}|[+=!><-]=)', Operator), ('(in|as|is|of)\\b', Operator.Word), ('\\??\\$', Operator)], 'punctuation': [('[{}()\\[\\],;.]', Punctuation), ('[?:]', Punctuation)], 'identifiers': [('([a-zA-Z_]\\w*)(::)', bygroups(Name, Punctuation)), ('[a-zA-Z_]\\w*', Name)], 'string': [('\\\\.', String.Escape), ('%-?[0-9]*(\\.[0-9]+)?[DTd-gsx]', String.Escape), ('"', String, '#pop'), ('.', String)], 'regex': [('\\\\.', String.Escape), ('/', String.Regex, '#pop'), ('.', String.Regex)]}