import sys
import fixtures
class HackingTranslations(fixtures.Fixture):
    """Fixtures for checking translation rules.

    1. Exception messages should be translated
    2. Logging messages should not be translated
    3. If a message is used for both an exception and logging it
       should be translated
    """
    shared_imports = '\n                import logging\n                import logging as stlib_logging\n                from keystone.i18n import _\n                from keystone.i18n import _ as oslo_i18n\n                from oslo_log import log\n                from oslo_log import log as oslo_logging\n    '
    examples = [{'code': "\n                # stdlib logging\n                LOG = logging.getLogger()\n                LOG.info(_('text'))\n                class C:\n                    def __init__(self):\n                        LOG.warning(oslo_i18n('text', {}))\n            ", 'expected_errors': [(3, 9, 'K005'), (6, 20, 'K005')]}, {'code': "\n                # stdlib logging w/ alias and specifying a logger\n                class C:\n                    def __init__(self):\n                        self.L = logging.getLogger(__name__)\n                    def m(self):\n                        self.L.warning(\n                            _('text'), {}\n                        )\n            ", 'expected_errors': [(7, 12, 'K005')]}, {'code': "\n                # oslo logging and specifying a logger\n                L = log.getLogger(__name__)\n                L.error(oslo_i18n('text'))\n            ", 'expected_errors': [(3, 8, 'K005')]}, {'code': "\n                # oslo logging w/ alias\n                class C:\n                    def __init__(self):\n                        self.LOG = oslo_logging.getLogger()\n                        self.LOG.critical(_('text'))\n            ", 'expected_errors': [(5, 26, 'K005')]}, {'code': "\n                LOG = log.getLogger(__name__)\n                # translation on a separate line\n                msg = _('text')\n                LOG.exception(msg)\n            ", 'expected_errors': [(4, 14, 'K005')]}, {'code': "\n                # this should be an error even if it'll be raised later.\n                L = log.getLogger(__name__)\n                msg = _('text')\n                L.warning(msg)\n                raise Exception(msg)\n            ", 'expected_errors': [(4, 10, 'K005')]}, {'code': "\n                L = log.getLogger(__name__)\n                def f():\n                    msg = _('text')\n                    L.warning(msg)\n                    something = True  # add an extra statement here\n                    raise Exception(msg)\n            ", 'expected_errors': [(4, 14, 'K005')]}, {'code': "\n                LOG = log.getLogger(__name__)\n                def func():\n                    msg = _('text')\n                    LOG.warning(msg)\n                    raise Exception('some other message')\n            ", 'expected_errors': [(4, 16, 'K005')]}, {'code': "\n                LOG = log.getLogger(__name__)\n                if True:\n                    msg = _('text')\n                else:\n                    msg = _('text')\n                LOG.warning(msg)\n                raise Exception(msg)\n            ", 'expected_errors': [(6, 12, 'K005')]}, {'code': "\n                LOG = log.getLogger(__name__)\n                if True:\n                    msg = _('text')\n                else:\n                    msg = _('text')\n                LOG.warning(msg)\n            ", 'expected_errors': [(6, 12, 'K005')]}, {'code': "\n                LOG = log.getLogger(__name__)\n                msg = _LW('text')\n                LOG.warning(msg)\n                msg = _('something else')\n                raise Exception(msg)\n            ", 'expected_errors': []}, {'code': "\n                LOG = log.getLogger(__name__)\n                msg = _('hello %s') % 'world'\n                LOG.warning(msg)\n            ", 'expected_errors': [(3, 12, 'K005')]}, {'code': '\n                # this should not be an error\n                LOG = log.getLogger(__name__)\n                try:\n                    something = True\n                except AssertionError as e:\n                    LOG.warning(e)\n                    raise exception.Unauthorized(e)\n            ', 'expected_errors': []}, {'code': "\n                # this should not be an error\n                LOG = log.getLogger(__name__)\n                try:\n                    pass\n                except AssertionError as e:\n                    msg = _('some message')\n                    LOG.warning(msg)\n                    raise exception.Unauthorized(message=msg)\n            ", 'expected_errors': [(7, 16, 'K005')]}]