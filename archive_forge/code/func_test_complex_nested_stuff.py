from __future__ import unicode_literals
import contextlib
import logging
import unittest
import sys
from cmakelang.format import __main__
from cmakelang import configuration
from cmakelang import lex
from cmakelang import parse
from cmakelang.format import formatter
from cmakelang.parse.common import NodeType
def test_complex_nested_stuff(self):
    self.config.format.autosort = False
    self.do_layout_test("      if(foo)\n      if(sbar)\n      # This comment is in-scope.\n      add_library(foo_bar_baz foo.cc bar.cc # this is a comment for arg2\n                    # this is more comment for arg2, it should be joined with the first.\n          baz.cc) # This comment is part of add_library\n\n      other_command(some_long_argument some_long_argument) # this comment is very long and gets split across some lines\n\n      other_command(some_long_argument some_long_argument some_long_argument) # this comment is even longer and wouldn't make sense to pack at the end of the command so it gets it's own lines\n      endif()\n      endif()\n      ", [(NodeType.BODY, 0, 0, 0, 80, [(NodeType.FLOW_CONTROL, 0, 0, 0, 80, [(NodeType.STATEMENT, 0, 0, 0, 7, [(NodeType.FUNNAME, 0, 0, 0, 2, []), (NodeType.LPAREN, 0, 0, 2, 3, []), (NodeType.ARGGROUP, 0, 0, 3, 6, [(NodeType.PARGGROUP, 0, 0, 3, 6, [(NodeType.ARGUMENT, 0, 0, 3, 6, [])])]), (NodeType.RPAREN, 0, 0, 6, 7, [])]), (NodeType.BODY, 0, 1, 2, 80, [(NodeType.FLOW_CONTROL, 0, 1, 2, 80, [(NodeType.STATEMENT, 0, 1, 2, 10, [(NodeType.FUNNAME, 0, 1, 2, 4, []), (NodeType.LPAREN, 0, 1, 4, 5, []), (NodeType.ARGGROUP, 0, 1, 5, 9, [(NodeType.PARGGROUP, 0, 1, 5, 9, [(NodeType.ARGUMENT, 0, 1, 5, 9, [])])]), (NodeType.RPAREN, 0, 1, 9, 10, [])]), (NodeType.BODY, 0, 2, 4, 80, [(NodeType.COMMENT, 0, 2, 4, 31, []), (NodeType.STATEMENT, 4, 3, 4, 74, [(NodeType.FUNNAME, 0, 3, 4, 15, []), (NodeType.LPAREN, 0, 3, 15, 16, []), (NodeType.ARGGROUP, 4, 4, 6, 74, [(NodeType.PARGGROUP, 0, 4, 6, 17, [(NodeType.ARGUMENT, 0, 4, 6, 17, [])]), (NodeType.PARGGROUP, 0, 5, 6, 74, [(NodeType.ARGUMENT, 0, 5, 6, 12, []), (NodeType.ARGUMENT, 0, 5, 13, 48, [(NodeType.COMMENT, 0, 5, 20, 48, [])]), (NodeType.COMMENT, 0, 6, 6, 74, []), (NodeType.ARGUMENT, 0, 7, 6, 12, [])])]), (NodeType.RPAREN, 0, 7, 12, 13, []), (NodeType.COMMENT, 0, 7, 14, 51, [])]), (NodeType.WHITESPACE, 0, 8, 4, 0, []), (NodeType.STATEMENT, 1, 9, 4, 76, [(NodeType.FUNNAME, 0, 9, 4, 17, []), (NodeType.LPAREN, 0, 9, 17, 18, []), (NodeType.ARGGROUP, 0, 10, 6, 43, [(NodeType.PARGGROUP, 0, 10, 6, 43, [(NodeType.ARGUMENT, 0, 10, 6, 24, []), (NodeType.ARGUMENT, 0, 10, 25, 43, [])])]), (NodeType.RPAREN, 0, 10, 43, 44, []), (NodeType.COMMENT, 0, 10, 45, 76, [])]), (NodeType.WHITESPACE, 0, 12, 4, 0, []), (NodeType.STATEMENT, 1, 13, 4, 80, [(NodeType.FUNNAME, 0, 13, 4, 17, []), (NodeType.LPAREN, 0, 13, 17, 18, []), (NodeType.ARGGROUP, 0, 14, 6, 62, [(NodeType.PARGGROUP, 0, 14, 6, 62, [(NodeType.ARGUMENT, 0, 14, 6, 24, []), (NodeType.ARGUMENT, 0, 14, 25, 43, []), (NodeType.ARGUMENT, 0, 14, 44, 62, [])])]), (NodeType.RPAREN, 0, 14, 62, 63, []), (NodeType.COMMENT, 0, 14, 64, 80, [])])]), (NodeType.STATEMENT, 0, 23, 2, 9, [(NodeType.FUNNAME, 0, 23, 2, 7, []), (NodeType.LPAREN, 0, 23, 7, 8, []), (NodeType.ARGGROUP, 0, 23, 8, 8, []), (NodeType.RPAREN, 0, 23, 8, 9, [])])])]), (NodeType.STATEMENT, 0, 24, 0, 7, [(NodeType.FUNNAME, 0, 24, 0, 5, []), (NodeType.LPAREN, 0, 24, 5, 6, []), (NodeType.ARGGROUP, 0, 24, 6, 6, []), (NodeType.RPAREN, 0, 24, 6, 7, [])])])])])