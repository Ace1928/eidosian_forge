from __future__ import absolute_import
from __future__ import division
from __future__ import unicode_literals
from googlecloudsdk.api_lib.compute.instances.ops_agents import ops_agents_policy as agent_policy
from googlecloudsdk.calliope import arg_parsers
def AddMutationArgs(parser, required=True):
    """Adds arguments for mutating commands.

  Args:
    parser: A given parser.
    required: bool, default is True.
  """
    parser.add_argument('--description', metavar='DESCRIPTION', type=str, help='Description of the policy.')
    parser.add_argument('--agent-rules', metavar='type=TYPE,version=VERSION,package-state=PACKAGE-STATE,enable-autoupgrade=ENABLE-AUTOUPGRADE', action='store', required=required, type=arg_parsers.ArgList(custom_delim_char=';', min_length=1, element_type=arg_parsers.ArgDict(spec={'type': ArgEnum('type', list(agent_policy.OpsAgentPolicy.AgentRule.Type)), 'version': str, 'package-state': ArgEnum('package-state', list(agent_policy.OpsAgentPolicy.AgentRule.PackageState)), 'enable-autoupgrade': arg_parsers.ArgBoolean()}, required_keys=['type', 'enable-autoupgrade'])), help='      A non-empty list of agent rules to be enforced by the policy.\n\n      This flag must be quoted. Items in the list are separated by ";". Each\n      item in the list is a <key, value> map that represents a logging or\n      metrics agent. The allowed values of the key are as follows.\n\n      *type*::: Type of agent to manage.\n\n      *Required*. Allowed values: ``logging\'\', ``metrics\'\' and ``ops-agent\'\'.\n      Use ``logging\'\' for the Logging Agent\n      (https://cloud.google.com/logging/docs/agent). Use ``metrics\'\' for the\n      Monitoring Agent (https://cloud.google.com/monitoring/agent). Use\n      ``ops-agent\'\' for the Ops Agent\n      (https://cloud.google.com/stackdriver/docs/solutions/ops-agent). The Ops\n      Agent has both a logging module and a metrics module already. So other\n      types of agents are not allowed when there is an agent with type\n      ``ops-agent\'\'. See\n      https://cloud.google.com/stackdriver/docs/solutions/agents#which-agent-should-you-choose\n      for which agent to use.\n\n      *enable-autoupgrade*::: Whether to enable autoupgrade of the agent.\n\n      *Required*. Allowed values: ``true\'\' or ``false\'\'. This has to be\n      ``false\'\' if the agent version is set to a specific patch version in the\n      format of ``version=MAJOR_VERSION.MINOR_VERSION.PATCH_VERSION\'\'.\n\n      *version*::: Version of the agent to install.\n\n      Optional. Default to ``version=current-major\'\'. The allowed values and\n      formats are as follows.\n\n      *version=latest*::::\n\n      With this setting, the latest version of the agent is installed at the\n      time when the policy is applied to an instance.\n\n      If multiple instances are created at different times but they all fall\n      into the instance filter rules of an existing policy, they may end up with\n      different versions of the agent, depending on what the latest version of\n      the agent is at the policy application time (in this case the instance\n      creation time). One way to avoid this is to set\n      ``enable-autoupgrade=true\'\'. This guarantees that the installed agents on\n      all instances that are managed by this policy are always up to date and\n      conform to the same version.\n\n      While this ``version=latest\'\' setting makes it easier to keep the agent\n      version up to date, this setting does come with a potential risk. When a\n      new major version is released, the policy may install the latest version\n      of the agent from that new major release, which may introduce breaking\n      changes. For production environments, consider using the\n      ```version=MAJOR_VERSION.*.*``` setting below for safer agent deployments.\n\n      ```version=MAJOR_VERSION.*.*```::::\n\n      With this setting, the latest version of agent from a specific major\n      version is installed at the time when the policy is applied to an\n      instance.\n\n      If multiple instances are created at different times but they all fall\n      into the instance filter rules of an existing policy, they may end up with\n      different versions of the agent, depending on what the latest version of\n      the agent is at the policy application time (in this case the instance\n      creation time). One way to avoid this is to set\n      ``enable-autoupgrade=true\'\'. This guarantees that the installed agents on\n      all instances that are managed by this policy are always up to date within\n      that major version and conform to the same version.\n\n      When a new major release is out, this setting ensures that only the latest\n      version from the specified major version is installed, which avoids\n      accidentally introducing breaking changes. This is recommended for\n      production environments to ensure safer agent deployments.\n\n      *version=current-major*::::\n\n      With this setting, the version field is automatically set to\n      ```version=MAJOR_VERSION.*.*```, where ``MAJOR_VERSION\'\' is the current\n      latest major version released. Refer to the\n      ```version=MAJOR_VERSION.*.*``` section for the expected behavior.\n\n      *version=MAJOR_VERSION.MINOR_VERSION.PATCH_VERSION*::::\n\n      With this setting, the specified exact version of agent is installed at\n      the time when the policy is applied to an instance. ``enable-autoupgrade\'\'\n      must be false for this setting.\n\n      This setting is not recommended since it prevents the policy from\n      installing new versions of the agent that include bug fixes and other\n      improvements.\n\n      One limitation of this setting is that if the agent gets manually\n      uninstalled from the instances after the policy gets applied, the policy\n      can only ensure that the agent is re-installed. It is not able to restore\n      the expected exact version of the agent.\n\n      *version=5.5.2-BUILD_NUMBER*::::\n\n      Allowed for the metrics agent (``type=metrics\'\') only.\n\n      With this setting, the specified exact build number of the deprecated\n      5.5.2 metrics agent is installed at the time when the policy is applied\n      to an instance. enable-autoupgrade must be false for this setting.\n\n      This setting is deprecated and will be decommissioned along with the 5.5.2\n      metrics agent on Apr 28, 2021\n      (https://cloud.google.com/stackdriver/docs/deprecations/mon-agent).\n      It is not recommended since it prevents the policy from installing new\n      versions of the agent that include bug fixes and other improvements.\n\n      One limitation of this setting is that if the agent gets manually\n      uninstalled from the instances after the policy gets applied, the policy\n      can only ensure that the agent is re-installed. It is not able to restore\n      the expected exact version of the agent.\n\n      *package-state*:::\n      Desired package state of the agent.\n\n      Optional. Default to ``package-state=installed\'\'. The allowed values are\n      as follows.\n\n      *package-state=installed*::::\n\n      With this setting, the policy will ensure the agent package is installed\n      on the instances and the agent service is running.\n\n      *package-state=removed*::::\n\n      With this setting, the policy will ensure the agent package is removed\n      from the instances, which stops the service from running.\n      ')
    parser.add_argument('--os-types', metavar='short-name=SHORT-NAME,version=VERSION', action='store', required=required, type=arg_parsers.ArgList(custom_delim_char=';', min_length=1, element_type=arg_parsers.ArgDict(spec={'short-name': ArgEnum('short-name', list(agent_policy.OpsAgentPolicy.Assignment.OsType.OsShortName)), 'version': str}, required_keys=['short-name', 'version'])), help='      A non-empty list of OS types to filter instances that the policy applies\n      to.\n\n      For Alpha and Beta, exactly one OS type needs to be specified. The support for\n      multiple OS types will be added later for more flexibility. Each OS type\n      is defined by the combination of ``short-name\'\' and ``version\'\' fields.\n\n      Sample values:\n\n        OS Short Name      OS Version\n        centos             8\n        centos             7\n        debian             12\n        debian             11\n        debian             10\n        debian             9\n        rhel               9.*\n        rhel               8.*\n        rhel               7.*\n        rocky              9.*\n        rocky              8.*\n        sles               12.*\n        sles               15.*\n        sles_sap           12.*\n        sles_sap           15.*\n        ubuntu             16.04\n        ubuntu             18.04\n        ubuntu             19.10\n        ubuntu             20.04\n        ubuntu             21.04\n        ubuntu             21.10\n        ubuntu             22.04\n        ubuntu             23.04\n        ubuntu             23.10\n        windows            10.*\n        windows            6.*\n\n      *short-name*::: Short name of the OS.\n\n      *Required*. Allowed values: ``centos\'\', ``debian\'\', ``rhel\'\', ``rocky\'\',\n      ``sles\'\', ``sles_sap\'\', ``ubuntu\'\'.\n\n      To inspect the exact OS short name of an instance, run:\n\n        $ gcloud beta compute instances os-inventory describe INSTANCE_NAME | grep "^ShortName: "\n\n      Under the hood, this value is derived from the ``ID\'\' field in the\n      ``/etc/os-release\'\' file for most operating systems.\n\n      *version*::: Version of the OS.\n\n      *Required*. This can be either an exact match or a prefix followed by the\n      ```*``` wildcard.\n\n      To inspect the exact OS version of an instance, run:\n\n        $ gcloud beta compute instances os-inventory describe INSTANCE_NAME | grep "^Version: "\n\n      Under the hood, this value is derived from the ``VERSION_ID\'\' field in the\n      ``/etc/os-release\'\' file for most operating systems.\n      ')