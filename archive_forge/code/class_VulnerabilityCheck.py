from __future__ import absolute_import
from apitools.base.protorpclite import messages as _messages
from apitools.base.py import encoding
from apitools.base.py import extra_types
class VulnerabilityCheck(_messages.Message):
    """An image vulnerability check, which rejects images that violate the
  configured vulnerability rules.

  Enums:
    MaximumFixableSeverityValueValuesEnum: Required. The threshold for
      severity for which a fix is currently available. This field is required
      and must be set.
    MaximumUnfixableSeverityValueValuesEnum: Required. The threshold for
      severity for which a fix isn't currently available. This field is
      required and must be set.

  Fields:
    allowedCves: Optional. A list of specific CVEs to ignore even if the
      vulnerability level violates `maximumUnfixableSeverity` or
      `maximumFixableSeverity`. CVEs are listed in the format of Container
      Analysis note id. For example: - CVE-2021-20305 - CVE-2020-10543 The
      CVEs are applicable regardless of note provider project, e.g., an entry
      of `CVE-2021-20305` will allow vulnerabilities with a note name of
      either `projects/goog-vulnz/notes/CVE-2021-20305` or `projects/CUSTOM-
      PROJECT/notes/CVE-2021-20305`.
    blockedCves: Optional. A list of specific CVEs to always raise warnings
      about even if the vulnerability level meets `maximumUnfixableSeverity`
      or `maximumFixableSeverity`. CVEs are listed in the format of Container
      Analysis note id. For example: - CVE-2021-20305 - CVE-2020-10543 The
      CVEs are applicable regardless of note provider project, e.g., an entry
      of `CVE-2021-20305` will block vulnerabilities with a note name of
      either `projects/goog-vulnz/notes/CVE-2021-20305` or `projects/CUSTOM-
      PROJECT/notes/CVE-2021-20305`.
    containerAnalysisVulnerabilityProjects: Optional. The projects where
      vulnerabilities are stored as Container Analysis Occurrences. Each
      project is expressed in the resource format of `projects/[PROJECT_ID]`,
      e.g., `projects/my-gcp-project`. An attempt will be made for each
      project to fetch vulnerabilities, and all valid vulnerabilities will be
      used to check against the vulnerability policy. If no valid scan is
      found in all projects configured here, an error will be returned for the
      check. Maximum number of `container_analysis_vulnerability_projects`
      allowed in each `VulnerabilityCheck` is 10.
    maximumFixableSeverity: Required. The threshold for severity for which a
      fix is currently available. This field is required and must be set.
    maximumUnfixableSeverity: Required. The threshold for severity for which a
      fix isn't currently available. This field is required and must be set.
  """

    class MaximumFixableSeverityValueValuesEnum(_messages.Enum):
        """Required. The threshold for severity for which a fix is currently
    available. This field is required and must be set.

    Values:
      MAXIMUM_ALLOWED_SEVERITY_UNSPECIFIED: Not specified.
      BLOCK_ALL: Block any vulnerability.
      MINIMAL: Allow only minimal severity.
      LOW: Allow only low severity and lower.
      MEDIUM: Allow medium severity and lower.
      HIGH: Allow high severity and lower.
      CRITICAL: Allow critical severity and lower.
      ALLOW_ALL: Allow all severity, even vulnerability with unspecified
        severity.
    """
        MAXIMUM_ALLOWED_SEVERITY_UNSPECIFIED = 0
        BLOCK_ALL = 1
        MINIMAL = 2
        LOW = 3
        MEDIUM = 4
        HIGH = 5
        CRITICAL = 6
        ALLOW_ALL = 7

    class MaximumUnfixableSeverityValueValuesEnum(_messages.Enum):
        """Required. The threshold for severity for which a fix isn't currently
    available. This field is required and must be set.

    Values:
      MAXIMUM_ALLOWED_SEVERITY_UNSPECIFIED: Not specified.
      BLOCK_ALL: Block any vulnerability.
      MINIMAL: Allow only minimal severity.
      LOW: Allow only low severity and lower.
      MEDIUM: Allow medium severity and lower.
      HIGH: Allow high severity and lower.
      CRITICAL: Allow critical severity and lower.
      ALLOW_ALL: Allow all severity, even vulnerability with unspecified
        severity.
    """
        MAXIMUM_ALLOWED_SEVERITY_UNSPECIFIED = 0
        BLOCK_ALL = 1
        MINIMAL = 2
        LOW = 3
        MEDIUM = 4
        HIGH = 5
        CRITICAL = 6
        ALLOW_ALL = 7
    allowedCves = _messages.StringField(1, repeated=True)
    blockedCves = _messages.StringField(2, repeated=True)
    containerAnalysisVulnerabilityProjects = _messages.StringField(3, repeated=True)
    maximumFixableSeverity = _messages.EnumField('MaximumFixableSeverityValueValuesEnum', 4)
    maximumUnfixableSeverity = _messages.EnumField('MaximumUnfixableSeverityValueValuesEnum', 5)