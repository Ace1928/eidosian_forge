import warnings
import numpy as np
from numpy.testing import assert_almost_equal, assert_allclose
import scipy.sparse as sparse
import pytest
from statsmodels.stats.correlation_tools import (
from statsmodels.tools.testing import Holder
def test_corr_nearest_factor_arrpack(self):
    u2 = np.array([[6.39407581e-19, 0.00915225947, 0.0182631698, 0.0272917181, 0.0361975557, 0.0449413101, 0.0534848732, 0.0617916613, 0.0698268388, 0.0775575058, 0.0849528448, 0.0919842264, 0.0986252769, 0.104851906, 0.110642305, 0.115976906, 0.120838331, 0.125211306, 0.12908257, 0.132440778, 0.135276397, 0.137581605, 0.139350201, 0.140577526, 0.141260396, 0.141397057, 0.14098716, 0.140031756, 0.138533306, 0.136495727, 0.133924439, 0.130826443, 0.127210404, 0.12308675, 0.118467769, 0.113367717, 0.107802909, 0.101791811, 0.0953551023, 0.088515732, 0.0812989329, 0.0737322125, 0.0658453049, 0.0576700847, 0.0492404406, 0.0405921079, 0.0317624629, 0.0227902803, 0.0137154584, 0.00457871801, -0.00457871801, -0.0137154584, -0.0227902803, -0.0317624629, -0.0405921079, -0.0492404406, -0.0576700847, -0.0658453049, -0.0737322125, -0.0812989329, -0.088515732, -0.0953551023, -0.101791811, -0.107802909, -0.113367717, -0.118467769, -0.12308675, -0.127210404, -0.130826443, -0.133924439, -0.136495727, -0.138533306, -0.140031756, -0.14098716, -0.141397057, -0.141260396, -0.140577526, -0.139350201, -0.137581605, -0.135276397, -0.132440778, -0.12908257, -0.125211306, -0.120838331, -0.115976906, -0.110642305, -0.104851906, -0.0986252769, -0.0919842264, -0.0849528448, -0.0775575058, -0.0698268388, -0.0617916613, -0.0534848732, -0.0449413101, -0.0361975557, -0.0272917181, -0.0182631698, -0.00915225947, -3.51829569e-17]]).T
    s2 = np.array([24.88812183])
    d = 100
    dm = 1
    X = np.zeros((d, dm), dtype=np.float64)
    x = np.linspace(0, 2 * np.pi, d)
    for j in range(dm):
        X[:, j] = np.sin(x * (j + 1))
    _project_correlation_factors(X)
    X *= 0.7
    mat = np.dot(X, X.T)
    np.fill_diagonal(mat, 1.0)
    from scipy.sparse.linalg import svds
    u, s, vt = svds(mat, dm)
    dsign = np.sign(u[1]) * np.sign(u2[1])
    assert_allclose(u, dsign * u2, rtol=1e-06, atol=1e-14)
    assert_allclose(s, s2, rtol=1e-06)