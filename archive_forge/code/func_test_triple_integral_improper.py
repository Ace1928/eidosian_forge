import sys
import math
import numpy as np
from numpy import sqrt, cos, sin, arctan, exp, log, pi
from numpy.testing import (assert_,
import pytest
from scipy.integrate import quad, dblquad, tplquad, nquad
from scipy.special import erf, erfc
from scipy._lib._ccallback import LowLevelCallable
import ctypes
import ctypes.util
from scipy._lib._ccallback_c import sine_ctypes
import scipy.integrate._test_multivariate as clib_test
@pytest.mark.parametrize('x_lower, x_upper, y_lower, y_upper, z_lower, z_upper, expected', [(-np.inf, 0, -np.inf, 0, -np.inf, 0, np.pi ** (3 / 2) / 8), (-np.inf, -1, -np.inf, 0, -np.inf, 0, np.pi ** (3 / 2) / 8 * erfc(1)), (-np.inf, 0, -np.inf, -1, -np.inf, 0, np.pi ** (3 / 2) / 8 * erfc(1)), (-np.inf, 0, -np.inf, 0, -np.inf, -1, np.pi ** (3 / 2) / 8 * erfc(1)), (-np.inf, -1, -np.inf, -1, -np.inf, 0, np.pi ** (3 / 2) / 8 * erfc(1) ** 2), (-np.inf, -1, -np.inf, 0, -np.inf, -1, np.pi ** (3 / 2) / 8 * erfc(1) ** 2), (-np.inf, 0, -np.inf, -1, -np.inf, -1, np.pi ** (3 / 2) / 8 * erfc(1) ** 2), (-np.inf, -1, -np.inf, -1, -np.inf, -1, np.pi ** (3 / 2) / 8 * erfc(1) ** 3), (-np.inf, -1, -np.inf, 1, -np.inf, 1, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) ** 2 * erfc(1))), (-np.inf, -1, -np.inf, -1, -np.inf, 1, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) * erfc(1) ** 2)), (-np.inf, -1, -np.inf, 1, -np.inf, -1, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) * erfc(1) ** 2)), (-np.inf, 1, -np.inf, -1, -np.inf, -1, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) * erfc(1) ** 2)), (-np.inf, 1, -np.inf, 1, -np.inf, -1, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) ** 2 * erfc(1))), (-np.inf, 1, -np.inf, -1, -np.inf, 1, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) ** 2 * erfc(1))), (-np.inf, 1, -np.inf, 0, -np.inf, 0, np.pi ** (3 / 2) / 8 * (erf(1) + 1)), (-np.inf, 0, -np.inf, 1, -np.inf, 0, np.pi ** (3 / 2) / 8 * (erf(1) + 1)), (-np.inf, 0, -np.inf, 0, -np.inf, 1, np.pi ** (3 / 2) / 8 * (erf(1) + 1)), (-np.inf, 1, -np.inf, 1, -np.inf, 0, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 2), (-np.inf, 1, -np.inf, 0, -np.inf, 1, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 2), (-np.inf, 0, -np.inf, 1, -np.inf, 1, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 2), (-np.inf, 1, -np.inf, 1, -np.inf, 1, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 3), (0, np.inf, 0, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8), (1, np.inf, 0, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8 * erfc(1)), (0, np.inf, 1, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8 * erfc(1)), (0, np.inf, 0, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * erfc(1)), (1, np.inf, 1, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8 * erfc(1) ** 2), (1, np.inf, 0, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * erfc(1) ** 2), (0, np.inf, 1, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * erfc(1) ** 2), (1, np.inf, 1, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * erfc(1) ** 3), (-1, np.inf, 0, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1)), (0, np.inf, -1, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1)), (0, np.inf, 0, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1)), (-1, np.inf, -1, np.inf, 0, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 2), (-1, np.inf, 0, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 2), (0, np.inf, -1, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 2), (-1, np.inf, -1, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * (erf(1) + 1) ** 3), (1, np.inf, -1, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) ** 2 * erfc(1))), (1, np.inf, 1, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) * erfc(1) ** 2)), (1, np.inf, -1, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) * erfc(1) ** 2)), (-1, np.inf, 1, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) * erfc(1) ** 2)), (-1, np.inf, -1, np.inf, 1, np.inf, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) ** 2 * erfc(1))), (-1, np.inf, 1, np.inf, -1, np.inf, np.pi ** (3 / 2) / 8 * ((erf(1) + 1) ** 2 * erfc(1))), (-np.inf, np.inf, -np.inf, np.inf, -np.inf, np.inf, np.pi ** (3 / 2))])
def test_triple_integral_improper(self, x_lower, x_upper, y_lower, y_upper, z_lower, z_upper, expected):

    def f(x, y, z):
        return np.exp(-x ** 2 - y ** 2 - z ** 2)
    assert_quad(tplquad(f, x_lower, x_upper, y_lower, y_upper, z_lower, z_upper), expected, error_tolerance=6e-08)