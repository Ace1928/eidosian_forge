import math
import numpy as np
import pytest
from numpy.testing import assert_allclose, assert_array_equal
import scipy.fft as fftmodule
from skimage._shared.utils import _supported_float_type
from skimage.data import astronaut, coins
from skimage.filters import butterworth
from skimage.filters._fft_based import _get_nd_butterworth_filter
def test_butterworth_correctness_bw():
    small = coins()[180:190, 260:270]
    filtered = butterworth(small, cutoff_frequency_ratio=0.2)
    correct = np.array([[28.63019362, -17.69023786, 26.95346957, 20.57423019, -15.1933463, -28.05828136, -35.25135674, -25.70376951, -43.37121955, -16.87688457], [4.62077869, 36.5726672, 28.41926375, -22.86436829, -25.32375274, -19.94182623, -2.9666164, 6.62250413, 3.55910886, -33.15358921], [25.00377084, 34.2948942, -15.13862785, -15.34354183, -12.68722526, 12.82729905, 5.21622357, 11.41087761, 16.33690526, -50.39790969], [72.62331496, -14.7924709, -22.14868895, -7.47854864, 9.66784721, 24.37625693, 12.5479457, -1.38194367, 2.40079497, -26.61141413], [21.85962078, -56.73932031, -14.82425429, 4.10524297, -19.16561768, -48.19021687, 5.0258744, 28.82432166, 0.66992097, 9.8378842], [-54.93417679, -5.12037233, 19.2956981, 38.56431593, 27.95408908, -3.53103389, 23.75329532, -6.92615359, -8.50823024, 7.05743093], [-30.51016624, -9.99691211, -7.1080672, 23.67643315, 1.61919726, 12.94103905, -29.08141699, -11.56937511, 22.70988847, 32.04063285], [-7.51780937, -30.27899181, -2.57782655, -1.58947887, -2.13564576, -11.34039302, 1.59165041, 14.39173421, -14.15148821, -2.21664717], [14.81167298, -3.75274782, 18.41459894, 15.80334075, -19.7477109, -3.68619619, -2.9513036, -10.17325791, 18.32438702, 18.68003971], [-50.53430811, 12.14152989, 17.69341877, 9.1858496, 12.1470914, 1.45865179, 61.08961357, 29.76775029, -11.04603619, 24.18621404]])
    assert_allclose(filtered, correct)