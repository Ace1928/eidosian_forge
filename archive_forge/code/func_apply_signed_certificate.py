from __future__ import absolute_import, division, print_function
import binascii
import random
import re
from ansible.module_utils import six
from ansible_collections.netapp_eseries.santricity.plugins.module_utils.santricity import NetAppESeriesModule
from ansible.module_utils._text import to_native
from time import sleep
def apply_signed_certificate(self, public_cert, private_key):
    """Install authoritative signed server certificate whether csr is generated by storage system or not."""
    if private_key is None:
        headers, data = create_multipart_formdata([('file', 'signed_server_certificate', public_cert['certificate'])])
    else:
        headers, data = create_multipart_formdata([('file', 'signed_server_certificate', public_cert['certificate']), ('privateKey', 'private_key', private_key)])
    try:
        rc, resp = self.request(self.url_path_prefix + 'certificates/server%s&replaceMainServerCertificate=true' % self.url_path_suffix, method='POST', headers=headers, data=data)
    except Exception as error:
        self.module.fail_json(msg='Failed to upload signed server certificate! Array [%s]. Error [%s].' % (self.ssid, error))