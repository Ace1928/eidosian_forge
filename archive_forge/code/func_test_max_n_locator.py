import numpy as np
import pytest
from ...util.locator import MaxNLocator
@pytest.mark.parametrize('n, vmin, vmax, expected', [(1, 20, 100, [0, 80, 160]), (2, 20, 100, [0, 40, 80, 120]), (3, 20, 100, [0, 30, 60, 90, 120]), (4, 20, 100, [20, 40, 60, 80, 100]), (5, 20, 100, [20, 40, 60, 80, 100]), (6, 20, 100, [15, 30, 45, 60, 75, 90, 105]), (7, 20, 100, [15, 30, 45, 60, 75, 90, 105]), (8, 20, 100, [20, 30, 40, 50, 60, 70, 80, 90, 100]), (9, 20, 100, [20, 30, 40, 50, 60, 70, 80, 90, 100]), (10, 20, 100, [16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104]), (1, 0.0001, 0.001, [0, 0.001]), (2, 0.0001, 0.001, [0, 0.0005, 0.001]), (3, 0.0001, 0.001, [0, 0.0003, 0.0006, 0.0009, 0.0012]), (4, 0.0001, 0.001, [0, 0.00025, 0.0005, 0.00075, 0.001]), (5, 0.0001, 0.001, [0, 0.0002, 0.0004, 0.0006, 0.0008, 0.001]), (6, 0.0001, 0.001, [0, 0.00015, 0.0003, 0.00045, 0.0006, 0.00075, 0.0009, 0.00105]), (7, 0.0001, 0.001, [0, 0.00015, 0.0003, 0.00045, 0.0006, 0.00075, 0.0009, 0.00105]), (8, 0.0001, 0.001, [0, 0.00015, 0.0003, 0.00045, 0.0006, 0.00075, 0.0009, 0.00105]), (9, 0.0001, 0.001, [0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009, 0.001]), (10, 0.0001, 0.001, [0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009, 0.001]), (2, -1000000000000000.0, 1000000000000000.0, [-1000000000000000.0, 0, 1000000000000000.0]), (4, -1000000000000000.0, 1000000000000000.0, [-1000000000000000.0, -500000000000000.0, 0, 500000000000000.0, 1000000000000000.0]), (8, -1000000000000000.0, 1000000000000000.0, [-1000000000000000.0, -750000000000000.0, -500000000000000.0, -250000000000000.0, 0, 250000000000000.0, 500000000000000.0, 750000000000000.0, 1000000000000000.0]), (5, 0, 8.5e-51, [0, 2e-51, 4e-51, 6e-51, 8e-51, 1e-50]), (5, -8.5e-51, 0, [-1e-50, -8e-51, -6e-51, -4e-51, -2e-51, 0]), (5, 1.23, 1.23, [1.23] * 5)])
def test_max_n_locator(n, vmin, vmax, expected):
    locator = MaxNLocator(n)
    ticks = locator.tick_values(vmin, vmax)
    np.testing.assert_almost_equal(ticks, expected)
    ticks = locator.tick_values(vmax, vmin)
    np.testing.assert_almost_equal(ticks, expected)