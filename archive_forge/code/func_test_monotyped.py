import numpy as np
from io import StringIO
from numba import cuda, float32, float64, int32, intp
from numba.cuda.testing import unittest, CUDATestCase
from numba.cuda.testing import (skip_on_cudasim, skip_with_nvdisasm,
def test_monotyped(self):
    sig = (float32, int32)

    @cuda.jit(sig)
    def foo(x, y):
        pass
    file = StringIO()
    foo.inspect_types(file=file)
    typeanno = file.getvalue()
    self.assertIn('foo', typeanno)
    self.assertIn('(float32, int32)', typeanno)
    file.close()
    llvm = foo.inspect_llvm(sig)
    self.assertIn('foo', llvm)
    self.assertIn('cuda.kernel.wrapper', llvm)
    self.assertIn('define linkonce_odr i32', llvm)
    asm = foo.inspect_asm(sig)
    self.assertIn('foo', asm)
    self.assertIn('Generated by NVIDIA NVVM Compiler', asm)