import sys
import pytest
import numpy as np
from typing import NamedTuple
from numpy.testing import assert_allclose
from scipy.special import hyp2f1
from scipy.special._testutils import check_version, MissingModule
@pytest.mark.parametrize('hyp2f1_test_case', [pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=4.0013768449590685, c=4.078873014294075, z=-0.9473684210526316 + 0.5263157894736841j, expected=-0.0018093573941378783 + 0.003481887377423739j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=2.050308316530781, c=1.0651378143226575, z=-0.736842105263158 - 0.736842105263158j, expected=-0.00023401243818780545 - 1.7983496305603562e-05j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=8.077282662161238, c=4.078873014294075, z=-0.5263157894736843 - 0.9473684210526316j, expected=0.22359773002226846 - 0.24092487123993353j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=2.050308316530781, c=-15.963511401609862, z=-0.9473684210526316 - 0.5263157894736843j, expected=1.191573745740011 + 0.14347394589721466j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=4.0013768449590685, c=-15.963511401609862, z=-0.9473684210526316 - 0.5263157894736843j, expected=31.822620756901784 - 66.09094396747611j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=8.077282662161238, c=-7.93846038215665, z=-0.9473684210526316 + 0.5263157894736841j, expected=207.16750179245952 + 34.80478274924269j, rtol=5e-12)), pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=-7.949900487447654, c=8.031683612216888, z=-0.736842105263158 + 0.7368421052631575j, expected=-159.62429364277145 + 9.154224290644898j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=-1.92872979730171, c=16.056809865262608, z=-0.9473684210526316 + 0.5263157894736841j, expected=1.121122351247184 - 0.07170260470126685j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=-0.9629749245209605, c=16.056809865262608, z=-0.9473684210526316 + 0.5263157894736841j, expected=1.9040596681316053 - 0.4951799449960107j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=-1.92872979730171, c=-0.906685989801748, z=-0.9473684210526316 - 0.5263157894736843j, expected=-14.496623497780739 - 21.897524523299875j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=-3.9316537064827854, c=-3.9924618758357022, z=-0.5263157894736843 - 0.9473684210526316j, expected=36.33473466026878 + 253.88728442029577j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=-15.964218273004214, c=-0.906685989801748, z=-0.9473684210526316 + 0.5263157894736841j, expected=1505052.5653144997 - 50820766.81043443j, rtol=1e-14)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=4.0013768449590685, c=1.0651378143226575, z=-0.5263157894736843 + 0.9473684210526314j, expected=-127.79407519260877 - 28.69899444941112j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-1.9214641416286231, b=8.077282662161238, c=16.056809865262608, z=-0.9473684210526316 - 0.5263157894736843j, expected=2.0623331933754976 + 0.741234463565458j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=8.077282662161238, c=2.0397202577726152, z=-0.9473684210526316 + 0.5263157894736841j, expected=30.729193458862525 - 292.5700835046965j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=-1.9214641416286231, b=1.0561196186065624, c=-1.9631175993998025, z=-0.5263157894736843 - 0.9473684210526316j, expected=1.1285917906203495 - 0.735264575450189j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=1.0561196186065624, c=-3.9924618758357022, z=-0.736842105263158 + 0.7368421052631575j, expected=0.6356474446678052 - 0.02429663008952248j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-1.9214641416286231, b=16.088264119063613, c=-7.93846038215665, z=-0.736842105263158 + 0.7368421052631575j, expected=0.4718880510273174 + 0.655083067736377j, rtol=1e-11)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=-3.9316537064827854, c=16.056809865262608, z=-0.9473684210526316 + 0.5263157894736841j, expected=-0.14681550942352714 + 0.16092206364265146j, rtol=5e-11)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-15.964218273004214, c=1.0651378143226575, z=-0.5263157894736843 + 0.9473684210526314j, expected=-6.436835190526225 + 22.883156700606182j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-7.949900487447654, c=4.078873014294075, z=-0.9473684210526316 - 0.5263157894736843j, expected=-0.7505682955068583 - 1.1026583264249945j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=-3.9316537064827854, c=-7.93846038215665, z=-0.9473684210526316 - 0.5263157894736843j, expected=3.6247814989198166 + 2.596041360148318j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=-15.964218273004214, c=-1.9631175993998025, z=-0.5263157894736843 - 0.9473684210526316j, expected=-59537.65287927933 - 669074.4342539902j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=-15.964218273004214, c=-1.9631175993998025, z=-0.9473684210526316 - 0.5263157894736843j, expected=-433084.9970266166 + 431088.393918521j, rtol=5e-14))])
def test_region6(self, hyp2f1_test_case):
    """|z| > 1 but not in region 5."""
    a, b, c, z, expected, rtol = hyp2f1_test_case
    assert abs(z) > 1 and (not (1 < abs(z) < 1.1 and abs(1 - z) >= 0.9 and (z.real >= 0)))
    assert_allclose(hyp2f1(a, b, c, z), expected, rtol=rtol)