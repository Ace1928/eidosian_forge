import numpy
import numpy as np
import datetime
import pytest
from numpy.testing import (
from numpy.compat import pickle
def test_datetime_minmax(self):
    a = np.array('1999-03-12T13', dtype='M8[2m]')
    b = np.array('1999-03-12T12', dtype='M8[s]')
    assert_equal(np.minimum(a, b), b)
    assert_equal(np.minimum(a, b).dtype, np.dtype('M8[s]'))
    assert_equal(np.fmin(a, b), b)
    assert_equal(np.fmin(a, b).dtype, np.dtype('M8[s]'))
    assert_equal(np.maximum(a, b), a)
    assert_equal(np.maximum(a, b).dtype, np.dtype('M8[s]'))
    assert_equal(np.fmax(a, b), a)
    assert_equal(np.fmax(a, b).dtype, np.dtype('M8[s]'))
    assert_equal(np.minimum(a.view('i8'), b.view('i8')), a.view('i8'))
    a = np.array('1999-03-12T13', dtype='M8[2m]')
    dtnat = np.array('NaT', dtype='M8[h]')
    assert_equal(np.minimum(a, dtnat), dtnat)
    assert_equal(np.minimum(dtnat, a), dtnat)
    assert_equal(np.maximum(a, dtnat), dtnat)
    assert_equal(np.maximum(dtnat, a), dtnat)
    assert_equal(np.fmin(dtnat, a), a)
    assert_equal(np.fmin(a, dtnat), a)
    assert_equal(np.fmax(dtnat, a), a)
    assert_equal(np.fmax(a, dtnat), a)
    a = np.array(3, dtype='m8[h]')
    b = np.array(3 * 3600 - 3, dtype='m8[s]')
    assert_equal(np.minimum(a, b), b)
    assert_equal(np.minimum(a, b).dtype, np.dtype('m8[s]'))
    assert_equal(np.fmin(a, b), b)
    assert_equal(np.fmin(a, b).dtype, np.dtype('m8[s]'))
    assert_equal(np.maximum(a, b), a)
    assert_equal(np.maximum(a, b).dtype, np.dtype('m8[s]'))
    assert_equal(np.fmax(a, b), a)
    assert_equal(np.fmax(a, b).dtype, np.dtype('m8[s]'))
    assert_equal(np.minimum(a.view('i8'), b.view('i8')), a.view('i8'))
    a = np.array(3, dtype='m8[h]')
    b = np.array('1999-03-12T12', dtype='M8[s]')
    assert_raises(TypeError, np.minimum, a, b, casting='same_kind')
    assert_raises(TypeError, np.maximum, a, b, casting='same_kind')
    assert_raises(TypeError, np.fmin, a, b, casting='same_kind')
    assert_raises(TypeError, np.fmax, a, b, casting='same_kind')