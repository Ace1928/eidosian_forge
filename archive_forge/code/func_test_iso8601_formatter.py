from datetime import datetime
import pytest
from pandas._libs import tslib
from pandas import Timestamp
@pytest.mark.parametrize('date_str, timespec, exp', [('2023-01-01 00:00:00', 'auto', '2023-01-01T00:00:00'), ('2023-01-01 00:00:00', 'seconds', '2023-01-01T00:00:00'), ('2023-01-01 00:00:00', 'milliseconds', '2023-01-01T00:00:00.000'), ('2023-01-01 00:00:00', 'microseconds', '2023-01-01T00:00:00.000000'), ('2023-01-01 00:00:00', 'nanoseconds', '2023-01-01T00:00:00.000000000'), ('2023-01-01 00:00:00.001', 'auto', '2023-01-01T00:00:00.001000'), ('2023-01-01 00:00:00.001', 'seconds', '2023-01-01T00:00:00'), ('2023-01-01 00:00:00.001', 'milliseconds', '2023-01-01T00:00:00.001'), ('2023-01-01 00:00:00.001', 'microseconds', '2023-01-01T00:00:00.001000'), ('2023-01-01 00:00:00.001', 'nanoseconds', '2023-01-01T00:00:00.001000000'), ('2023-01-01 00:00:00.000001', 'auto', '2023-01-01T00:00:00.000001'), ('2023-01-01 00:00:00.000001', 'seconds', '2023-01-01T00:00:00'), ('2023-01-01 00:00:00.000001', 'milliseconds', '2023-01-01T00:00:00.000'), ('2023-01-01 00:00:00.000001', 'microseconds', '2023-01-01T00:00:00.000001'), ('2023-01-01 00:00:00.000001', 'nanoseconds', '2023-01-01T00:00:00.000001000'), ('2023-01-01 00:00:00.000000001', 'auto', '2023-01-01T00:00:00.000000001'), ('2023-01-01 00:00:00.000000001', 'seconds', '2023-01-01T00:00:00'), ('2023-01-01 00:00:00.000000001', 'milliseconds', '2023-01-01T00:00:00.000'), ('2023-01-01 00:00:00.000000001', 'microseconds', '2023-01-01T00:00:00.000000'), ('2023-01-01 00:00:00.000000001', 'nanoseconds', '2023-01-01T00:00:00.000000001'), ('2023-01-01 00:00:00.000001001', 'auto', '2023-01-01T00:00:00.000001001'), ('2023-01-01 00:00:00.000001001', 'seconds', '2023-01-01T00:00:00'), ('2023-01-01 00:00:00.000001001', 'milliseconds', '2023-01-01T00:00:00.000'), ('2023-01-01 00:00:00.000001001', 'microseconds', '2023-01-01T00:00:00.000001'), ('2023-01-01 00:00:00.000001001', 'nanoseconds', '2023-01-01T00:00:00.000001001')])
def test_iso8601_formatter(date_str: str, timespec: str, exp: str):
    ts = Timestamp(date_str)
    assert ts.isoformat(timespec=timespec) == exp