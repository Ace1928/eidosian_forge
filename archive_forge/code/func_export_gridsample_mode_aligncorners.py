import numpy as np
import onnx
from onnx.backend.test.case.base import Base
from onnx.backend.test.case.node import expect
@staticmethod
def export_gridsample_mode_aligncorners() -> None:
    X = np.array([[[[0.0, 1.0], [2.0, 3.0], [4.0, 5.0]]]], dtype=np.float32)
    Grid = np.array([[[[-1.0, -1.0], [-0.5, -0.5], [-0.2, -0.2], [0.0, 0.0]], [[0.0, 0.0], [-0.2, -0.2], [0.5, 0.5], [1.0, 1.0]]]], dtype=np.float32)
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='linear')
    Y_bilinear = np.array([[[[0.0, 0.5, 1.7, 2.5], [2.5, 1.7, 4.5, 1.25]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_bilinear], name='test_gridsample_bilinear')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='linear', align_corners=1)
    Y_align_corners = np.array([[[[0.0, 1.25, 2.0, 2.5], [2.5, 2.0, 3.75, 5.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_align_corners], name='test_gridsample_aligncorners_true')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='nearest')
    Y_nearest = np.array([[[[0.0, 0.0, 2.0, 2.0], [2.0, 2.0, 5.0, 0.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_nearest], name='test_gridsample_nearest')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='cubic')
    Y_bicubic = np.array([[[[-0.1406, 0.3828, 1.7556, 2.9688], [2.9688, 1.7556, 5.1445, 1.3906]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_bicubic], name='test_gridsample_bicubic')
    Grid = np.array([[[[-1.0, -0.8], [-0.6, -0.5], [-0.1, -0.2], [0.7, 0.0]], [[0.0, 0.4], [0.2, -0.2], [-0.3, 0.5], [-1.0, 1.0]]]], dtype=np.float32)
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='nearest', align_corners=0)
    Y_nearest = np.array([[[[0.0, 0.0, 2.0, 3.0], [4.0, 3.0, 4.0, 4.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_nearest], name='test_gridsample_nearest_align_corners_0_additional_1')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='nearest', align_corners=1)
    Y_nearest = np.array([[[[0.0, 0.0, 2.0, 3.0], [2.0, 3.0, 4.0, 4.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_nearest], name='test_gridsample_nearest_align_corners_1_additional_1')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='linear', align_corners=0)
    Y_bilinear = np.array([[[[0.0, 0.45, 1.8, 2.4], [3.7, 2.1, 3.7, 1.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_bilinear], name='test_gridsample_bilinear_align_corners_0_additional_1')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='linear', align_corners=1)
    Y_bilinear = np.array([[[[0.4, 1.2, 2.05, 2.85], [3.3, 2.2, 3.35, 4.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_bilinear], name='test_gridsample_bilinear_align_corners_1_additional_1')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='cubic', align_corners=0)
    Y_bicubic = np.array([[[[-0.17325, 0.284265, 1.923106, 2.568], [5.170375, 2.284414, 4.744844, 1.046875]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_bicubic], name='test_gridsample_bicubic_align_corners_0_additional_1')
    node = onnx.helper.make_node('GridSample', inputs=['X', 'Grid'], outputs=['Y'], mode='cubic', align_corners=1)
    Y_bicubic = np.array([[[[0.304001, 1.12875, 2.26627, 3.144844], [4.5315, 2.45536, 4.599819, 4.0]]]], dtype=np.float32)
    expect(node, inputs=[X, Grid], outputs=[Y_bicubic], name='test_gridsample_bicubic_align_corners_1_additional_1')