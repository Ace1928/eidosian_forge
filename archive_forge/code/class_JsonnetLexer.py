from pygments.lexer import include, RegexLexer, words
from pygments.token import Comment, Keyword, Name, Number, Operator, \
class JsonnetLexer(RegexLexer):
    """Lexer for Jsonnet source code."""
    name = 'Jsonnet'
    aliases = ['jsonnet']
    filenames = ['*.jsonnet', '*.libsonnet']
    url = 'https://jsonnet.org'
    tokens = {'_comments': [('(//|#).*\\n', Comment.Single), ('/\\*\\*([^/]|/(?!\\*))*\\*/', String.Doc), ('/\\*([^/]|/(?!\\*))*\\*/', Comment)], 'root': [include('_comments'), ("@'.*'", String), ('@".*"', String), ("'", String, 'singlestring'), ('"', String, 'doublestring'), ('\\|\\|\\|(.|\\n)*\\|\\|\\|', String), ('[+-]?[0-9]+(.[0-9])?', Number.Float), ('[!$~+\\-&|^=<>*/%]', Operator), ('\\{', Punctuation, 'object'), ('\\[', Punctuation, 'array'), ('local\\b', Keyword, 'local_name'), ('assert\\b', Keyword, 'assert'), (words(['assert', 'else', 'error', 'false', 'for', 'if', 'import', 'importstr', 'in', 'null', 'tailstrict', 'then', 'self', 'super', 'true'], suffix='\\b'), Keyword), ('\\s+', Whitespace), ('function(?=\\()', Keyword, 'function_params'), ('std\\.' + jsonnet_function_token, Name.Builtin, 'function_args'), (jsonnet_function_token, Name.Function, 'function_args'), (jsonnet_token, Name.Variable), ('[\\.()]', Punctuation)], 'singlestring': string_rules("'"), 'doublestring': string_rules('"'), 'array': [(',', Punctuation), ('\\]', Punctuation, '#pop'), include('root')], 'local_name': [(jsonnet_function_token, Name.Function, 'function_params'), (jsonnet_token, Name.Variable), ('\\s+', Whitespace), ('(?==)', Whitespace, ('#pop', 'local_value'))], 'local_value': [('=', Operator), (';', Punctuation, '#pop'), include('root')], 'assert': [(':', Punctuation), (';', Punctuation, '#pop'), include('root')], 'function_params': [(jsonnet_token, Name.Variable), ('\\(', Punctuation), ('\\)', Punctuation, '#pop'), (',', Punctuation), ('\\s+', Whitespace), ('=', Operator, 'function_param_default')], 'function_args': [('\\(', Punctuation), ('\\)', Punctuation, '#pop'), (',', Punctuation), ('\\s+', Whitespace), include('root')], 'object': [('\\s+', Whitespace), ('local\\b', Keyword, 'object_local_name'), ('assert\\b', Keyword, 'object_assert'), ('\\[', Operator, 'field_name_expr'), (f'(?={jsonnet_token})', Text, 'field_name'), ('\\}', Punctuation, '#pop'), ('"', Name.Variable, 'double_field_name'), ("'", Name.Variable, 'single_field_name'), include('_comments')], 'field_name': [(jsonnet_function_token, Name.Function, ('field_separator', 'function_params')), (jsonnet_token, Name.Variable, 'field_separator')], 'double_field_name': quoted_field_name('"'), 'single_field_name': quoted_field_name("'"), 'field_name_expr': [('\\]', Operator, 'field_separator'), include('root')], 'function_param_default': [('(?=[,\\)])', Whitespace, '#pop'), include('root')], 'field_separator': [('\\s+', Whitespace), ('\\+?::?:?', Punctuation, ('#pop', '#pop', 'field_value')), include('_comments')], 'field_value': [(',', Punctuation, '#pop'), ('\\}', Punctuation, '#pop:2'), include('root')], 'object_assert': [(':', Punctuation), (',', Punctuation, '#pop'), include('root')], 'object_local_name': [(jsonnet_token, Name.Variable, ('#pop', 'object_local_value')), ('\\s+', Whitespace)], 'object_local_value': [('=', Operator), (',', Punctuation, '#pop'), ('\\}', Punctuation, '#pop:2'), include('root')]}