import re
from functools import partial
from ovs.flow.flow import Flow, Section
from ovs.flow.kv import (
from ovs.flow.decoders import (
@staticmethod
def _field_decoders_args():
    """Generate the decoder arguments for the match fields."""
    return {'skb_priority': Mask32, 'skb_mark': Mask32, 'recirc_id': decode_int, 'dp_hash': Mask32, 'ct_state': decode_default, 'ct_zone': Mask16, 'ct_mark': Mask32, 'ct_label': Mask128, 'ct_tuple4': nested_kv_decoder(KVDecoders({'src': IPMask, 'dst': IPMask, 'proto': Mask8, 'tp_src': Mask16, 'tp_dst': Mask16})), 'ct_tuple6': nested_kv_decoder(KVDecoders({'src': IPMask, 'dst': IPMask, 'proto': Mask8, 'tcp_src': Mask16, 'tcp_dst': Mask16})), 'tunnel': nested_kv_decoder(KVDecoders({'tun_id': Mask64, 'src': IPMask, 'dst': IPMask, 'ipv6_src': IPMask, 'ipv6_dst': IPMask, 'tos': Mask8, 'ttl': Mask8, 'tp_src': Mask16, 'tp_dst': Mask16, 'erspan': nested_kv_decoder(KVDecoders({'ver': Mask8, 'idx': Mask32, 'sid': decode_int, 'dir': Mask8, 'hwid': Mask8})), 'vxlan': nested_kv_decoder(KVDecoders({'flags': decode_int, 'vni': decode_int, 'gbp': nested_kv_decoder(KVDecoders({'id': Mask16, 'flags': Mask8}))})), 'geneve': partial(decode_geneve, True), 'gtpu': nested_kv_decoder(KVDecoders({'flags': Mask8, 'msgtype': Mask8})), 'flags': decode_default})), 'in_port': decode_default, 'eth': nested_kv_decoder(KVDecoders({'src': EthMask, 'dst': EthMask})), 'vlan': nested_kv_decoder(KVDecoders({'vid': Mask16, 'pcp': Mask16, 'cfi': Mask16})), 'eth_type': Mask16, 'mpls': nested_kv_decoder(KVDecoders({'label': Mask32, 'tc': Mask32, 'ttl': Mask32, 'bos': Mask32})), 'ipv4': nested_kv_decoder(KVDecoders({'src': IPMask, 'dst': IPMask, 'proto': Mask8, 'tos': Mask8, 'ttl': Mask8, 'frag': decode_default})), 'ipv6': nested_kv_decoder(KVDecoders({'src': IPMask, 'dst': IPMask, 'label': decode_mask(20), 'proto': Mask8, 'tclass': Mask8, 'hlimit': Mask8, 'frag': decode_default})), 'tcp': nested_kv_decoder(KVDecoders({'src': Mask16, 'dst': Mask16})), 'tcp_flags': decode_default, 'udp': nested_kv_decoder(KVDecoders({'src': Mask16, 'dst': Mask16})), 'sctp': nested_kv_decoder(KVDecoders({'src': Mask16, 'dst': Mask16})), 'icmp': nested_kv_decoder(KVDecoders({'type': Mask8, 'code': Mask8})), 'icmpv6': nested_kv_decoder(KVDecoders({'type': Mask8, 'code': Mask8})), 'arp': nested_kv_decoder(KVDecoders({'sip': IPMask, 'tip': IPMask, 'op': Mask16, 'sha': EthMask, 'tha': EthMask})), 'nd': nested_kv_decoder(KVDecoders({'target': IPMask, 'sll': EthMask, 'tll': EthMask})), 'nd_ext': nested_kv_decoder(KVDecoders({'nd_reserved': Mask32, 'nd_options_type': Mask8})), 'packet_type': nested_kv_decoder(KVDecoders({'ns': Mask16, 'id': Mask16})), 'nsh': nested_kv_decoder(KVDecoders({'flags': Mask8, 'mdtype': Mask8, 'np': Mask8, 'spi': Mask32, 'si': Mask8, 'c1': Mask32, 'c2': Mask32, 'c3': Mask32, 'c4': Mask32}))}