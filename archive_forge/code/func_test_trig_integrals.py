import math
import pytest
from mpmath import *
def test_trig_integrals():
    mp.dps = 30
    assert si(mpf(1) / 1000000).ae('0.000000999999999999944444444444446111')
    assert ci(mpf(1) / 1000000).ae('-13.2382948930629912435014366276')
    assert si(10 ** 10).ae('1.5707963267075846569685111517747537')
    assert ci(10 ** 10).ae('-4.87506025174822653785729773959e-11')
    assert si(10 ** 100).ae(pi / 2)
    assert (ci(10 ** 100) * 10 ** 100).ae('-0.372376123661276688262086695553')
    assert si(-3) == -si(3)
    assert ci(-3).ae(ci(3) + pi * j)
    mp.dps = 15
    assert mp.ci(50).ae(-0.005628386324116306)
    assert mp.ci(50 + 2j).ae(-0.018378282946133067 + 0.07035280802368833j)
    assert mp.ci(20j).ae(12807826.332028294 + 1.5707963267949j)
    assert mp.ci(-2 + 20j).ae(-4050116.8568732934 + 12074761.882069899j)
    assert mp.ci(-50 + 2j).ae(-0.018378282946133067 + 3.071239845566105j)
    assert mp.ci(-50).ae(-0.005628386324116306 + 3.141592653589793j)
    assert mp.ci(-50 - 2j).ae(-0.018378282946133067 - 3.071239845566105j)
    assert mp.ci(-2 - 20j).ae(-4050116.8568732934 - 12074761.882069899j)
    assert mp.ci(-20j).ae(12807826.332028294 - 1.5707963267949j)
    assert mp.ci(50 - 2j).ae(-0.018378282946133067 - 0.07035280802368833j)
    assert mp.si(50).ae(1.551617072485936)
    assert mp.si(50 + 2j).ae(1.4978844142772285 - 0.017515007378437447j)
    assert mp.si(20j).ae(12807826.332028294j)
    assert mp.si(-2 + 20j).ae(-12074760.311273573 - 4050116.8568732934j)
    assert mp.si(-50 + 2j).ae(-1.4978844142772285 - 0.017515007378437447j)
    assert mp.si(-50).ae(-1.551617072485936)
    assert mp.si(-50 - 2j).ae(-1.4978844142772285 + 0.017515007378437447j)
    assert mp.si(-2 - 20j).ae(-12074760.311273573 + 4050116.8568732934j)
    assert mp.si(-20j).ae(-12807826.332028294j)
    assert mp.si(50 - 2j).ae(1.4978844142772285 + 0.017515007378437447j)
    assert mp.chi(50j).ae(-0.005628386324116306 + 1.5707963267948966j)
    assert mp.chi(-2 + 50j).ae(-0.018378282946133067 + 1.641149134818585j)
    assert mp.chi(-20).ae(12807826.332028294 + 3.1415926535898j)
    assert mp.chi(-20 - 2j).ae(-4050116.8568732934 + 12074757.16968092j)
    assert mp.chi(-2 - 50j).ae(-0.018378282946133067 - 1.641149134818585j)
    assert mp.chi(-50j).ae(-0.005628386324116306 - 1.5707963267948966j)
    assert mp.chi(2 - 50j).ae(-0.018378282946133067 - 1.5004435187712082j)
    assert mp.chi(20 - 2j).ae(-4050116.8568732934 - 12074760.311273573j)
    assert mp.chi(20).ae(12807826.332028294)
    assert mp.chi(2 + 50j).ae(-0.018378282946133067 + 1.5004435187712082j)
    assert mp.shi(50j).ae(1.551617072485936j)
    assert mp.shi(-2 + 50j).ae(0.017515007378437447 + 1.4978844142772285j)
    assert mp.shi(-20).ae(-12807826.332028294)
    assert mp.shi(-20 - 2j).ae(4050116.8568732934 - 12074760.311273573j)
    assert mp.shi(-2 - 50j).ae(0.017515007378437447 - 1.4978844142772285j)
    assert mp.shi(-50j).ae(-1.551617072485936j)
    assert mp.shi(2 - 50j).ae(-0.017515007378437447 - 1.4978844142772285j)
    assert mp.shi(20 - 2j).ae(-4050116.8568732934 - 12074760.311273573j)
    assert mp.shi(20).ae(12807826.332028294)
    assert mp.shi(2 + 50j).ae(-0.017515007378437447 + 1.4978844142772285j)

    def ae(x, y, tol=1e-12):
        return abs(x - y) <= abs(y) * tol
    assert fp.ci(fp.inf) == 0
    assert ae(fp.ci(fp.ninf), fp.pi * 1j)
    assert ae(fp.si(fp.inf), fp.pi / 2)
    assert ae(fp.si(fp.ninf), -fp.pi / 2)
    assert fp.si(0) == 0
    assert ae(fp.ci(50), -0.005628386324116306)
    assert ae(fp.ci(50 + 2j), -0.018378282946133067 + 0.07035280802368833j)
    assert ae(fp.ci(20j), 12807826.332028294 + 1.5707963267949j)
    assert ae(fp.ci(-2 + 20j), -4050116.8568732934 + 12074761.882069899j)
    assert ae(fp.ci(-50 + 2j), -0.018378282946133067 + 3.071239845566105j)
    assert ae(fp.ci(-50), -0.005628386324116306 + 3.141592653589793j)
    assert ae(fp.ci(-50 - 2j), -0.018378282946133067 - 3.071239845566105j)
    assert ae(fp.ci(-2 - 20j), -4050116.8568732934 - 12074761.882069899j)
    assert ae(fp.ci(-20j), 12807826.332028294 - 1.5707963267949j)
    assert ae(fp.ci(50 - 2j), -0.018378282946133067 - 0.07035280802368833j)
    assert ae(fp.si(50), 1.551617072485936)
    assert ae(fp.si(50 + 2j), 1.4978844142772285 - 0.017515007378437447j)
    assert ae(fp.si(20j), 12807826.332028294j)
    assert ae(fp.si(-2 + 20j), -12074760.311273573 - 4050116.8568732934j)
    assert ae(fp.si(-50 + 2j), -1.4978844142772285 - 0.017515007378437447j)
    assert ae(fp.si(-50), -1.551617072485936)
    assert ae(fp.si(-50 - 2j), -1.4978844142772285 + 0.017515007378437447j)
    assert ae(fp.si(-2 - 20j), -12074760.311273573 + 4050116.8568732934j)
    assert ae(fp.si(-20j), -12807826.332028294j)
    assert ae(fp.si(50 - 2j), 1.4978844142772285 + 0.017515007378437447j)
    assert ae(fp.chi(50j), -0.005628386324116306 + 1.5707963267948966j)
    assert ae(fp.chi(-2 + 50j), -0.018378282946133067 + 1.641149134818585j)
    assert ae(fp.chi(-20), 12807826.332028294 + 3.1415926535898j)
    assert ae(fp.chi(-20 - 2j), -4050116.8568732934 + 12074757.16968092j)
    assert ae(fp.chi(-2 - 50j), -0.018378282946133067 - 1.641149134818585j)
    assert ae(fp.chi(-50j), -0.005628386324116306 - 1.5707963267948966j)
    assert ae(fp.chi(2 - 50j), -0.018378282946133067 - 1.5004435187712082j)
    assert ae(fp.chi(20 - 2j), -4050116.8568732934 - 12074760.311273573j)
    assert ae(fp.chi(20), 12807826.332028294)
    assert ae(fp.chi(2 + 50j), -0.018378282946133067 + 1.5004435187712082j)
    assert ae(fp.shi(50j), 1.551617072485936j)
    assert ae(fp.shi(-2 + 50j), 0.017515007378437447 + 1.4978844142772285j)
    assert ae(fp.shi(-20), -12807826.332028294)
    assert ae(fp.shi(-20 - 2j), 4050116.8568732934 - 12074760.311273573j)
    assert ae(fp.shi(-2 - 50j), 0.017515007378437447 - 1.4978844142772285j)
    assert ae(fp.shi(-50j), -1.551617072485936j)
    assert ae(fp.shi(2 - 50j), -0.017515007378437447 - 1.4978844142772285j)
    assert ae(fp.shi(20 - 2j), -4050116.8568732934 - 12074760.311273573j)
    assert ae(fp.shi(20), 12807826.332028294)
    assert ae(fp.shi(2 + 50j), -0.017515007378437447 + 1.4978844142772285j)