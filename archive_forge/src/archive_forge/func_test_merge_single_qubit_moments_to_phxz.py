from typing import List
import cirq
def test_merge_single_qubit_moments_to_phxz():
    q = cirq.LineQubit.range(3)
    c_orig = cirq.Circuit(cirq.Moment(cirq.X.on_each(*q[:2])), cirq.Moment(cirq.T.on_each(*q[1:])), cirq.Moment(cirq.Y.on_each(*q[:2])), cirq.Moment(cirq.CZ(*q[:2]), cirq.Y(q[2])), cirq.Moment(cirq.X.on_each(*q[:2])), cirq.Moment(cirq.T.on_each(*q[1:])), cirq.Moment(cirq.Y.on_each(*q[:2])), cirq.Moment(cirq.Y(q[0]).with_tags('nocompile'), cirq.Z.on_each(*q[1:])), cirq.Moment(cirq.X.on_each(q[0])), cirq.Moment(cirq.measure(q[0], key='a')), cirq.Moment(cirq.X(q[1]).with_classical_controls('a')), cirq.Moment(cirq.X.on_each(q[1])))
    cirq.testing.assert_has_diagram(c_orig, "\n0: ───X───────Y───@───X───────Y───Y['nocompile']───X───M───────────\n                  │                                    ║\n1: ───X───T───Y───@───X───T───Y───Z────────────────────╫───X───X───\n                                                       ║   ║\n2: ───────T───────Y───────T───────Z────────────────────╫───╫───────\n                                                       ║   ║\na: ════════════════════════════════════════════════════@═══^═══════\n")
    context = cirq.TransformerContext(tags_to_ignore=('nocompile',))
    c_new = cirq.merge_single_qubit_moments_to_phxz(c_orig, context=context)
    cirq.testing.assert_has_diagram(c_new, "\n0: ───PhXZ(a=-0.5,x=0,z=-1)──────@───PhXZ(a=-0.5,x=0,z=-1)──────Y['nocompile']───X───M───────────\n                                 │                                                   ║\n1: ───PhXZ(a=-0.25,x=0,z=0.75)───@───PhXZ(a=-0.25,x=0,z=0.75)───Z────────────────────╫───X───X───\n                                                                                     ║   ║\n2: ───PhXZ(a=0.25,x=0,z=0.25)────Y───PhXZ(a=0.25,x=0,z=0.25)────Z────────────────────╫───╫───────\n                                                                                     ║   ║\na: ══════════════════════════════════════════════════════════════════════════════════@═══^═══════\n")