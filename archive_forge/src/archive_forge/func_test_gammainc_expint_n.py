import math
import pytest
from mpmath import *
def test_gammainc_expint_n():
    mp.dps = 15
    assert expint(-3, 3.5).ae(0.021456366563296695)
    assert expint(-2, 3.5).ae(0.01496663318307331)
    assert expint(-1, 3.5).ae(0.011092916359219041)
    assert expint(0, 3.5).ae(0.008627823834948143)
    assert expint(1, 3.5).ae(0.006970139857548393)
    assert expint(2, 3.5).ae(0.005801893920899126)
    assert expint(3, 3.5).ae(0.00494537734958578)
    assert expint(-3, -3.5).ae(-4.661817060407331)
    assert expint(-2, -3.5).ae(-5.599697415755552)
    assert expint(-1, -3.5).ae(-6.758255501773942)
    assert expint(0, -3.5).ae(-9.461557702483518)
    assert expint(1, -3.5).ae(-13.925353995152335 - 3.141592653589793j)
    assert expint(2, -3.5).ae(-15.62328702434086 - 10.995574287564276j)
    assert expint(3, -3.5).ae(-10.783026313250348 - 19.242255003237485j)
    assert expint(-3, 350).ae(2.8614825451252837e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(-2, 350).ae(2.8532837224504675e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(-1, 350).ae(2.8451316155828635e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(0, 350).ae(2.83702582750428e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(1, 350).ae(2.828965965670146e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(2, 350).ae(2.8209516419468503e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(3, 350).ae(2.8129824725501273e-155, abs_eps=0, rel_eps=8 * eps)
    assert expint(-3, -350).ae(-2.852879615404484e+149)
    assert expint(-2, -350).ae(-2.8610072121701263e+149)
    assert expint(-1, -350).ae(-2.8691813842677536e+149)
    assert expint(0, -350).ae(-2.8774025343659422e+149)
    u = expint(1, -350)
    assert u.ae(-2.8856710698020863e+149)
    assert u.imag.ae(-3.141592653589793)
    u = expint(2, -350)
    assert u.ae(-2.893987402650465e+149)
    assert u.imag.ae(-1099.5574287564277)
    u = expint(3, -350)
    assert u.ae(-2.9023519497915045e+149)
    assert u.imag.ae(-192422.55003237483)
    assert expint(-3, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(-2, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(-1, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(0, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(1, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(2, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(3, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert expint(-3, -350000000000000000000000).ae('-3.7805306852415755699e+152003068666138139677871')
    assert expint(-2, -350000000000000000000000).ae('-3.7805306852415755699e+152003068666138139677871')
    assert expint(-1, -350000000000000000000000).ae('-3.7805306852415755699e+152003068666138139677871')
    assert expint(0, -350000000000000000000000).ae('-3.7805306852415755699e+152003068666138139677871')
    u = expint(1, -350000000000000000000000)
    assert u.ae('-3.7805306852415755699e+152003068666138139677871')
    assert u.imag.ae(-3.141592653589793)
    u = expint(2, -350000000000000000000000)
    assert u.imag.ae(-1.0995574287564276e+24)
    assert u.ae('-3.7805306852415755699e+152003068666138139677871')
    u = expint(3, -350000000000000000000000)
    assert u.imag.ae(-1.9242255003237485e+47)
    assert u.ae('-3.7805306852415755699e+152003068666138139677871')
    assert gammainc(-3, 3.5).ae(0.00010020262545203707)
    assert gammainc(-2, 3.5).ae(0.00040370427343557394)
    assert gammainc(-1, 3.5).ae(0.0016576839773997502)
    assert gammainc(0, 3.5).ae(0.006970139857548393)
    assert gammainc(1, 3.5).ae(0.0301973834223185)
    assert gammainc(2, 3.5).ae(0.13588822540043324)
    assert gammainc(3, 3.5).ae(0.6416943977242682)
    assert gammainc(-3, -3.5).ae(0.035958329544675635 + 0.5235987755982989j)
    assert gammainc(-2, -3.5).ae(-0.8802470459796202 - 1.5707963267948966j)
    assert gammainc(-1, -3.5).ae(4.4637962926688175 + 3.141592653589793j)
    assert gammainc(0, -3.5).ae(-13.925353995152335 - 3.141592653589793j)
    assert gammainc(1, -3.5).ae(33.11545195869231)
    assert gammainc(2, -3.5).ae(-82.78862989673078)
    assert gammainc(3, -3.5).ae(240.0870267005193)
    assert gammainc(-3, 350).ae(6.542409511334036e-163, abs_eps=0, rel_eps=8 * eps)
    assert gammainc(-2, 350).ae(2.2963122224898997e-160, abs_eps=0, rel_eps=8 * eps)
    assert gammainc(-1, 350).ae(8.059861834133859e-158, abs_eps=0, rel_eps=8 * eps)
    assert gammainc(0, 350).ae(2.828965965670146e-155, abs_eps=0, rel_eps=8 * eps)
    assert gammainc(1, 350).ae(9.92959039626498e-153, abs_eps=0, rel_eps=8 * eps)
    assert gammainc(2, 350).ae(3.4852862290890077e-150, abs_eps=0, rel_eps=8 * eps)
    assert gammainc(3, 350).ae(1.223345396000638e-147, abs_eps=0, rel_eps=8 * eps)
    u = gammainc(-3, -350)
    assert u.ae(6.788956578384289e+141)
    assert u.imag.ae(0.5235987755982989)
    u = gammainc(-2, -350)
    assert u.ae(-2.3692668977889833e+144)
    assert u.imag.ae(-1.5707963267948966)
    u = gammainc(-1, -350)
    assert u.ae(8.268535436144186e+146)
    assert u.imag.ae(3.141592653589793)
    u = gammainc(0, -350)
    assert u.ae(-2.8856710698020863e+149)
    assert u.imag.ae(-3.141592653589793)
    u = gammainc(1, -350)
    assert u.ae(1.0070908870280797e+152)
    assert u.imag == 0
    u = gammainc(2, -350)
    assert u.ae(-3.5147471957279986e+154)
    assert u.imag == 0
    u = gammainc(3, -350)
    assert u.ae(1.2266568422179418e+157)
    assert u.imag == 0
    assert gammainc(-3, 350000000000000000000000).ae('5.0362468738874738859e-152003068666138139677990', abs_eps=0, rel_eps=8 * eps)
    assert gammainc(-2, 350000000000000000000000).ae('1.7626864058606158601e-152003068666138139677966', abs_eps=0, rel_eps=8 * eps)
    assert gammainc(-1, 350000000000000000000000).ae('6.1694024205121555102e-152003068666138139677943', abs_eps=0, rel_eps=8 * eps)
    assert gammainc(0, 350000000000000000000000).ae('2.1592908471792544286e-152003068666138139677919', abs_eps=0, rel_eps=8 * eps)
    assert gammainc(1, 350000000000000000000000).ae('7.5575179651273905e-152003068666138139677896', abs_eps=0, rel_eps=8 * eps)
    assert gammainc(2, 350000000000000000000000).ae('2.645131287794586675e-152003068666138139677872', abs_eps=0, rel_eps=8 * eps)
    assert gammainc(3, 350000000000000000000000).ae('9.2579595072810533625e-152003068666138139677849', abs_eps=0, rel_eps=8 * eps)
    u = gammainc(-3, -350000000000000000000000)
    assert u.ae('8.8175642804468234866e+152003068666138139677800')
    assert u.imag.ae(0.5235987755982989)
    u = gammainc(-2, -350000000000000000000000)
    assert u.ae('-3.0861474981563882203e+152003068666138139677824')
    assert u.imag.ae(-1.5707963267948966)
    u = gammainc(-1, -350000000000000000000000)
    assert u.ae('1.0801516243547358771e+152003068666138139677848')
    assert u.imag.ae(3.141592653589793)
    u = gammainc(0, -350000000000000000000000)
    assert u.ae('-3.7805306852415755699e+152003068666138139677871')
    assert u.imag.ae(-3.141592653589793)
    assert gammainc(1, -350000000000000000000000).ae('1.3231857398345514495e+152003068666138139677895')
    assert gammainc(2, -350000000000000000000000).ae('-4.6311500894209300731e+152003068666138139677918')
    assert gammainc(3, -350000000000000000000000).ae('1.6209025312973255256e+152003068666138139677942')