from Bio.Application import _Option, AbstractCommandline, _Switch
class _NcbiblastCommandline(_NcbibaseblastCommandline):
    """Base Commandline object for (new) NCBI BLAST+ wrappers (PRIVATE).

    This is provided for subclassing, it deals with shared options
    common to all the BLAST tools (blastn, rpsblast, rpsblast, etc).
    """

    def __init__(self, cmd=None, **kwargs):
        assert cmd is not None
        extra_parameters = [_Option(['-query', 'query'], 'The sequence to search with.', filename=True, equate=False), _Option(['-query_loc', 'query_loc'], 'Location on the query sequence (Format: start-stop).', equate=False), _Option(['-db', 'db'], 'The database to BLAST against.', equate=False), _Option(['-evalue', 'evalue'], 'Expectation value cutoff.', equate=False), _Option(['-word_size', 'word_size'], 'Word size for wordfinder algorithm.\n\nInteger. Minimum 2.', equate=False), _Option(['-soft_masking', 'soft_masking'], 'Apply filtering locations as soft masks (Boolean, Default = true).', equate=False), _Switch(['-lcase_masking', 'lcase_masking'], 'Use lower case filtering in query and subject sequence(s)?'), _Option(['-gilist', 'gilist'], "Restrict search of database to list of GI's.\n\nIncompatible with: negative_gilist, seqidlist, negative_seqidlist, remote, subject, subject_loc", filename=True, equate=False), _Option(['-negative_gilist', 'negative_gilist'], 'Restrict search of database to everything except the listed GIs.\n\nIncompatible with: gilist, seqidlist, remote, subject, subject_loc', filename=True, equate=False), _Option(['-seqidlist', 'seqidlist'], "Restrict search of database to list of SeqID's.\n\nIncompatible with: gilist, negative_gilist, remote, subject, subject_loc", filename=True, equate=False), _Option(['-negative_seqidlist', 'negative_seqidlist'], "Restrict search of database to everything except listed SeqID's.\n\nIncompatible with: gilist, seqidlist, remote, subject, subject_loc", filename=True, equate=False), _Option(['-entrez_query', 'entrez_query'], 'Restrict search with the given Entrez query (requires remote).', equate=False), _Option(['-qcov_hsp_perc', 'qcov_hsp_perc'], 'Percent query coverage per hsp (float, 0 to 100).\n\nAdded in BLAST+ 2.2.30.', equate=False), _Option(['-max_target_seqs', 'max_target_seqs'], 'Maximum number of aligned sequences to keep (integer, at least one).', equate=False), _Option(['-dbsize', 'dbsize'], 'Effective length of the database (integer).', equate=False), _Option(['-searchsp', 'searchsp'], 'Effective length of the search space (integer).', equate=False), _Option(['-max_hsps_per_subject', 'max_hsps_per_subject'], 'Override max number of HSPs per subject saved for ungapped searches (integer).', equate=False), _Option(['-max_hsps', 'max_hsps'], 'Set max number of HSPs saved per subject sequence\n\nDdefault 0 means no limit.', equate=False), _Switch(['-sum_statistics', 'sum_statistics'], 'Use sum statistics.'), _Option(['-sum_stats', 'sum_stats'], 'Use sum statistics (boolean).\n\nAdded in BLAST+ 2.2.30.', equate=False), _Option(['-xdrop_ungap', 'xdrop_ungap'], 'X-dropoff value (in bits) for ungapped extensions (float).', equate=False), _Option(['-xdrop_gap', 'xdrop_gap'], 'X-dropoff value (in bits) for preliminary gapped extensions (float).', equate=False), _Option(['-xdrop_gap_final', 'xdrop_gap_final'], 'X-dropoff value (in bits) for final gapped alignment (float).', equate=False), _Option(['-window_size', 'window_size'], 'Multiple hits window size, use 0 to specify 1-hit algorithm (integer).', equate=False), _Option(['-import_search_strategy', 'import_search_strategy'], 'Search strategy to use.\n\nIncompatible with: export_search_strategy', filename=True, equate=False), _Option(['-export_search_strategy', 'export_search_strategy'], 'File name to record the search strategy used.\n\nIncompatible with: import_search_strategy', filename=True, equate=False), _Option(['-num_threads', 'num_threads'], 'Number of threads to use in the BLAST search.\n\nInteger, at least one. Default is one. Incompatible with: remote', equate=False), _Switch(['-remote', 'remote'], 'Execute search remotely?\n\nIncompatible with: gilist, negative_gilist, subject_loc, num_threads, ...')]
        try:
            self.parameters = extra_parameters + self.parameters
        except AttributeError:
            self.parameters = extra_parameters
        _NcbibaseblastCommandline.__init__(self, cmd, **kwargs)

    def _validate(self):
        incompatibles = {'remote': ['gilist', 'negative_gilist', 'num_threads'], 'import_search_strategy': ['export_search_strategy'], 'gilist': ['negative_gilist'], 'seqidlist': ['gilist', 'negative_gilist', 'remote']}
        self._validate_incompatibilities(incompatibles)
        if self.entrez_query and (not self.remote):
            raise ValueError('Option entrez_query requires remote option.')
        AbstractCommandline._validate(self)