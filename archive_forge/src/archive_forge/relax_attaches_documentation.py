from math import sqrt
import numpy as np
 The method called by the optimizer in each step. 