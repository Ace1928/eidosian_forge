from statsmodels.compat.pandas import (
from datetime import datetime
import numpy as np
from numpy import array, column_stack
from numpy.testing import (
from pandas import DataFrame, concat, date_range
from statsmodels.datasets import macrodata
from statsmodels.tsa.filters._utils import pandas_wrapper
from statsmodels.tsa.filters.bk_filter import bkfilter
from statsmodels.tsa.filters.cf_filter import cffilter
from statsmodels.tsa.filters.filtertools import (
from statsmodels.tsa.filters.hp_filter import hpfilter
def test_bking2d():
    bking_results = array([[7.320813, -0.0374475], [2.886914, -0.0430094], [-6.818976, -0.053456], [-13.49436, -0.0620739], [-13.27936, -0.0626929], [-9.405913, -0.0603022], [-5.691091, -0.0630016], [-5.133076, -0.0832268], [-7.273468, -0.1186448], [-9.243364, -0.1619868], [-8.482916, -0.2116604], [-4.447764, -0.2670747], [2.406559, -0.3209931], [10.68433, -0.3583075], [19.46414, -0.3626742], [28.09749, -0.3294618], [34.11066, -0.2773388], [33.48468, -0.2436127], [24.64598, -0.2605531], [9.952399, -0.3305166], [-4.265528, -0.4275561], [-12.59471, -0.5076068], [-13.46714, -0.537573], [-9.049501, -0.5205845], [-3.011248, -0.481673], [0.5655082, -0.4403994], [2.897976, -0.4039957], [7.406077, -0.3537394], [14.67959, -0.2687359], [18.651, -0.1459743], [13.05891, 0.0014926], [-2.945415, 0.1424277], [-24.08659, 0.2451936], [-41.86147, 0.288541], [-48.68383, 0.2727282], [-43.32689, 0.1959127], [-31.66654, 0.0644874], [-20.38356, -0.1158372], [-13.76411, -0.3518627], [-9.978693, -0.6557535], [-3.7704, -1.003754], [10.27108, -1.341632], [31.02847, -1.614486], [51.87613, -1.779089], [66.93117, -1.807459], [73.51951, -1.679688], [73.4053, -1.401012], [69.17468, -0.9954996], [59.8543, -0.511261], [38.23899, -0.0146745], [-0.2604809, 0.4261311], [-49.0107, 0.7452514], [-91.1128, 0.8879492], [-112.1574, 0.8282748], [-108.3227, 0.5851508], [-86.51453, 0.2351699], [-59.91258, -0.1208998], [-40.01185, -0.4297895], [-29.70265, -0.6821963], [-22.76396, -0.9234254], [-13.08037, -1.217539], [1.913622, -1.57367], [20.44045, -1.927008], [37.32873, -2.229565], [46.79802, -2.463154], [51.95937, -2.614697], [59.67393, -2.681357], [70.50803, -2.609654], [81.27311, -2.301618], [83.53191, -1.720974], [67.72536, -0.9837123], [33.78039, -0.2261613], [-6.509092, 0.4546985], [-37.31579, 1.005751], [-46.05207, 1.457224], [-29.81496, 1.870815], [1.416417, 2.263313], [28.31503, 2.599906], [32.90134, 2.812282], [8.949259, 2.83358], [-35.41895, 2.632667], [-84.65775, 2.201077], [-124.4288, 1.598951], [-144.6036, 0.9504762], [-140.2204, 0.4187932], [-109.2624, 0.1646726], [-53.6901, 0.2034265], [15.07415, 0.398165], [74.44268, 0.5427476], [104.0403, 0.5454975], [101.0725, 0.4723354], [76.58291, 0.4626823], [49.27925, 0.5840143], [36.15751, 0.7187981], [36.48799, 0.6058422], [37.60897, 0.1221227], [27.75998, -0.5891272], [4.216643, -1.249841], [-23.20579, -1.594972], [-39.33292, -1.545968], [-36.6134, -1.275494], [-20.90161, -1.035783], [-4.143123, -0.9971732], [5.48432, -1.154264], [9.270075, -1.29987], [13.69573, -1.240559], [22.16675, -0.9662656], [33.01987, -0.6420301], [41.93186, -0.4698712], [47.12222, -0.4527797], [48.62164, -0.4407153], [47.30701, -0.2416076], [40.20537, 0.2317583], [22.37898, 0.8710276], [-7.133002, 1.426177], [-43.3339, 1.652785], [-78.51229, 1.488021], [-101.3684, 1.072096], [-105.2179, 0.6496446], [-90.97147, 0.4193682], [-68.30824, 0.41847], [-48.10113, 0.5253419], [-35.60709, 0.595076], [-31.15775, 0.5509905], [-31.82346, 0.3755519], [-32.49278, 0.1297979], [-28.22499, -0.0916165], [-14.42852, -0.2531037], [10.1827, -0.3220784], [36.64189, -0.2660561], [49.43468, -0.1358522], [38.75517, -0.0279508], [6.447761, 0.0168735], [-33.15883, 0.0315687], [-62.60446, 0.0819507], [-72.87829, 0.2274033], [-66.54629, 0.4641401], [-52.61205, 0.7211093], [-38.06676, 0.907773], [-26.19963, 0.9387103], [-16.51492, 0.7940786], [-7.007577, 0.5026631], [0.6125674, 0.1224996], [7.866972, -0.2714422], [14.8123, -0.6273921], [22.52388, -0.9124271], [30.65265, -1.108861], [39.47801, -1.199206], [49.05027, -1.19908], [59.02925, -1.139046], [72.88999, -0.9775021], [95.08865, -0.6592603], [125.8983, -0.1609712], [154.4283, 0.4796201], [160.7638, 1.100565], [130.6092, 1.447148], [67.84406, 1.359608], [-7.070272, 0.8931825], [-68.08128, 0.2619787], [-99.39944, -0.252208], [-104.911, -0.4703874], [-100.2372, -0.4430657], [-98.11596, -0.390683], [-104.2051, -0.5647846], [-114.0125, -0.9397582], [-113.3475, -1.341633], [-92.98669, -1.567337], [-51.91707, -1.504943], [-0.7313812, -1.30576], [43.22938, -1.17151], [64.62762, -1.136151], [64.07226, -1.050555], [59.35707, -0.7308369], [67.06026, -0.1766731], [91.87247, 0.3898467], [124.4591, 0.8135461], [151.2402, 0.9644226], [163.0648, 0.6865934], [154.6432, 0.0115685]])
    mdata = macrodata.load_pandas()
    X = mdata.data[['realinv', 'cpi']].values.astype(float)
    Y = bkfilter(X, 6, 32, 12)
    assert_almost_equal(Y, bking_results, 4)