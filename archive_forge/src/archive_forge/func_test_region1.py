import sys
import pytest
import numpy as np
from typing import NamedTuple
from numpy.testing import assert_allclose
from scipy.special import hyp2f1
from scipy.special._testutils import check_version, MissingModule
@pytest.mark.parametrize('hyp2f1_test_case', [pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-0.9629749245209605, c=-15.963511401609862, z=0.10526315789473673 - 0.3157894736842106j, expected=0.9941449585778349 + 0.01756335047931358j, rtol=1e-14)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=-0.9629749245209605, c=-15.963511401609862, z=0.5263157894736841 + 0.5263157894736841j, expected=1.0388722293372104 - 0.09549450380041416j, rtol=5e-11)), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=1.0561196186065624, c=-7.93846038215665, z=0.10526315789473673 + 0.7368421052631575j, expected=2.1948378809826434 + 24.934157235172222j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=16.088264119063613, c=8.031683612216888, z=0.3157894736842106 - 0.736842105263158j, expected=-0.4075277891264672 - 0.06819344579666956j, rtol=2e-12)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=2.050308316530781, c=8.031683612216888, z=0.7368421052631575 - 0.10526315789473695j, expected=2.833535530740603 - 0.6925373701408158j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=2.050308316530781, c=4.078873014294075, z=0.10526315789473673 - 0.3157894736842106j, expected=1.005347176329683 - 0.3580736009337313j, rtol=5e-16)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-0.9629749245209605, c=-15.963511401609862, z=0.3157894736842106 - 0.5263157894736843j, expected=0.9824353641135369 + 0.029271018868990268j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-0.9629749245209605, c=-159.6351140160986, z=0.3157894736842106 - 0.5263157894736843j, expected=0.9982436200365834 + 0.002927268199671111j, rtol=1e-07), marks=pytest.mark.xfail(reason='Poor convergence.')), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=16.088264119063613, c=8.031683612216888, z=0.5263157894736841 - 0.5263157894736843j, expected=-0.6906825165778091 + 0.8176575137504892j, rtol=5e-13))])
def test_region1(self, hyp2f1_test_case):
    """|z| < 0.9 and real(z) >= 0."""
    a, b, c, z, expected, rtol = hyp2f1_test_case
    assert abs(z) < 0.9 and z.real >= 0
    assert_allclose(hyp2f1(a, b, c, z), expected, rtol=rtol)