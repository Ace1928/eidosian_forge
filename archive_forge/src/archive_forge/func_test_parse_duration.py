import unittest
import aniso8601
from aniso8601.duration import (
from aniso8601.exceptions import ISOFormatError
from aniso8601.resolution import DurationResolution
from aniso8601.tests.compat import mock
def test_parse_duration(self):
    testtuples = (('P1Y2M3DT4H54M6S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('P1Y2M3DT4H54M6,5S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': '6.5'}), ('P1Y2M3DT4H54M6.5S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': '6.5'}), ('P1YT4H', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': None}), ('P1YT54M', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '54', 'TnS': None}), ('P1YT6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': None, 'TnS': '6'}), ('P1YT4H54M', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': None}), ('P1YT4H6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': '6'}), ('P1YT54M6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '54', 'TnS': '6'}), ('P1YT4H54M6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('P2MT4H', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': None}), ('P2MT54M', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '54', 'TnS': None}), ('P2MT6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': None, 'TnS': '6'}), ('P2MT4H54M', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': None}), ('P2MT4H6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': '6'}), ('P2MT54M6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '54', 'TnS': '6'}), ('P2MT4H54M6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('P3DT4H', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': None, 'TnS': None}), ('P3DT54M', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': '54', 'TnS': None}), ('P3DT6S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': None, 'TnS': '6'}), ('P3DT4H54M', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': None}), ('P3DT4H6S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': None, 'TnS': '6'}), ('P3DT54M6S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': '54', 'TnS': '6'}), ('P3DT4H54M6S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('P1Y2MT4H', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': None}), ('P1Y2MT54M', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '54', 'TnS': None}), ('P1Y2MT6S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': None, 'TnS': '6'}), ('P1Y2MT4H54M', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': None}), ('P1Y2MT4H6S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': '6'}), ('P1Y2MT54M6S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '54', 'TnS': '6'}), ('P1Y2MT4H54M6S', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('P1Y3DT4H', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': None, 'TnS': None}), ('P1Y3DT54M', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': '54', 'TnS': None}), ('P1Y3DT6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': None, 'TnS': '6'}), ('P1Y3DT4H54M', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': None}), ('P1Y3DT4H6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': None, 'TnS': '6'}), ('P1Y3DT54M6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': '54', 'TnS': '6'}), ('P1Y3DT4H54M6S', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('P2M3DT4H', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': None, 'TnS': None}), ('P2M3DT54M', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': '54', 'TnS': None}), ('P2M3DT6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': None, 'TnS': '6'}), ('P2M3DT4H54M', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': None}), ('P2M3DT4H6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': None, 'TnS': '6'}), ('P2M3DT54M6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': None, 'TnM': '54', 'TnS': '6'}), ('P2M3DT4H54M6S', {'PnY': None, 'PnM': '2', 'PnW': None, 'PnD': '3', 'TnH': '4', 'TnM': '54', 'TnS': '6'}), ('PT4H54M6,5S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': '6.5'}), ('PT4H54M6.5S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': '54', 'TnS': '6.5'}), ('PT4H', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '4', 'TnM': None, 'TnS': None}), ('PT5M', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '5', 'TnS': None}), ('PT6S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': None, 'TnS': '6'}), ('PT1H2M', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '1', 'TnM': '2', 'TnS': None}), ('PT3H4S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': '3', 'TnM': None, 'TnS': '4'}), ('PT5M6S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': '5', 'TnS': '6'}), ('PT0.0000001S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': None, 'TnS': '0.0000001'}), ('PT2.0000048S', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': None, 'TnH': None, 'TnM': None, 'TnS': '2.0000048'}), ('P1Y', {'PnY': '1', 'PnM': None, 'PnW': None, 'PnD': None}), ('P1,5Y', {'PnY': '1.5', 'PnM': None, 'PnW': None, 'PnD': None}), ('P1.5Y', {'PnY': '1.5', 'PnM': None, 'PnW': None, 'PnD': None}), ('P1M', {'PnY': None, 'PnM': '1', 'PnW': None, 'PnD': None}), ('P1,5M', {'PnY': None, 'PnM': '1.5', 'PnW': None, 'PnD': None}), ('P1.5M', {'PnY': None, 'PnM': '1.5', 'PnW': None, 'PnD': None}), ('P1W', {'PnY': None, 'PnM': None, 'PnW': '1', 'PnD': None}), ('P1,5W', {'PnY': None, 'PnM': None, 'PnW': '1.5', 'PnD': None}), ('P1.5W', {'PnY': None, 'PnM': None, 'PnW': '1.5', 'PnD': None}), ('P1D', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '1'}), ('P1,5D', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '1.5'}), ('P1.5D', {'PnY': None, 'PnM': None, 'PnW': None, 'PnD': '1.5'}), ('P1Y2M3D', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': '3'}), ('P1Y2M3,5D', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': '3.5'}), ('P1Y2M3.5D', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': '3.5'}), ('P1Y2M', {'PnY': '1', 'PnM': '2', 'PnW': None, 'PnD': None}), ('P0003-06-04T12:30:05', {'PnY': '0003', 'PnM': '06', 'PnD': '04', 'TnH': '12', 'TnM': '30', 'TnS': '05'}), ('P0003-06-04T12:30:05.5', {'PnY': '0003', 'PnM': '06', 'PnD': '04', 'TnH': '12', 'TnM': '30', 'TnS': '05.5'}), ('P0001-02-03T14:43:59.9999997', {'PnY': '0001', 'PnM': '02', 'PnD': '03', 'TnH': '14', 'TnM': '43', 'TnS': '59.9999997'}))
    for testtuple in testtuples:
        with mock.patch.object(aniso8601.duration.PythonTimeBuilder, 'build_duration') as mockBuildDuration:
            mockBuildDuration.return_value = testtuple[1]
            result = parse_duration(testtuple[0])
            self.assertEqual(result, testtuple[1])
            mockBuildDuration.assert_called_once_with(**testtuple[1])