from pynvml.nvml import *
import datetime
import collections
import time
from threading import Thread
@staticmethod
def __xmlGetEcc(handle, filter):
    ecc = ''
    includeEcc = False
    if NVSMI_ALL in filter or NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM in filter or NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE in filter or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_SRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_CBU in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TOTAL in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_DEV_MEM in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_REGFILE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L1CACHE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L2CACHE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TEXTURE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_DRAM in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_SRAM in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_CBU in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TOTAL in filter):
        ecc += '      <volatile>\n'
        ecc += nvidia_smi.__toString(nvidia_smi.__xmlGetEccByCounter(handle, NVML_VOLATILE_ECC, filter))
        ecc += '      </volatile>\n'
        includeEcc = True
    if NVSMI_ALL in filter or NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM in filter or NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE in filter or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_SRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_CBU in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_DEV_MEM in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_REGFILE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L1CACHE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L2CACHE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TEXTURE in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_DRAM in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_SRAM in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_CBU in filter) or (NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TOTAL in filter):
        ecc += '      <aggregate>\n'
        ecc += nvidia_smi.__toString(nvidia_smi.__xmlGetEccByCounter(handle, NVML_AGGREGATE_ECC, filter))
        ecc += '      </aggregate>\n'
        includeEcc = True
    return (ecc if len(ecc) > 0 else None, includeEcc)