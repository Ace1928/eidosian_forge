from __future__ import absolute_import
import os
import os.path
import re
import codecs
import textwrap
from datetime import datetime
from functools import partial
from collections import defaultdict
from xml.sax.saxutils import escape as html_escape
from . import Version
from .Code import CCodeWriter
from .. import Utils
def _save_annotation_header(self, c_file, source_filename, coverage_timestamp=None):
    coverage_info = ''
    if coverage_timestamp:
        coverage_info = u' with coverage data from {timestamp}'.format(timestamp=datetime.fromtimestamp(int(coverage_timestamp) // 1000))
    outlist = [textwrap.dedent(u'            <!DOCTYPE html>\n            <!-- Generated by Cython {watermark} -->\n            <html>\n            <head>\n                <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\n                <title>Cython: {filename}</title>\n                <style type="text/css">\n                {css}\n                </style>\n            </head>\n            <body class="cython">\n            <p><span style="border-bottom: solid 1px grey;">Generated by Cython {watermark}</span>{more_info}</p>\n            <p>\n                <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />\n                Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.\n            </p>\n            ').format(css=self._css(), watermark=Version.watermark, filename=os.path.basename(source_filename) if source_filename else '', more_info=coverage_info)]
    if c_file:
        outlist.append(u'<p>Raw output: <a href="%s">%s</a></p>\n' % (c_file, c_file))
    return outlist