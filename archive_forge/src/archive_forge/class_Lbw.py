import os
import numpy as np
import pandas as pd
from statsmodels.api import add_constant
from statsmodels.genmod.tests.results import glm_test_resids
class Lbw:
    """
    The LBW data can be found here

    https://www.stata-press.com/data/r9/rmain.html
    """

    def __init__(self):
        filename = os.path.join(os.path.dirname(os.path.abspath(__file__)), 'stata_lbw_glm.csv')
        data = pd.read_csv(filename)
        dummies = pd.get_dummies(data.race, prefix='race', drop_first=False, dtype=float)
        data = pd.concat([data, dummies], axis=1)
        self.endog = data.low
        design = data[['age', 'lwt', 'race_black', 'race_other', 'smoke', 'ptl', 'ht', 'ui']]
        self.exog = add_constant(design, prepend=False)
        self.params = (-0.02710031, -0.01515082, 1.26264728, 0.86207916, 0.92334482, 0.54183656, 1.8325178, 0.75851348, 0.46122388)
        self.bse = (0.036449917, 0.006925765, 0.526405169, 0.439146744, 0.400820976, 0.346246857, 0.691623875, 0.459373871, 1.204574885)
        self.aic_R = 219.447991133
        self.aic_Stata = 1.161100482182551
        self.deviance = 201.4479911325021
        self.scale = 1
        self.llf = -100.7239955662511
        self.chi2 = 25.65329337867037
        self.null_deviance = 234.671996193219
        self.bic_Stata = -742.0664715782335
        self.df_resid = 180
        self.df_model = 8
        self.df_null = 188
        self.pearson_chi2 = 182.023342493558
        self.resids = glm_test_resids.lbw_resids
        self.fittedvalues = np.array([0.31217507, 0.12793027, 0.32119762, 0.48442686, 0.50853393, 0.24517662, 0.12755193, 0.33226988, 0.22013309, 0.26268069, 0.34729955, 0.18782188, 0.75404181, 0.54723527, 0.35016393, 0.35016393, 0.45824406, 0.25336683, 0.43087357, 0.23284101, 0.20146616, 0.24315597, 0.02725586, 0.22207692, 0.39800383, 0.05584178, 0.28403447, 0.06931188, 0.35371946, 0.3896279, 0.3896279, 0.47812002, 0.60043853, 0.07144772, 0.29995988, 0.17910031, 0.22773411, 0.22691015, 0.06221253, 0.2384528, 0.32633864, 0.05131047, 0.2954536, 0.07364416, 0.57241299, 0.57241299, 0.08272435, 0.23298882, 0.12658158, 0.58967487, 0.46989562, 0.22455631, 0.2348285, 0.29571887, 0.28212464, 0.31499013, 0.68340511, 0.14090647, 0.31448425, 0.28082972, 0.28082972, 0.24918728, 0.27018297, 0.08175784, 0.64808999, 0.38252574, 0.25550797, 0.09113411, 0.40736693, 0.32644055, 0.54367425, 0.29606968, 0.47028421, 0.39972155, 0.25079125, 0.09678472, 0.08807264, 0.27467837, 0.5675742, 0.045619, 0.10719293, 0.04826292, 0.23934092, 0.24179618, 0.23802197, 0.49196179, 0.31379451, 0.10605469, 0.04047396, 0.11620849, 0.09937016, 0.21822964, 0.29770265, 0.83912829, 0.25079125, 0.08548557, 0.06550308, 0.2046457, 0.2046457, 0.08110349, 0.13519643, 0.47862055, 0.38891913, 0.1383964, 0.26176764, 0.31594589, 0.11418612, 0.06324112, 0.28468594, 0.21663702, 0.03827107, 0.27237604, 0.20246694, 0.19042999, 0.15019447, 0.18759474, 0.12308435, 0.19700616, 0.11564002, 0.36595033, 0.07765727, 0.14119063, 0.13584627, 0.11012759, 0.10102472, 0.10002166, 0.07439288, 0.27919958, 0.12491598, 0.06774594, 0.72513764, 0.17714986, 0.67373352, 0.80679436, 0.52908941, 0.15695938, 0.49722003, 0.41970014, 0.62375224, 0.53695622, 0.25474238, 0.79135707, 0.2503871, 0.25352337, 0.33474211, 0.19308929, 0.24658944, 0.25495092, 0.30867144, 0.41240259, 0.59412526, 0.16811226, 0.48282791, 0.36566756, 0.09279325, 0.75337353, 0.57128885, 0.52974123, 0.44548504, 0.77748843, 0.3224082, 0.40054277, 0.29522468, 0.19673553, 0.73781774, 0.57680312, 0.44545573, 0.30242355, 0.38720223, 0.16632904, 0.30804092, 0.56385194, 0.60012179, 0.48324821, 0.24636345, 0.26153216, 0.2348285, 0.29023669, 0.41011454, 0.36472083, 0.65922069, 0.30476903, 0.09986775, 0.70658332, 0.30713075, 0.36096386, 0.54962701, 0.71996086, 0.6633756])