import re
from pygments.lexer import RegexLexer, include, bygroups, default, using, \
from pygments.token import Text, Comment, Operator, Keyword, Name, String, \
from pygments.util import get_bool_opt, iteritems
import pygments.unistring as uni
class EarlGreyLexer(RegexLexer):
    """
    For `Earl-Grey`_ source code.

    .. _Earl-Grey: https://breuleux.github.io/earl-grey/

    .. versionadded: 2.1
    """
    name = 'Earl Grey'
    aliases = ['earl-grey', 'earlgrey', 'eg']
    filenames = ['*.eg']
    mimetypes = ['text/x-earl-grey']
    tokens = {'root': [('\\n', Text), include('control'), ('[^\\S\\n]+', Text), (';;.*\\n', Comment), ('[\\[\\]{}:(),;]', Punctuation), ('\\\\\\n', Text), ('\\\\', Text), include('errors'), (words(('with', 'where', 'when', 'and', 'not', 'or', 'in', 'as', 'of', 'is'), prefix='(?<=\\s|\\[)', suffix='(?![\\w$\\-])'), Operator.Word), ('[*@]?->', Name.Function), ('[+\\-*/~^<>%&|?!@#.]*=', Operator.Word), ('\\.{2,3}', Operator.Word), ('([+*/~^<>&|?!]+)|([#\\-](?=\\s))|@@+(?=\\s)|=+', Operator), ('(?<![\\w$\\-])(var|let)(?:[^\\w$])', Keyword.Declaration), include('keywords'), include('builtins'), include('assignment'), ('(?x)\n                (?:()([a-zA-Z$_](?:[\\w$\\-]*[\\w$])?)|\n                   (?<=[\\s{\\[(])(\\.)([a-zA-Z$_](?:[\\w$\\-]*[\\w$])?))\n                (?=.*%)', bygroups(Punctuation, Name.Tag, Punctuation, Name.Class.Start), 'dbs'), ('[rR]?`', String.Backtick, 'bt'), ('[rR]?```', String.Backtick, 'tbt'), ('(?<=[\\s\\[{(,;])\\.([a-zA-Z$_](?:[\\w$\\-]*[\\w$])?)(?=[\\s\\]}),;])', String.Symbol), include('nested'), ('(?:[rR]|[rR]\\.[gmi]{1,3})?"', String, combined('stringescape', 'dqs')), ("(?:[rR]|[rR]\\.[gmi]{1,3})?\\'", String, combined('stringescape', 'sqs')), ('"""', String, combined('stringescape', 'tdqs')), include('tuple'), include('import_paths'), include('name'), include('numbers')], 'dbs': [('(\\.)([a-zA-Z$_](?:[\\w$\\-]*[\\w$])?)(?=[.\\[\\s])', bygroups(Punctuation, Name.Class.DBS)), ('(\\[)([\\^#][a-zA-Z$_](?:[\\w$\\-]*[\\w$])?)(\\])', bygroups(Punctuation, Name.Entity.DBS, Punctuation)), ('\\s+', Text), ('%', Operator.DBS, '#pop')], 'import_paths': [('(?<=[\\s:;,])(\\.{1,3}(?:[\\w\\-]*/)*)(\\w(?:[\\w\\-]*\\w)*)(?=[\\s;,])', bygroups(Text.Whitespace, Text))], 'assignment': [('(\\.)?([a-zA-Z$_](?:[\\w$\\-]*[\\w$])?)(?=\\s+[+\\-*/~^<>%&|?!@#.]*\\=\\s)', bygroups(Punctuation, Name.Variable))], 'errors': [(words(('Error', 'TypeError', 'ReferenceError'), prefix='(?<![\\w\\-$.])', suffix='(?![\\w\\-$.])'), Name.Exception), ('(?x)\n                (?<![\\w$])\n                E\\.[\\w$](?:[\\w$\\-]*[\\w$])?\n                (?:\\.[\\w$](?:[\\w$\\-]*[\\w$])?)*\n                (?=[({\\[?!\\s])', Name.Exception)], 'control': [('(?x)\n                ([a-zA-Z$_](?:[\\w$-]*[\\w$])?)\n                (?!\\n)\\s+\n                (?!and|as|each\\*|each|in|is|mod|of|or|when|where|with)\n                (?=(?:[+\\-*/~^<>%&|?!@#.])?[a-zA-Z$_](?:[\\w$-]*[\\w$])?)', Keyword.Control), ('([a-zA-Z$_](?:[\\w$-]*[\\w$])?)(?!\\n)\\s+(?=[\\\'"\\d{\\[(])', Keyword.Control), ('(?x)\n                (?:\n                    (?<=[%=])|\n                    (?<=[=\\-]>)|\n                    (?<=with|each|with)|\n                    (?<=each\\*|where)\n                )(\\s+)\n                ([a-zA-Z$_](?:[\\w$-]*[\\w$])?)(:)', bygroups(Text, Keyword.Control, Punctuation)), ('(?x)\n                (?<![+\\-*/~^<>%&|?!@#.])(\\s+)\n                ([a-zA-Z$_](?:[\\w$-]*[\\w$])?)(:)', bygroups(Text, Keyword.Control, Punctuation))], 'nested': [('(?x)\n                (?<=[\\w$\\]})])(\\.)\n                ([a-zA-Z$_](?:[\\w$-]*[\\w$])?)\n                (?=\\s+with(?:\\s|\\n))', bygroups(Punctuation, Name.Function)), ('(?x)\n                (?<!\\s)(\\.)\n                ([a-zA-Z$_](?:[\\w$-]*[\\w$])?)\n                (?=[}\\]).,;:\\s])', bygroups(Punctuation, Name.Field)), ('(?x)\n                (?<=[\\w$\\]})])(\\.)\n                ([a-zA-Z$_](?:[\\w$-]*[\\w$])?)\n                (?=[\\[{(:])', bygroups(Punctuation, Name.Function))], 'keywords': [(words(('each', 'each*', 'mod', 'await', 'break', 'chain', 'continue', 'elif', 'expr-value', 'if', 'match', 'return', 'yield', 'pass', 'else', 'require', 'var', 'let', 'async', 'method', 'gen'), prefix='(?<![\\w\\-$.])', suffix='(?![\\w\\-$.])'), Keyword.Pseudo), (words(('this', 'self', '@'), prefix='(?<![\\w\\-$.])', suffix='(?![\\w\\-$])'), Keyword.Constant), (words(('Function', 'Object', 'Array', 'String', 'Number', 'Boolean', 'ErrorFactory', 'ENode', 'Promise'), prefix='(?<![\\w\\-$.])', suffix='(?![\\w\\-$])'), Keyword.Type)], 'builtins': [(words(('send', 'object', 'keys', 'items', 'enumerate', 'zip', 'product', 'neighbours', 'predicate', 'equal', 'nequal', 'contains', 'repr', 'clone', 'range', 'getChecker', 'get-checker', 'getProperty', 'get-property', 'getProjector', 'get-projector', 'consume', 'take', 'promisify', 'spawn', 'constructor'), prefix='(?<![\\w\\-#.])', suffix='(?![\\w\\-.])'), Name.Builtin), (words(('true', 'false', 'null', 'undefined'), prefix='(?<![\\w\\-$.])', suffix='(?![\\w\\-$.])'), Name.Constant)], 'name': [('@([a-zA-Z$_](?:[\\w$-]*[\\w$])?)', Name.Variable.Instance), ('([a-zA-Z$_](?:[\\w$-]*[\\w$])?)(\\+\\+|\\-\\-)?', bygroups(Name.Symbol, Operator.Word))], 'tuple': [('#[a-zA-Z_][\\w\\-]*(?=[\\s{(,;])', Name.Namespace)], 'interpoling_string': [('\\}', String.Interpol, '#pop'), include('root')], 'stringescape': [('\\\\([\\\\abfnrtv"\\\']|\\n|N\\{.*?\\}|u[a-fA-F0-9]{4}|U[a-fA-F0-9]{8}|x[a-fA-F0-9]{2}|[0-7]{1,3})', String.Escape)], 'strings': [('[^\\\\\\\'"]', String), ('[\\\'"\\\\]', String), ('\\n', String)], 'dqs': [('"', String, '#pop'), ('\\\\\\\\|\\\\"|\\\\\\n', String.Escape), include('strings')], 'sqs': [("'", String, '#pop'), ("\\\\\\\\|\\\\'|\\\\\\n", String.Escape), ('\\{', String.Interpol, 'interpoling_string'), include('strings')], 'tdqs': [('"""', String, '#pop'), include('strings')], 'bt': [('`', String.Backtick, '#pop'), ('(?<!`)\\n', String.Backtick), ('\\^=?', String.Escape), ('.+', String.Backtick)], 'tbt': [('```', String.Backtick, '#pop'), ('\\n', String.Backtick), ('\\^=?', String.Escape), ('[^`]+', String.Backtick)], 'numbers': [('\\d+\\.(?!\\.)\\d*([eE][+-]?[0-9]+)?', Number.Float), ('\\d+[eE][+-]?[0-9]+', Number.Float), ('8r[0-7]+', Number.Oct), ('2r[01]+', Number.Bin), ('16r[a-fA-F0-9]+', Number.Hex), ('([3-79]|[12][0-9]|3[0-6])r[a-zA-Z\\d]+(\\.[a-zA-Z\\d]+)?', Number.Radix), ('\\d+', Number.Integer)]}