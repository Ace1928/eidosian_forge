import __future__  # noqa: F404
import collections
import functools
import types
import warnings
from typing import Dict, Set, List, Any, Callable, Iterable, Type, Tuple
from functools import wraps
import contextlib
import torch
from torch._C import (
@functools.lru_cache(None)
@_disable_user_warnings
def get_ignored_functions() -> Set[Callable]:
    """
    Return public functions that cannot be overridden by ``__torch_function__``.

    Returns
    -------
    Set[Callable]
        A tuple of functions that are publicly available in the torch API but cannot
        be overridden with ``__torch_function__``. Mostly this is because none of the
        arguments of these functions are tensors or tensor-likes.

    Examples
    --------
    >>> torch.Tensor.as_subclass in torch.overrides.get_ignored_functions()
    True
    >>> torch.add in torch.overrides.get_ignored_functions()
    False
    """
    Tensor = torch.Tensor
    return {torch.typename, torch.is_tensor, torch.is_storage, torch.set_default_tensor_type, torch.set_default_device, torch.set_rng_state, torch.get_rng_state, torch.manual_seed, torch.initial_seed, torch.seed, torch.save, torch.load, torch.set_printoptions, torch.fork, torch.get_default_dtype, torch.get_num_interop_threads, torch.get_num_threads, torch.init_num_threads, torch.import_ir_module, torch.import_ir_module_from_buffer, torch.is_anomaly_enabled, torch.is_anomaly_check_nan_enabled, torch.is_grad_enabled, torch.merge_type_from_type_comment, torch.parse_ir, torch.parse_schema, torch.parse_type_comment, torch.set_anomaly_enabled, torch.set_flush_denormal, torch.set_num_interop_threads, torch.set_num_threads, torch.wait, torch.as_tensor, torch.from_numpy, torch.get_device, torch.tensor, torch.default_generator, torch.has_cuda, torch.has_cudnn, torch.has_lapack, torch.device, torch.dtype, torch.finfo, torch.has_mkl, torch.has_mps, torch.has_mkldnn, torch.has_openmp, torch.iinfo, torch.memory_format, torch.qscheme, torch.set_grad_enabled, torch.no_grad, torch.enable_grad, torch.inference_mode, torch.is_inference_mode_enabled, torch.layout, torch.align_tensors, torch.arange, torch.as_strided, torch.bartlett_window, torch.blackman_window, torch.broadcast_shapes, torch.can_cast, torch.compile, torch.cudnn_affine_grid_generator, torch.cudnn_batch_norm, torch.cudnn_convolution, torch.cudnn_convolution_transpose, torch.cudnn_convolution_relu, torch.cudnn_convolution_add_relu, torch.cudnn_grid_sampler, torch.cudnn_is_acceptable, torch.empty, torch.empty_permuted, torch.empty_strided, torch.empty_quantized, torch.export.dynamic_dim, torch.export.export, torch.export.load, torch.export.register_dataclass, torch.export.save, torch.eye, torch.fft.fftfreq, torch.fft.rfftfreq, torch.from_file, torch.full, torch.fill, torch.hamming_window, torch.hann_window, torch.kaiser_window, torch.linspace, torch.logspace, torch.mkldnn_adaptive_avg_pool2d, torch.mkldnn_convolution, torch.mkldnn_max_pool2d, torch.mkldnn_max_pool3d, torch.mkldnn_linear_backward_weights, torch.mkldnn_rnn_layer, torch.normal, torch.ones, torch.promote_types, torch.rand, torch.randn, torch.randint, torch.randperm, torch.range, torch.result_type, torch.scalar_tensor, torch.sparse_coo_tensor, torch.sparse_compressed_tensor, torch.sparse_csr_tensor, torch.sparse_csc_tensor, torch.sparse_bsr_tensor, torch.sparse_bsc_tensor, torch.sym_constrain_range, torch.sym_constrain_range_for_size, torch.tril_indices, torch.triu_indices, torch.vander, torch.zeros, torch._jit_internal.boolean_dispatch, torch.nn.functional.assert_int_or_pair, torch.nn.functional.upsample, torch.nn.functional.upsample_bilinear, torch.nn.functional.upsample_nearest, torch.nn.functional.has_torch_function, torch.nn.functional.has_torch_function_unary, torch.nn.functional.has_torch_function_variadic, torch.nn.functional.handle_torch_function, torch.nn.functional.sigmoid, torch.nn.functional.hardsigmoid, torch.nn.functional.tanh, torch.nn.functional._canonical_mask, torch.nn.functional._none_or_dtype, torch.nn.init.calculate_gain, torch.nn.init.uniform, torch.nn.init.normal, torch.nn.init.constant, torch.nn.init.eye, torch.nn.init.dirac, torch.nn.init.xavier_uniform, torch.nn.init.xavier_normal, torch.nn.init.kaiming_uniform, torch.nn.init.kaiming_normal, torch.nn.init.orthogonal, torch.nn.init.sparse, torch.nested.to_padded_tensor, has_torch_function, handle_torch_function, torch.set_autocast_enabled, torch.is_autocast_enabled, torch.clear_autocast_cache, torch.set_autocast_cpu_enabled, torch.is_autocast_cpu_enabled, torch.set_autocast_xla_enabled, torch.is_autocast_xla_enabled, torch.set_autocast_ipu_enabled, torch.is_autocast_ipu_enabled, torch.set_autocast_cpu_dtype, torch.get_autocast_cpu_dtype, torch.set_autocast_ipu_dtype, torch.get_autocast_ipu_dtype, torch.get_autocast_gpu_dtype, torch.set_autocast_gpu_dtype, torch.get_autocast_xla_dtype, torch.set_autocast_xla_dtype, torch.autocast_increment_nesting, torch.autocast_decrement_nesting, torch.is_autocast_cache_enabled, torch.set_autocast_cache_enabled, torch.nn.functional.hardswish, torch.is_vulkan_available, torch.are_deterministic_algorithms_enabled, torch.use_deterministic_algorithms, torch.is_deterministic_algorithms_warn_only_enabled, torch.set_deterministic_debug_mode, torch.get_deterministic_debug_mode, torch.set_float32_matmul_precision, torch.get_float32_matmul_precision, torch.unify_type_list, torch.is_warn_always_enabled, torch.set_warn_always, torch.vitals_enabled, torch.set_vital, torch.read_vitals, torch.vmap, torch.cond, torch.frombuffer, torch.asarray, torch._functional_sym_constrain_range, torch._make_dep_token, Tensor.__delitem__, Tensor.__dir__, Tensor.__getattribute__, Tensor.__init__, Tensor.__iter__, Tensor.__init_subclass__, Tensor.__delattr__, Tensor.__setattr__, Tensor.__torch_function__, Tensor.__torch_dispatch__, Tensor.__new__, Tensor.__class__, Tensor.__subclasshook__, Tensor.__hash__, Tensor.as_subclass, Tensor.eig, Tensor.lstsq, Tensor.reinforce, Tensor.new, Tensor.new_tensor, Tensor.new_empty, Tensor.new_empty_strided, Tensor.new_zeros, Tensor.new_ones, Tensor.new_full, Tensor._make_subclass, Tensor.solve, Tensor.symeig, Tensor.stride, Tensor.unflatten, Tensor.to_sparse_coo, Tensor.to_sparse_csr, Tensor.to_sparse_csc, Tensor.to_sparse_bsr, Tensor.to_sparse_bsc, Tensor._to_sparse, Tensor._to_sparse_csr, Tensor._to_sparse_csc, Tensor._to_sparse_bsr, Tensor._to_sparse_bsc, Tensor._typed_storage, Tensor._reduce_ex_internal, Tensor._fix_weakref, Tensor._view_func, Tensor._view_func_unsafe, Tensor._make_wrapper_subclass, Tensor._python_dispatch.__get__, Tensor._has_symbolic_sizes_strides.__get__, Tensor._conj, Tensor._conj_physical, Tensor._neg_view, Tensor._is_zerotensor, Tensor._is_all_true, Tensor._is_any_true, Tensor._addmm_activation, Tensor.to_padded_tensor}