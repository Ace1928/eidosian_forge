import os
import sys
import types
import cherrypy
from cherrypy._cpcompat import ntou
from cherrypy import _cptools, tools
from cherrypy.lib import httputil, static
from cherrypy.test._test_decorators import ExposeExamples
from cherrypy.test import helper
def test_cherrypy_url(self):
    self.getPage('/url/leaf?path_info=page1')
    self.assertBody('%s/url/page1' % self.base())
    self.getPage('/url/?path_info=page1')
    self.assertBody('%s/url/page1' % self.base())
    host = 'www.mydomain.example'
    self.getPage('/url/leaf?path_info=page1', headers=[('Host', host)])
    self.assertBody('%s://%s/url/page1' % (self.scheme, host))
    self.getPage('/url/leaf?path_info=/page1')
    self.assertBody('%s/page1' % self.base())
    self.getPage('/url/?path_info=/page1')
    self.assertBody('%s/page1' % self.base())
    self.getPage('/url/leaf?path_info=./page1')
    self.assertBody('%s/url/page1' % self.base())
    self.getPage('/url/leaf?path_info=other/./page1')
    self.assertBody('%s/url/other/page1' % self.base())
    self.getPage('/url/?path_info=/other/./page1')
    self.assertBody('%s/other/page1' % self.base())
    self.getPage('/url/?path_info=/other/././././page1')
    self.assertBody('%s/other/page1' % self.base())
    self.getPage('/url/leaf?path_info=../page1')
    self.assertBody('%s/page1' % self.base())
    self.getPage('/url/leaf?path_info=other/../page1')
    self.assertBody('%s/url/page1' % self.base())
    self.getPage('/url/leaf?path_info=/other/../page1')
    self.assertBody('%s/page1' % self.base())
    self.getPage('/url/leaf?path_info=/other/../../../page1')
    self.assertBody('%s/page1' % self.base())
    self.getPage('/url/leaf?path_info=/other/../../../../../page1')
    self.assertBody('%s/page1' % self.base())
    self.getPage('/url/qs?qs=/other')
    self.assertBody('%s/url/qs?/other' % self.base())
    self.getPage('/url/qs?qs=/other/../page1')
    self.assertBody('%s/url/qs?/other/../page1' % self.base())
    self.getPage('/url/qs?qs=../page1')
    self.assertBody('%s/url/qs?../page1' % self.base())
    self.getPage('/url/qs?qs=../../page1')
    self.assertBody('%s/url/qs?../../page1' % self.base())
    self.getPage('/url/?path_info=page1&relative=True')
    self.assertBody('page1')
    self.getPage('/url/leaf?path_info=/page1&relative=True')
    self.assertBody('../page1')
    self.getPage('/url/leaf?path_info=page1&relative=True')
    self.assertBody('page1')
    self.getPage('/url/leaf?path_info=leaf/page1&relative=True')
    self.assertBody('leaf/page1')
    self.getPage('/url/leaf?path_info=../page1&relative=True')
    self.assertBody('../page1')
    self.getPage('/url/?path_info=other/../page1&relative=True')
    self.assertBody('page1')
    self.getPage('/baseurl?path_info=ab&relative=True')
    self.assertBody('ab')
    self.getPage('/baseurl?path_info=/ab&relative=True')
    self.assertBody('ab')
    self.getPage('/url/leaf?path_info=page1&relative=server')
    self.assertBody('/url/page1')
    self.getPage('/url/?path_info=page1&relative=server')
    self.assertBody('/url/page1')
    self.getPage('/url/leaf?path_info=/page1&relative=server')
    self.assertBody('/page1')
    self.getPage('/url/?path_info=/page1&relative=server')
    self.assertBody('/page1')