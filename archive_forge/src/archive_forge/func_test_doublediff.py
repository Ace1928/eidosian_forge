from __future__ import annotations
import inspect
import pytest
import dask
from dask import delayed
from dask.base import collections_to_dsk, key_split, visualize_dsk
from dask.core import get_deps
from dask.order import _connecting_to_roots, diagnostics, ndependencies, order
from dask.utils_test import add, inc
def test_doublediff(abcde):
    a, b, c, d, e = abcde
    dsk = {(a, 3, 0, 1): (f, 1), (a, 3, 1, 1): (f, 1), (a, 3, 1, 0): (f, 1), (a, 2, 2, 2): (f, 1), (a, 4, 0, 1): (f, 1), (a, 4, 1, 0): (f, 1), (a, 4, 0, 0): (f, 1), (a, 5, 0, 0): (f, 1), (c, 0, 0, 0): (b, 1, 0, 0), (c, 0, 0, 1): (b, 1, 0, 1), (c, 0, 0, 2): (b, 1, 0, 2), (c, 0, 1, 0): (b, 1, 1, 0), (c, 0, 1, 1): (b, 1, 1, 1), (c, 0, 1, 2): (b, 1, 1, 2), (c, 0, 2, 0): (b, 1, 2, 0), (c, 0, 2, 1): (b, 1, 2, 1), (c, 1, 0, 0): (a, 5, 0, 0), (c, 1, 0, 1): (b, 0, 0, 1), (c, 1, 0, 2): (b, 0, 0, 2), (c, 1, 1, 0): (b, 0, 1, 0), (c, 1, 1, 1): (b, 0, 1, 1), (c, 1, 1, 2): (b, 0, 1, 2), (c, 1, 2, 0): (b, 0, 2, 0), (b, 1, 0, 0): (f, (a, 4, 0, 0)), (b, 1, 0, 1): (f, (a, 4, 0, 0)), (b, 1, 0, 2): (f, (a, 4, 0, 1)), (b, 1, 1, 0): (f, (a, 4, 0, 0)), (b, 1, 1, 1): (f, (a, 4, 0, 0)), (b, 1, 1, 2): (f, (a, 4, 0, 1)), (b, 1, 2, 0): (f, (a, 4, 1, 0)), (b, 1, 2, 1): (f, (a, 4, 1, 0)), (c, 1, 2, 1): (b, 0, 2, 1), (c, 1, 2, 2): (b, 0, 2, 2), (d, 0, 0, 0): (f, (c, 1, 0, 0), (c, 0, 0, 0)), (d, 0, 0, 1): (f, (c, 1, 0, 1), (c, 0, 0, 1)), (d, 0, 0, 2): (f, (c, 1, 0, 2), (c, 0, 0, 2)), (d, 0, 1, 0): (f, (c, 1, 1, 0), (c, 0, 1, 0)), (d, 0, 1, 1): (f, (c, 1, 1, 1), (c, 0, 1, 1)), (d, 0, 1, 2): (f, (c, 1, 1, 2), (c, 0, 1, 2)), (d, 0, 2, 0): (f, (c, 1, 2, 0), (c, 0, 2, 0)), (d, 0, 2, 1): (f, (c, 1, 2, 1), (c, 0, 2, 1)), (d, 0, 2, 2): (f, (c, 1, 2, 2), (a, 2, 2, 2)), (b, 0, 0, 1): (f, (a, 3, 0, 1)), (b, 0, 0, 2): (f, (a, 3, 0, 1)), (b, 0, 1, 0): (f, (a, 3, 1, 0)), (b, 0, 1, 1): (f, (a, 3, 1, 1)), (b, 0, 1, 2): (f, (a, 3, 1, 1)), (b, 0, 2, 0): (f, (a, 3, 1, 0)), (b, 0, 2, 1): (f, (a, 3, 1, 1)), (b, 0, 2, 2): (f, (a, 3, 1, 1)), (e, 0, 0, 0): (f, (d, 0, 0, 0)), (e, 0, 0, 1): (f, (d, 0, 0, 1)), (e, 0, 0, 2): (f, (d, 0, 0, 2)), (e, 0, 1, 0): (f, (d, 0, 1, 0)), (e, 0, 1, 1): (f, (d, 0, 1, 1)), (e, 0, 1, 2): (f, (d, 0, 1, 2)), (e, 0, 2, 0): (f, (d, 0, 2, 0)), (e, 0, 2, 1): (f, (d, 0, 2, 1)), (e, 0, 2, 2): (f, (d, 0, 2, 2)), 'END': [(e, 0, 0, 0), (e, 0, 0, 1), (e, 0, 0, 2), (e, 0, 1, 0), (e, 0, 1, 1), (e, 0, 1, 2), (e, 0, 2, 0), (e, 0, 2, 1), (e, 0, 2, 2)]}
    _, pressure = diagnostics(dsk)
    assert max(pressure) <= 11, max(pressure)