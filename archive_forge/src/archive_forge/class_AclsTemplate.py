from __future__ import absolute_import, division, print_function
import re
from ansible.module_utils._text import to_text
from ansible_collections.ansible.netcommon.plugins.module_utils.network.common.rm_base.network_template import (
class AclsTemplate(NetworkTemplate):

    def __init__(self, lines=None):
        super(AclsTemplate, self).__init__(lines=lines, tmplt=self)
    PARSERS = [{'name': 'only_acls_name', 'getval': re.compile('^(?P<acl_type>Standard|Extended|Reflexive)*\n                    \\s*(?P<afi>IP|IPv6)*\n                    \\s*access*\n                    \\s*list*\n                    \\s*(?P<acl_name>.+)*\n                    $', re.VERBOSE), 'setval': '', 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'acl_type': '{{ acl_type.lower() if acl_type is defined }}', 'afi': "{{ 'ipv4' if afi == 'IP' else 'ipv6' }}"}}}}, {'name': 'acls_name', 'getval': re.compile('^(?P<afi>ip|ipv6|mac)\n                    (\\s(access-list))\n                    (\\s(?P<acl_type>standard|extended|reflexive))?\n                    (\\s(?P<acl_name>\\S+))\n                    $', re.VERBOSE), 'setval': 'name', 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'acl_type': '{{ acl_type.lower() if acl_type is defined }}', 'afi': "{{ 'ipv4' if afi == 'ip' else 'ipv6' }}"}}}, 'shared': True}, {'name': 'remarks', 'getval': re.compile('((?P<order>^\\d+))\n                    (\\s*(?P<sequence>\\d+))\n                    (\\sremark\\s(?P<remarks>.+))\n                    $', re.VERBOSE), 'setval': remarks_with_sequence, 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'aces': [{'the_remark': '{{ remarks }}', 'order': '{{ order }}', 'is_remark_for': '{{ sequence }}'}]}}}}, {'name': 'remarks_no_data', 'getval': re.compile('(?P<order>^\\d+)\\s*remark\\s(?P<remarks>.+)$', re.VERBOSE), 'setval': '{{ sequence }} remark', 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'aces': [{'the_remark': '{{ remarks }}', 'order': '{{ order }}', 'is_remark_for': 'remark'}]}}}}, {'name': 'remarks_ipv6', 'getval': re.compile('\\s*(sequence\\s(?P<sequence>\\d+))\n                    (\\sremark\\s(?P<remarks>.+))\n                    $', re.VERBOSE), 'setval': 'remark {{ remarks }}', 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'aces': [{'sequence': '{{ sequence }}', 'remarks': ['{{ remarks }}']}]}}}}, {'name': 'aces_ipv4_standard', 'getval': re.compile('(\\s*(?P<sequence>\\d+))?\n                        (\\s(?P<grant>deny|permit))\n                        (\\s+(?P<address>((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)))?\n                        (\\s(?P<wildcard>((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)))?\n                        (\\s*(?P<any>any))?\n                        (\\s(?P<log>log))?\n                    $', re.VERBOSE), 'compval': 'aces', 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'aces': [{'sequence': '{{ sequence }}', 'grant': '{{ grant }}', 'source': {'address': '{{ address }}', 'wildcard_bits': '{{ wildcard }}', 'any': '{{ not not any }}'}, 'log': {'set': '{{ not not log }}'}}]}}}}, {'name': 'aces', 'getval': re.compile('(\\s*(?P<sequence>\\d+))?\n                        (\\s*sequence\\s(?P<sequence_ipv6>\\d+))?\n                        (\\s*(?P<grant>deny|permit))\n                        (\\sevaluate\\s(?P<evaluate>\\S+))?\n                        (\\s(?P<protocol_num>\\d+))?\n                        (\\s*(?P<protocol>ahp|eigrp|esp|gre|icmp|igmp|ipinip|ipv6|ip|nos|ospf|pcp|pim|sctp|tcp|ip|udp))?\n                        ((\\s(?P<source_any>any))|\n                        (\\sobject-group\\s(?P<source_obj_grp>\\S+))|\n                        (\\shost\\s(?P<source_host>\\S+))|\n                        (\\s(?P<ipv6_source_address>\\S+/\\d+))|\n                        (\\s(?P<source_address>(\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\s\\S+)))?\n                        (\\seq\\s(?P<seq>(\\S+|\\d+)))?\n                        (\\sgt\\s(?P<sgt>(\\S+|\\d+)))?\n                        (\\slt\\s(?P<slt>(\\S+|\\d+)))?\n                        (\\sneq\\s(?P<sneq>(\\S+|\\d+)))?\n                        (\\srange\\s(?P<srange_start>\\d+)\\s(?P<srange_end>\\d+))?\n                        (\\s(?P<dest_any>any))?\n                        (\\sobject-group\\s(?P<dest_obj_grp>\\S+))?\n                        (\\shost\\s(?P<dest_host>\\S+))?\n                        (\\s(?P<ipv6_dest_address>\\S+/\\d+))?\n                        (\\s(?P<dest_address>(\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\s\\S+))?\n                        (\\seq\\s(?P<deq>(\\S+|\\d+)))?\n                        (\\sgt\\s(?P<dgt>(\\S+|\\d+)))?\n                        (\\slt\\s(?P<dlt>(\\S+|\\d+)))?\n                        (\\sneq\\s(?P<dneq>(\\S+|\\d+)))?\n                        (\\srange\\s(?P<drange_start>\\d+)\\s(?P<drange_end>\\d+))?\n                        (\\s(?P<icmp_igmp_tcp_protocol>administratively-prohibited|alternate-address|conversion-error|dod-host-prohibited|dod-net-prohibited|echo-reply|echo|general-parameter-problem|host-isolated|host-precedence-unreachable|host-redirect|host-tos-redirect|host-tos-unreachable|host-unknown|host-unreachable|information-reply|information-request|mask-reply|mask-request|mobile-redirect|net-redirect|net-tos-redirect|net-tos-unreachable|net-unreachable|network-unknown|no-room-for-option|option-missing|packet-too-big|parameter-problem|port-unreachable|precedence-unreachable|protocol-unreachable|reassembly-timeout|redirect|router-advertisement|router-solicitation|source-quench|source-route-failed|time-exceeded|timestamp-reply|timestamp-request|traceroute|ttl-exceeded|unreachable|dvmrp|host-query|mtrace-resp|mtrace-route|pim|trace|v1host-report|v2host-report|v2leave-group|v3host-report|ack|established|fin|psh|rst|syn|urg))?\n                        (\\sdscp\\s(?P<dscp>\\S+))?\n                        (\\s(?P<enable_fragments>fragments))?\n                        (\\slog-input\\s\\(tag\\s=\\s(?P<log_input>\\S+\\)|log-input))?\n                        (\\s(?P<log_input_only>log-input))?\n                        (\\slog\\s\\(tag\\s=\\s(?P<log>\\S+\\)|log))?\n                        (\\s(?P<log_only>log))?\n                        (\\soption\\s(?P<option>\\S+|\\d+))?\n                        (\\sprecedence\\s(?P<precedence>\\S+))?\n                        (\\stime-range\\s(?P<time_range>\\S+))?\n                        (\\stos\\s(?P<tos>\\S+|\\d+))?\n                        (\\sttl\\seq\\s(?P<ttl_eq>\\d+))?\n                        (\\sttl\\sgt\\s(?P<ttl_gt>\\d+))?\n                        (\\sttl\\slt\\s(?P<ttl_lt>\\d+))?\n                        (\\sttl\\sneg\\s(?P<ttl_neg>\\d+))?\n                    ', re.VERBOSE), 'setval': _tmplt_access_list_entries, 'compval': 'aces', 'result': {'acls': {'{{ acl_name|d() }}': {'name': '{{ acl_name }}', 'aces': [{'sequence': '{% if sequence is defined %}{{ sequence                                     }}{% elif sequence_ipv6 is defined %}{{ sequence_ipv6 }}{% endif %}', 'grant': '{{ grant }}', 'evaluate': '{{ evaluate }}', 'protocol': '{{ protocol }}', 'protocol_number': '{{ protocol_num }}', 'icmp_igmp_tcp_protocol': '{{ icmp_igmp_tcp_protocol }}', 'source': {'address': '{{ source_address }}', 'ipv6_address': '{{ ipv6_source_address }}', 'any': '{{ not not source_any }}', 'host': '{{ source_host }}', 'object_group': '{{ source_obj_grp }}', 'port_protocol': {'eq': '{{ seq }}', 'gt': '{{ sgt }}', 'lt': '{{ slt }}', 'neq': '{{ sneq }}', 'range': {'start': '{{ srange_start if srange_start is defined else None }}', 'end': '{{ srange_end if srange_end is defined else None }}'}}}, 'destination': {'address': '{{ dest_address }}', 'ipv6_address': '{{ ipv6_dest_address }}', 'any': '{{ not not dest_any }}', 'host': '{{ dest_host }}', 'object_group': '{{ dest_obj_grp }}', 'port_protocol': {'eq': '{{ deq }}', 'gt': '{{ dgt }}', 'lt': '{{ dlt }}', 'neq': '{{ dneq }}', 'range': {'start': '{{ drange_start if drange_start is defined else None }}', 'end': '{{ drange_end if drange_end is defined else None }}'}}}, 'dscp': '{{ dscp }}', 'enable_fragments': '{{ True if enable_fragments is defined else None }}', 'log': {'set': '{{ True if log_only is defined or log is defined }}', 'user_cookie': "{{ log.split(')')[0] if log is defined }}"}, 'log_input': {'set': '{{ True if log_input_only is defined or log_input is defined }}', 'user_cookie': "{{ log_input.split(')')[0] if log_input is defined }}"}, 'option': {'{{ option if option is defined else None }}': '{{ True if option is defined else None }}'}, 'precedence': '{{ precedence }}', 'time_range': '{{ time_range }}', 'tos': {'max_reliability': "{{ True if tos is defined and 'max-reliability' in tos else '' }}", 'max_throughput': "{{ True if tos is defined and 'max-throughput' in tos else '' }}", 'min_delay': "{{ True if tos is defined and 'min-delay' in tos else '' }}", 'min_monetary_cost': "{{ True if tos is defined and 'min-monetary-cost' in tos else '' }}", 'normal': "{{ True if tos is defined and 'normal' in tos else '' }}", 'service_value': '{{ tos if tos is defined else None }}'}, 'ttl': {'eq': '{{ ttl_eq }}', 'gt': '{{ ttl_gt }}', 'lt': '{{ ttl_lt }}', 'neq': '{{ ttl_neq }}'}}]}}}}]