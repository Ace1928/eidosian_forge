import numpy as np
from ase import Atoms
from ase.io import read, write
import ase.io.rmc6f as rmc6f
from ase.lattice.compounds import TRI_Fe2O3
def test_rmc6f_write_output():
    """Test for utility function for writing rmc6f output
    """
    fileobj = 'output.rmc6f'
    header_lines = ['(Version 6f format configuration file)', '(Generated by ASE - Atomic Simulation Environment https://wiki.fysik.dtu.dk/ase/ )', "Metadata date:18-007-'2019", 'Number of types of atoms:   2 ', 'Atom types present:          S F', 'Number of each atom type:   1 6', 'Number of moves generated:           0', 'Number of moves tried:               0', 'Number of moves accepted:            0', 'Number of prior configuration saves: 0', 'Number of atoms:                     7', 'Supercell dimensions:                1 1 1', 'Number density (Ang^-3):              0.06860598423060468', 'Cell (Ang/deg): 4.672816 4.672816 4.672816 90.0 90.0 90.0', 'Lattice vectors (Ang):', '    4.672816     0.000000     0.000000', '    0.000000     4.672816     0.000000', '    0.000000     0.000000     4.672816', 'Atoms:']
    data_array = symbol_xyz_list_ext
    data_dtype = [('id', '<i8'), ('symbols', '<U1'), ('scaled_positions0', '<f8'), ('scaled_positions1', '<f8'), ('scaled_positions2', '<f8'), ('ref_num', '<i8'), ('ref_cell0', '<i8'), ('ref_cell1', '<i8'), ('ref_cell2', '<i8')]
    data = np.array(data_array, dtype=data_dtype)
    fmt = '%8d %s%14.6f %14.6f %14.6f %8d %8d %8d %8d \n'
    with open('output.rmc6f', 'w') as fileobj:
        rmc6f._write_output(fileobj, header_lines, data, fmt)