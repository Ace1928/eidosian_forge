from pynvml.nvml import *
import datetime
import collections
import time
from threading import Thread
@staticmethod
def __xmlGetEccByCounter(handle, counterType, filter):
    eccByCounter = ''
    if NVSMI_ALL in filter or NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM in filter or NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE in filter or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_SRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_CBU in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TOTAL in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_CBU in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_SRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL in filter):
        eccByCounter += '        <single_bit>\n'
        eccByCounter += nvidia_smi.__toString(nvidia_smi.__xmlGetEccByType(handle, counterType, NVML_MEMORY_ERROR_TYPE_CORRECTED))
        eccByCounter += '        </single_bit>\n'
    if NVSMI_ALL in filter or NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM in filter or NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE in filter or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_SRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_CBU in filter) or (NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TOTAL in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_CBU in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_SRAM in filter) or (NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL in filter):
        eccByCounter += '        <double_bit>\n'
        eccByCounter += nvidia_smi.__toString(nvidia_smi.__xmlGetEccByType(handle, counterType, NVML_MEMORY_ERROR_TYPE_UNCORRECTED))
        eccByCounter += '        </double_bit>\n'
    return eccByCounter