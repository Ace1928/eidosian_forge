import functools
import flask
from oslo_log import log
from oslo_policy import opts
from oslo_policy import policy as common_policy
from oslo_utils import strutils
from keystone.common import authorization
from keystone.common import context
from keystone.common import policies
from keystone.common import provider_api
from keystone.common import utils
import keystone.conf
from keystone import exception
from keystone.i18n import _
@classmethod
def _assert_is_authenticated(cls):
    ctx = cls._get_oslo_req_context()
    if ctx is None:
        LOG.warning('RBAC: Error reading the request context generated by the Auth Middleware (there is no context). Rejecting request as unauthorized.')
        raise exception.Unauthorized(_('Internal error processing authentication and authorization.'))
    if not ctx.authenticated:
        raise exception.Unauthorized(_('auth_context did not decode anything useful'))