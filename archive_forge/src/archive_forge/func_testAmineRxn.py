import sys
import weakref
from rdkit import Chem
from rdkit.Chem import rdChemReactions as Reactions
def testAmineRxn(self):
    m = Chem.MolFromSmiles('C1CC1N(C1NC1)C1OC1')
    res = RecapDecompose(m)
    self.assertTrue(res)
    self.assertTrue(len(res.GetLeaves()) == 3)
    ks = res.GetLeaves().keys()
    self.assertTrue('*C1CC1' in ks)
    self.assertTrue('*C1CO1' in ks)
    self.assertTrue('*C1CN1' in ks)
    m = Chem.MolFromSmiles('c1ccccc1N(C1NC1)C1OC1')
    res = RecapDecompose(m)
    self.assertTrue(res)
    self.assertTrue(len(res.GetLeaves()) == 3)
    ks = res.GetLeaves().keys()
    self.assertTrue('*c1ccccc1' in ks)
    self.assertTrue('*C1CO1' in ks)
    self.assertTrue('*C1CN1' in ks)
    m = Chem.MolFromSmiles('c1ccccc1N(c1ncccc1)C1OC1')
    res = RecapDecompose(m)
    self.assertTrue(res)
    self.assertTrue(len(res.GetLeaves()) == 3)
    ks = res.GetLeaves().keys()
    self.assertTrue('*c1ccccc1' in ks)
    self.assertTrue('*c1ccccn1' in ks)
    self.assertTrue('*C1CO1' in ks)
    m = Chem.MolFromSmiles('c1ccccc1N(c1ncccc1)c1ccco1')
    res = RecapDecompose(m)
    self.assertTrue(res)
    self.assertTrue(len(res.GetLeaves()) == 3)
    ks = res.GetLeaves().keys()
    self.assertTrue('*c1ccccc1' in ks)
    self.assertTrue('*c1ccccn1' in ks)
    self.assertTrue('*c1ccco1' in ks)
    m = Chem.MolFromSmiles('C1CCCCN1C1CC1')
    res = RecapDecompose(m)
    self.assertTrue(res)
    self.assertTrue(len(res.GetLeaves()) == 2)
    ks = res.GetLeaves().keys()
    self.assertTrue('*N1CCCCC1' in ks)
    self.assertTrue('*C1CC1' in ks)
    m = Chem.MolFromSmiles('C1CCC2N1CC2')
    res = RecapDecompose(m)
    self.assertTrue(res)
    self.assertTrue(len(res.GetLeaves()) == 0)