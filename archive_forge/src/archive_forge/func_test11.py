import copy
import re
import sys
from rdkit import Chem
from rdkit import RDRandom as random
from rdkit.Chem import rdChemReactions as Reactions
def test11(self):
    molblock = '\n     RDKit          3D\n\n 13 14  0  0  0  0  0  0  0  0999 V2000\n   -1.2004    0.5900    0.6110 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.2328    1.3173    0.0343 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.4299    0.6533   -0.1500 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.3633   -0.7217   -0.3299 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.1552   -1.3791   -0.2207 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.1425   -0.7969    0.5335 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.1458   -1.4244    0.4108 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2976   -0.7398   -0.1026 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4889   -0.7939    0.5501 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4615    0.1460    0.3535 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0116    1.4034   -0.0296 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9786    1.4264   -0.9435 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1399    0.3193   -0.9885 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  2  0\n  6  7  1  0\n  7  8  1  0\n  8  9  2  0\n  9 10  1  0\n 10 11  2  0\n 11 12  1  0\n 12 13  2  0\n  6  1  1  0\n 13  8  1  0\nM  END\n'
    m = Chem.MolFromMolBlock(molblock)
    pieces = BreakBRICSBonds(m)
    frags = Chem.GetMolFrags(pieces, asMols=True)
    self.assertEqual(len(frags), 3)
    self.assertEqual(frags[0].GetNumAtoms(), 7)
    self.assertEqual(frags[1].GetNumAtoms(), 3)
    self.assertEqual(frags[2].GetNumAtoms(), 7)
    c1 = m.GetConformer()
    c2 = frags[0].GetConformer()
    for i in range(6):
        p1 = c1.GetAtomPosition(i)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(6)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c2 = frags[2].GetConformer()
    for i in range(6):
        p1 = c1.GetAtomPosition(i + 7)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(6)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c2 = frags[1].GetConformer()
    for i in range(1):
        p1 = c1.GetAtomPosition(i + 6)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(5)
    p2 = c2.GetAtomPosition(1)
    self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(0)
    self.assertEqual((p1 - p2).Length(), 0.0)
    molblock = '\n     RDKit          2D\n\n 13 14  0  0  0  0  0  0  0  0999 V2000\n   -1.2990   -0.8654    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5981   -1.6154    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8971   -0.8654    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8971    0.6346    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5981    1.3846    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.2990    0.6346    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.0000    1.3846    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990    0.6346    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.2990   -0.8654    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.5981   -1.6154    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.8971   -0.8654    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.8971    0.6346    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.5981    1.3846    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  2  0\n  6  7  1  0\n  7  8  1  0\n  8  9  2  0\n  9 10  1  0\n 10 11  2  0\n 11 12  1  0\n 12 13  2  0\n  6  1  1  0\n 13  8  1  0\nM  END\n'
    m2 = Chem.MolFromMolBlock(molblock)
    m.AddConformer(m2.GetConformer(), assignId=True)
    self.assertEqual(m.GetNumConformers(), 2)
    pieces = BreakBRICSBonds(m)
    frags = Chem.GetMolFrags(pieces, asMols=True)
    self.assertEqual(len(frags), 3)
    self.assertEqual(frags[0].GetNumAtoms(), 7)
    self.assertEqual(frags[1].GetNumAtoms(), 3)
    self.assertEqual(frags[2].GetNumAtoms(), 7)
    self.assertEqual(frags[0].GetNumConformers(), 2)
    self.assertEqual(frags[1].GetNumConformers(), 2)
    self.assertEqual(frags[2].GetNumConformers(), 2)
    c1 = m.GetConformer(0)
    c2 = frags[0].GetConformer(0)
    for i in range(6):
        p1 = c1.GetAtomPosition(i)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(6)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c2 = frags[2].GetConformer(0)
    for i in range(6):
        p1 = c1.GetAtomPosition(i + 7)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(6)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c2 = frags[1].GetConformer(0)
    for i in range(1):
        p1 = c1.GetAtomPosition(i + 6)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(5)
    p2 = c2.GetAtomPosition(1)
    self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(0)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c1 = m.GetConformer(1)
    c2 = frags[0].GetConformer(1)
    for i in range(6):
        p1 = c1.GetAtomPosition(i)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(6)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c2 = frags[2].GetConformer(1)
    for i in range(6):
        p1 = c1.GetAtomPosition(i + 7)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(6)
    self.assertEqual((p1 - p2).Length(), 0.0)
    c2 = frags[1].GetConformer(1)
    for i in range(1):
        p1 = c1.GetAtomPosition(i + 6)
        p2 = c2.GetAtomPosition(i)
        self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(5)
    p2 = c2.GetAtomPosition(1)
    self.assertEqual((p1 - p2).Length(), 0.0)
    p1 = c1.GetAtomPosition(6)
    p2 = c2.GetAtomPosition(0)
    self.assertEqual((p1 - p2).Length(), 0.0)