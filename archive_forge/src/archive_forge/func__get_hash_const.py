from __future__ import division
import hashlib
import logging; log = logging.getLogger(__name__)
import re
import os
from struct import Struct
from warnings import warn
from passlib import exc
from passlib.utils import join_bytes, to_native_str, join_byte_values, to_bytes, \
from passlib.utils.compat import irange, int_types, unicode_or_bytes_types, PY3, error_from
from passlib.utils.decor import memoized_property
def _get_hash_const(name):
    """
    internal helper used by :func:`lookup_hash` --
    lookup hash constructor by name

    :arg name:
        name (normalized to hashlib format, e.g. ``"sha256"``)

    :returns:
        hash constructor, e.g. ``hashlib.sha256()``;
        or None if hash can't be located.
    """
    if not name.startswith('_') and name not in ('new', 'algorithms'):
        try:
            return getattr(hashlib, name)
        except AttributeError:
            pass
    new_ssl_hash = hashlib.new
    try:
        new_ssl_hash(name, b'')
    except ValueError:
        pass
    else:

        def const(msg=b''):
            return new_ssl_hash(name, msg)
        const.__name__ = name
        const.__module__ = 'hashlib'
        const.__doc__ = 'wrapper for hashlib.new(%r),\ngenerated by passlib.crypto.digest.lookup_hash()' % name
        return const
    if name == 'md4':
        from passlib.crypto._md4 import md4
        return md4
    return None