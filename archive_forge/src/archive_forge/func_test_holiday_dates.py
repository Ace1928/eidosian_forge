from datetime import datetime
import pytest
from pytz import utc
from pandas import (
import pandas._testing as tm
from pandas.tseries.holiday import (
@pytest.mark.parametrize('holiday,start_date,end_date,expected', [(USMemorialDay, datetime(2011, 1, 1), datetime(2020, 12, 31), [datetime(2011, 5, 30), datetime(2012, 5, 28), datetime(2013, 5, 27), datetime(2014, 5, 26), datetime(2015, 5, 25), datetime(2016, 5, 30), datetime(2017, 5, 29), datetime(2018, 5, 28), datetime(2019, 5, 27), datetime(2020, 5, 25)]), (Holiday('July 4th Eve', month=7, day=3), '2001-01-01', '2003-03-03', [Timestamp('2001-07-03 00:00:00'), Timestamp('2002-07-03 00:00:00')]), (Holiday('July 4th Eve', month=7, day=3, days_of_week=(0, 1, 2, 3)), '2001-01-01', '2008-03-03', [Timestamp('2001-07-03 00:00:00'), Timestamp('2002-07-03 00:00:00'), Timestamp('2003-07-03 00:00:00'), Timestamp('2006-07-03 00:00:00'), Timestamp('2007-07-03 00:00:00')]), (EasterMonday, datetime(2011, 1, 1), datetime(2020, 12, 31), [Timestamp('2011-04-25 00:00:00'), Timestamp('2012-04-09 00:00:00'), Timestamp('2013-04-01 00:00:00'), Timestamp('2014-04-21 00:00:00'), Timestamp('2015-04-06 00:00:00'), Timestamp('2016-03-28 00:00:00'), Timestamp('2017-04-17 00:00:00'), Timestamp('2018-04-02 00:00:00'), Timestamp('2019-04-22 00:00:00'), Timestamp('2020-04-13 00:00:00')]), (GoodFriday, datetime(2011, 1, 1), datetime(2020, 12, 31), [Timestamp('2011-04-22 00:00:00'), Timestamp('2012-04-06 00:00:00'), Timestamp('2013-03-29 00:00:00'), Timestamp('2014-04-18 00:00:00'), Timestamp('2015-04-03 00:00:00'), Timestamp('2016-03-25 00:00:00'), Timestamp('2017-04-14 00:00:00'), Timestamp('2018-03-30 00:00:00'), Timestamp('2019-04-19 00:00:00'), Timestamp('2020-04-10 00:00:00')]), (USThanksgivingDay, datetime(2011, 1, 1), datetime(2020, 12, 31), [datetime(2011, 11, 24), datetime(2012, 11, 22), datetime(2013, 11, 28), datetime(2014, 11, 27), datetime(2015, 11, 26), datetime(2016, 11, 24), datetime(2017, 11, 23), datetime(2018, 11, 22), datetime(2019, 11, 28), datetime(2020, 11, 26)])])
def test_holiday_dates(holiday, start_date, end_date, expected):
    assert list(holiday.dates(start_date, end_date)) == expected
    assert list(holiday.dates(utc.localize(Timestamp(start_date)), utc.localize(Timestamp(end_date)))) == [utc.localize(dt) for dt in expected]