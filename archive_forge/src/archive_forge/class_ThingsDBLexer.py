from pygments.lexer import RegexLexer, include, bygroups
from pygments.token import Comment, Keyword, Name, Number, String, Text, \
class ThingsDBLexer(RegexLexer):
    """
    Lexer for the ThingsDB programming language.

    .. versionadded:: 2.9
    """
    name = 'ThingsDB'
    aliases = ['ti', 'thingsdb']
    filenames = ['*.ti']
    tokens = {'root': [include('expression')], 'expression': [include('comments'), include('whitespace'), ('[-+]?0b[01]+', Number.Bin), ('[-+]?0o[0-8]+', Number.Oct), ('([-+]?0x[0-9a-fA-F]+)', Number.Hex), ('[-+]?[0-9]+', Number.Integer), ('[-+]?((inf|nan)([^0-9A-Za-z_]|$)|[0-9]*\\.[0-9]+(e[+-][0-9]+)?)', Number.Float), ('(?:"(?:[^"]*)")+', String.Double), ("(?:'(?:[^']*)')+", String.Single), ('(true|false|nil)\\b', Keyword.Constant), ('(/[^/\\\\]*(?:\\\\.[^/\\\\]*)*/i?)', String.Regex), ('#[0-9]+', Comment.Preproc), include('names'), ('[(){}\\[\\],;]', Punctuation), ('[+\\-*/%&|<>^!~@=:?]', Operator)], 'names': [('(\\.)(add|call|contains|del|endswith|extend|filter|find|findindex|get|has|id|indexof|keys|len|lower|map|pop|push|remove|set|sort|splice|startswith|test|unwrap|upper|values|wrap)(\\()', bygroups(Name.Function, Name.Function, Punctuation), 'arguments'), ('(array|assert|assert_err|auth_err|backup_info|backups_info|bad_data_err|bool|closure|collection_info|collections_info|counters|deep|del_backup|del_collection|del_expired|del_node|del_procedure|del_token|del_type|del_user|err|float|forbidden_err|grant|int|isarray|isascii|isbool|isbytes|iserr|isfloat|isinf|isint|islist|isnan|isnil|israw|isset|isstr|isthing|istuple|isutf8|lookup_err|max_quota_err|mod_type|new|new_backup|new_collection|new_node|new_procedure|new_token|new_type|new_user|node_err|node_info|nodes_info|now|num_arguments_err|operation_err|overflow_err|procedure_doc|procedure_info|procedures_info|raise|refs|rename_collection|rename_user|reset_counters|return|revoke|run|set_log_level|set|set_quota|set_type|shutdown|str|syntax_err|thing|try|type|type_err|type_count|type_info|types_info|user_info|users_info|value_err|wse|zero_div_err)(\\()', bygroups(Name.Function, Punctuation), 'arguments'), ('(\\.[A-Za-z_][0-9A-Za-z_]*)(\\s*)(=)', bygroups(Name.Attribute, Text, Operator)), ('\\.[A-Za-z_][0-9A-Za-z_]*', Name.Attribute), ('([A-Za-z_][0-9A-Za-z_]*)(\\s*)(=)', bygroups(Name.Variable, Text, Operator)), ('[A-Za-z_][0-9A-Za-z_]*', Name.Variable)], 'whitespace': [('\\n', Whitespace), ('\\s+', Whitespace)], 'comments': [('//(.*?)\\n', Comment.Single), ('/\\*', Comment.Multiline, 'comment')], 'comment': [('[^*/]+', Comment.Multiline), ('/\\*', Comment.Multiline, '#push'), ('\\*/', Comment.Multiline, '#pop'), ('[*/]', Comment.Multiline)], 'arguments': [include('expression'), (',', Punctuation), ('\\(', Punctuation, '#push'), ('\\)', Punctuation, '#pop')]}