import re
from pygments.lexer import RegexLexer, inherit, words, include
from pygments.token import Text, Comment, Operator, Keyword, Name, String, \
class VisualPrologBaseLexer(RegexLexer):
    minorendkw = ('try', 'foreach', 'if')
    minorkwexp = ('and', 'catch', 'do', 'else', 'elseif', 'erroneous', 'externally', 'failure', 'finally', 'foreach', 'if', 'or', 'orelse', 'otherwise', 'then', 'try', 'div', 'mod', 'rem', 'quot')
    dockw = ('short', 'detail', 'end', 'withdomain')
    tokens = {'root': [('\\s+', Whitespace), (words(minorendkw, prefix='\\bend\\s+', suffix='\\b'), Keyword.Minor), ('end', Keyword), (words(minorkwexp, suffix='\\b'), Keyword.Minor), ('0[xo][\\da-fA-F_]+', Number), ('((\\d[\\d_]*)?\\.)?\\d[\\d_]*([eE][\\-+]?\\d+)?', Number), ('_\\w*', Name.Variable.Anonymous), ('[A-Z]\\w*', Name.Variable), ('@\\w+', Name.Variable), ('[a-z]\\w*', Name), ('/\\*', Comment, 'comment'), ('\\%', Comment, 'commentline'), ('"', String.Symbol, 'string'), ("\\'", String.Symbol, 'stringsingle'), ('@"', String.Symbol, 'atstring'), ('[\\-+*^/!?<>=~:]+', Operator), ('[$,.[\\]|(){}\\\\]+', Punctuation), ('.', Text)], 'commentdoc': [(words(dockw, prefix='@', suffix='\\b'), Comment.Preproc), ('@', Comment)], 'commentline': [include('commentdoc'), ('[^@\\n]+', Comment), ('$', Comment, '#pop')], 'comment': [include('commentdoc'), ('[^@*/]+', Comment), ('/\\*', Comment, '#push'), ('\\*/', Comment, '#pop'), ('[*/]', Comment)], 'stringescape': [('\\\\u[0-9a-fA-F]{4}', String.Escape), ('\\\\[\\\'"ntr\\\\]', String.Escape)], 'stringsingle': [include('stringescape'), ("\\'", String.Symbol, '#pop'), ("[^\\'\\\\\\n]+", String), ('\\n', String.Escape.Error, '#pop')], 'string': [include('stringescape'), ('"', String.Symbol, '#pop'), ('[^"\\\\\\n]+', String), ('\\n', String.Escape.Error, '#pop')], 'atstring': [('""', String.Escape), ('"', String.Symbol, '#pop'), ('[^"]+', String)]}