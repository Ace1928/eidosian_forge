import unittest
import re
from Cryptodome.PublicKey import DSA
from Cryptodome.SelfTest.st_common import *
from Cryptodome.Util.py3compat import *
from binascii import unhexlify
def test_x509v3(self):
    x509_v3_cert = '\n-----BEGIN CERTIFICATE-----\nMIIFhjCCA26gAwIBAgIBAzANBgkqhkiG9w0BAQsFADBhMQswCQYDVQQGEwJVUzEL\nMAkGA1UECAwCTUQxEjAQBgNVBAcMCUJhbHRpbW9yZTEQMA4GA1UEAwwHVGVzdCBD\nQTEfMB0GCSqGSIb3DQEJARYQdGVzdEBleGFtcGxlLmNvbTAeFw0xNDA3MTMyMDUz\nMjBaFw0xNzA0MDgyMDUzMjBaMEAxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJNRDES\nMBAGA1UEBwwJQmFsdGltb3JlMRAwDgYDVQQDDAdhdXN0cmlhMIIBtjCCASsGByqG\nSM44BAEwggEeAoGBALfd8gyEpVPA0ZI69Kp3nyJcu5N0ZZ3K1K9hleQLNqKEcZOh\n7a/C2J1TPdmHTLJ0rAwBZ1nWxnARSgRphziGDFspKCYQwYcSMz8KoFgvXbXpuchy\noFACiQ2LqZnc5MakuLQtLcQciSYGYj3zmZdYMoa904F1aDWr+DxQI6DVC3/bAhUA\nhqXMCJ6fQK3G2O9S3/CC/yVZXCsCgYBRXROl3R2khX7l10LQjDEgo3B1IzjXU/jP\nMcMBl6XO+nBJXxr/scbq8Ajiv7LTnGpSjgryHtvfj887kfvo8QbSS3kp3vq5uSqI\nui7E7r3jguWaLj616AG1HWOctXJUjqsiabZwsp2h09gHTzmHEXBOmiARu8xFxKAH\nxsuo7onAbwOBhAACgYBylWjWSnKHE8mHx1A5m/0GQx6xnhWIe3+MJAnEhRGxA2J4\nSCsfWU0OwglIQToh1z5uUU9oDi9cYgNPBevOFRnDhc2yaJY6VAYnI+D+6J5IU6Yd\n0iaG/iSc4sV4bFr0axcPpse3SN0XaQxiKeSFBfFnoMqL+dd9Gb3QPZSllBcVD6OB\n1TCB0jAdBgNVHQ4EFgQUx5wN0Puotv388M9Tp/fsPbZpzAUwHwYDVR0jBBgwFoAU\na0hkif3RMaraiWtsOOZZlLu9wJwwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwSgYD\nVR0RBEMwQYILZXhhbXBsZS5jb22CD3d3dy5leGFtcGxlLmNvbYIQbWFpbC5leGFt\ncGxlLmNvbYIPZnRwLmV4YW1wbGUuY29tMCwGCWCGSAGG+EIBDQQfFh1PcGVuU1NM\nIEdlbmVyYXRlZCBDZXJ0aWZpY2F0ZTANBgkqhkiG9w0BAQsFAAOCAgEAyWf1TiJI\naNEIA9o/PG8/JiGASTS2/HBVTJbkq03k6NkJVk/GxC1DPziTUJ+CdWlHWcAi1EOW\nAch3QxNDRrVfCOfCMDgElIO1094/reJgdFYG00LRi8QkRJuxANV7YS4tLudhyHJC\nkR2lhdMNmEuzWK+s2y+5cLrdm7qdvdENQCcV67uvGPx4sc+EaE7x13SczKjWBtbo\nQCs6JTOW+EkPRl4Zo27K4OIZ43/J+GxvwU9QUVH3wPVdbbLNw+QeTFBYMTEcxyc4\nkv50HPBFaithziXBFyvdIs19FjkFzu0Uz/e0zb1+vMzQlJMD94HVOrMnIj5Sb2cL\nKKdYXS4uhxFJmdV091Xur5JkYYwEzuaGav7J3zOzYutrIGTgDluLCvA+VQkRcTsy\njZ065SkY/v+38QHp+cmm8WRluupJTs8wYzVp6Fu0iFaaK7ztFmaZmHpiPIfDFjva\naCIgzzT5NweJd/b71A2SyzHXJ14zBXsr1PMylMp2TpHIidhuuNuQL6I0HaollB4M\nZ3FsVBMhVDw4Z76qnFPr8mZE2tar33hSlJI/3pS/bBiukuBk8U7VB0X8OqaUnP3C\n7b2Z4G8GtqDVcKGMzkvMjT4n9rKd/Le+qHSsQOGO9W/0LB7UDAZSwUsfAPnoBgdS\n5t9tIomLCOstByXi+gGZue1TcdCa3Ph4kO0=\n-----END CERTIFICATE-----\n        '.strip()
    y_str = '\n72:95:68:d6:4a:72:87:13:c9:87:c7:50:39:9b:fd:\n06:43:1e:b1:9e:15:88:7b:7f:8c:24:09:c4:85:11:\nb1:03:62:78:48:2b:1f:59:4d:0e:c2:09:48:41:3a:\n21:d7:3e:6e:51:4f:68:0e:2f:5c:62:03:4f:05:eb:\nce:15:19:c3:85:cd:b2:68:96:3a:54:06:27:23:e0:\nfe:e8:9e:48:53:a6:1d:d2:26:86:fe:24:9c:e2:c5:\n78:6c:5a:f4:6b:17:0f:a6:c7:b7:48:dd:17:69:0c:\n62:29:e4:85:05:f1:67:a0:ca:8b:f9:d7:7d:19:bd:\nd0:3d:94:a5:94:17:15:0f\n        '
    p_str = '\n00:b7:dd:f2:0c:84:a5:53:c0:d1:92:3a:f4:aa:77:\n9f:22:5c:bb:93:74:65:9d:ca:d4:af:61:95:e4:0b:\n36:a2:84:71:93:a1:ed:af:c2:d8:9d:53:3d:d9:87:\n4c:b2:74:ac:0c:01:67:59:d6:c6:70:11:4a:04:69:\n87:38:86:0c:5b:29:28:26:10:c1:87:12:33:3f:0a:\na0:58:2f:5d:b5:e9:b9:c8:72:a0:50:02:89:0d:8b:\na9:99:dc:e4:c6:a4:b8:b4:2d:2d:c4:1c:89:26:06:\n62:3d:f3:99:97:58:32:86:bd:d3:81:75:68:35:ab:\nf8:3c:50:23:a0:d5:0b:7f:db\n        '
    q_str = '\n00:86:a5:cc:08:9e:9f:40:ad:c6:d8:ef:52:df:f0:\n82:ff:25:59:5c:2b\n        '
    g_str = '\n51:5d:13:a5:dd:1d:a4:85:7e:e5:d7:42:d0:8c:31:\n20:a3:70:75:23:38:d7:53:f8:cf:31:c3:01:97:a5:\nce:fa:70:49:5f:1a:ff:b1:c6:ea:f0:08:e2:bf:b2:\nd3:9c:6a:52:8e:0a:f2:1e:db:df:8f:cf:3b:91:fb:\ne8:f1:06:d2:4b:79:29:de:fa:b9:b9:2a:88:ba:2e:\nc4:ee:bd:e3:82:e5:9a:2e:3e:b5:e8:01:b5:1d:63:\n9c:b5:72:54:8e:ab:22:69:b6:70:b2:9d:a1:d3:d8:\n07:4f:39:87:11:70:4e:9a:20:11:bb:cc:45:c4:a0:\n07:c6:cb:a8:ee:89:c0:6f\n        '
    key = DSA.importKey(x509_v3_cert)
    for comp_name in ('y', 'p', 'q', 'g'):
        comp_str = locals()[comp_name + '_str']
        comp = int(re.sub('[^0-9a-f]', '', comp_str), 16)
        self.assertEqual(getattr(key, comp_name), comp)
    self.assertFalse(key.has_private())