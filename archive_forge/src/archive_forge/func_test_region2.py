import sys
import pytest
import numpy as np
from typing import NamedTuple
from numpy.testing import assert_allclose
from scipy.special import hyp2f1
from scipy.special._testutils import check_version, MissingModule
@pytest.mark.parametrize('hyp2f1_test_case', [pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=1.0561196186065624, c=4.078873014294075, z=-0.3157894736842106 + 0.7368421052631575j, expected=0.7751915029081136 + 0.24068493258607315j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=16.088264119063613, c=2.0397202577726152, z=-0.9473684210526316 - 0.3157894736842106j, expected=6.564549348474962e-07 + 1.6761570598334562e-06j, rtol=5e-09)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=2.050308316530781, c=16.056809865262608, z=-0.10526315789473695 - 0.10526315789473695j, expected=0.9862043298997204 - 0.013293151372712681j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=8.077282662161238, c=16.056809865262608, z=-0.3157894736842106 - 0.736842105263158j, expected=0.16163826638754716 - 0.41378530376373734j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=2.050308316530781, c=-0.906685989801748, z=-0.5263157894736843 + 0.3157894736842106j, expected=-6.256871535165936 + 0.13824973858225484j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=2.02764642551431, b=8.077282662161238, c=-3.9924618758357022, z=-0.9473684210526316 - 0.3157894736842106j, expected=75.54672526086316 + 50.56157041797548j, rtol=5e-12)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=8.077282662161238, c=-1.9631175993998025, z=-0.5263157894736843 + 0.5263157894736841j, expected=282.0602536306534 - 82.31597306936214j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=-3.9316537064827854, c=8.031683612216888, z=-0.5263157894736843 - 0.10526315789473695j, expected=5.179603735575851 + 1.4445374002099813j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=4.080187217753502, b=-7.949900487447654, c=1.0651378143226575, z=-0.3157894736842106 - 0.9473684210526316j, expected=2317.623517606141 - 269.51476321010324j, rtol=5e-13)), pytest.param(Hyp2f1TestCase(a=16.087593263474208, b=-1.92872979730171, c=2.0397202577726152, z=-0.736842105263158 - 0.3157894736842106j, expected=29.179154096175836 + 22.126690357535043j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=-3.9316537064827854, c=-15.963511401609862, z=-0.736842105263158 - 0.10526315789473695j, expected=0.20820247892032057 - 0.04763956711248794j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=1.0272592605282642, b=-15.964218273004214, c=-1.9631175993998025, z=-0.3157894736842106 - 0.5263157894736843j, expected=-157471.63920142158 + 991294.0587828817j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=8.095813935368371, b=-7.949900487447654, c=-7.93846038215665, z=-0.10526315789473695 - 0.10526315789473695j, expected=0.30765349653210194 - 0.2979706363594157j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=1.0561196186065624, c=8.031683612216888, z=-0.9473684210526316 - 0.10526315789473695j, expected=1.6787607400597109 + 0.10056620134616838j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=16.088264119063613, c=4.078873014294075, z=-0.5263157894736843 - 0.736842105263158j, expected=7062.07842506049 - 12768.77955655703j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=16.088264119063613, c=2.0397202577726152, z=-0.3157894736842106 + 0.7368421052631575j, expected=54749.216391029935 - 23078.144720887536j, rtol=1e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=1.0561196186065624, c=-0.906685989801748, z=-0.10526315789473695 - 0.10526315789473695j, expected=1.21521766411428 - 4.449385173946672j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-15.980848054962111, b=4.0013768449590685, c=-1.9631175993998025, z=-0.736842105263158 + 0.5263157894736841j, expected=19234693144.196907 + 1617913967.7294445j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-1.9214641416286231, b=1.0561196186065624, c=-15.963511401609862, z=-0.5263157894736843 + 0.3157894736842106j, expected=0.9345201094534371 + 0.03745712558992195j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-7.937789122896016, b=-0.9629749245209605, c=2.0397202577726152, z=-0.10526315789473695 + 0.10526315789473673j, expected=0.605732446296829 + 0.398171533680972j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-1.9214641416286231, b=-15.964218273004214, c=2.0397202577726152, z=-0.10526315789473695 - 0.5263157894736843j, expected=-9.753761888305416 - 4.590126012666959j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-3.956227226099288, b=-1.92872979730171, c=2.0397202577726152, z=-0.10526315789473695 + 0.3157894736842106j, expected=0.45587226291120714 + 1.0694545265819797j, rtol=5e-15)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-7.949900487447654, c=-0.906685989801748, z=-0.736842105263158 + 0.3157894736842106j, expected=12.334808243233418 - 76.26089051819054j, rtol=5e-14)), pytest.param(Hyp2f1TestCase(a=-0.9220024191881196, b=-7.949900487447654, c=-15.963511401609862, z=-0.5263157894736843 + 0.10526315789473673j, expected=1.2396019687632678 - 0.047507973161146286j, rtol=1e-14)), pytest.param(Hyp2f1TestCase(a=-15.980848054962111, b=-0.9629749245209605, c=-0.906685989801748, z=-0.3157894736842106 - 0.5263157894736843j, expected=97.7889554372208 - 18.999754543400016j, rtol=5e-13))])
def test_region2(self, hyp2f1_test_case):
    """|z| < 1 and real(z) < 0."""
    a, b, c, z, expected, rtol = hyp2f1_test_case
    assert abs(z) < 1 and z.real < 0
    assert_allclose(hyp2f1(a, b, c, z), expected, rtol=rtol)